import{u as R,j as u,B as je,a as Ae}from"./index.ThHS-4Rn.js";import{l as N,r as Ne,c as xt,L as Ft}from"./leaflet-src.DNiXoNzL.js";import{S as Re,H as O,K as W,f as et,O as ge,t as Vt,q as lt,a as Lt,T as Q,s as Ct,R as Yt,U as zt,V as jt,n as kt,o as _e,y as Le,C as Ue,_ as At,r as ye,m as ve,h as Be,i as wt,l as te,b as ut,p as J,E as He,e as we,c as Me,W as Ge,X as We}from"./context.D_LBmcSq.js";import{g as Ze,r as b,R as mt,c as ee}from"./index.DUAV1Q2A.js";import{y as bt}from"./_astro-entry_react-toastify.BqZZ0Rhh.js";import{u as gt,c as Fe,g as ct,b as be,l as Ve,d as Ye,a as ke,h as xe,s as Je}from"./geo-utils.DlxYClN_.js";import{p as Jt,i as _t,M as Qe,a as Ke,b as Xe,T as $e,R as qe,c as Ce,h as ti,d as ei,m as ii,e as ie,f as ni,g as ne,j as oi}from"./tentacles.CONzxs5-.js";import{D as Et,a as Dt}from"./dialog.BWcy9ahI.js";import{e as Tt,f as Qt,g as Kt}from"./sidebar-l.CEyj2Wmt.js";import{L as Pt}from"./UnitSelect.kNvU8KlQ.js";import{I as ri,G as Ee}from"./iconBase.CiDQrpSB.js";import"./clsx.B-dksMZM.js";import"./index.w2VhVQe9.js";import"./checkbox.o88Tevvy.js";var Nt,oe;function ai(){return oe||(oe=1,Nt=function r(a,s){if(a===s)return!0;if(a&&s&&typeof a=="object"&&typeof s=="object"){if(a.constructor!==s.constructor)return!1;var l,t,e;if(Array.isArray(a)){if(l=a.length,l!=s.length)return!1;for(t=l;t--!==0;)if(!r(a[t],s[t]))return!1;return!0}if(a.constructor===RegExp)return a.source===s.source&&a.flags===s.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===s.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===s.toString();if(e=Object.keys(a),l=e.length,l!==Object.keys(s).length)return!1;for(t=l;t--!==0;)if(!Object.prototype.hasOwnProperty.call(s,e[t]))return!1;for(t=l;t--!==0;){var i=e[t];if(!r(a[i],s[i]))return!1}return!0}return a!==a&&s!==s}),Nt}var si=ai();const re=Ze(si);function pt(r){if(!r)throw new Error("geojson is required");var a=[];return Re(r,function(s){a.push(s)}),O(a)}function li(r,a){const s=b.useRef(a);b.useEffect(function(){a!==s.current&&r.attributionControl!=null&&(s.current!=null&&r.attributionControl.removeAttribution(s.current),a!=null&&r.attributionControl.addAttribution(a)),s.current=a},[r,a])}const ci=1;function hi(r){return Object.freeze({__version:ci,map:r})}function St(r,a){return Object.freeze({...r,...a})}const Xt=b.createContext(null);function yt(){const r=b.use(Xt);if(r==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return r}function De(r){function a(s,l){const{instance:t,context:e}=r(s).current;b.useImperativeHandle(l,()=>t);const{children:i}=s;return i==null?null:mt.createElement(Xt,{value:e},i)}return b.forwardRef(a)}function Te(r){function a(s,l){const{instance:t}=r(s).current;return b.useImperativeHandle(l,()=>t),null}return b.forwardRef(a)}function di(r){return function(s){const l=yt(),t=r(s,l),{instance:e}=t.current,i=b.useRef(s.position),{position:n}=s;return b.useEffect(function(){return e.addTo(l.map),function(){e.remove()}},[l.map,e]),b.useEffect(function(){n!=null&&n!==i.current&&(e.setPosition(n),i.current=n)},[e,n]),t}}function Pe(r,a){const s=b.useRef(void 0);b.useEffect(function(){return a!=null&&r.instance.on(a),s.current=a,function(){s.current!=null&&r.instance.off(s.current),s.current=null}},[r,a])}function $t(r,a){const s=r.pane??a.pane;return s?{...r,pane:s}:r}function ht(r,a,s){return Object.freeze({instance:r,context:a,container:s})}function It(r,a){return a==null?function(l,t){const e=b.useRef(void 0);return e.current||(e.current=r(l,t)),e}:function(l,t){const e=b.useRef(void 0);e.current||(e.current=r(l,t));const i=b.useRef(l),{instance:n}=e.current;return b.useEffect(function(){i.current!==l&&(a(n,l,i.current),i.current=l)},[n,l,a]),e}}function Se(r,a){b.useEffect(function(){return(a.layerContainer??a.map).addLayer(r.instance),function(){a.layerContainer?.removeLayer(r.instance),a.map.removeLayer(r.instance)}},[a,r])}function Ie(r){return function(s){const l=yt(),t=r($t(s,l),l);return li(l.map,s.attribution),Pe(t.current,s.eventHandlers),Se(t.current,l),t}}function ui(r,a){const s=b.useRef(void 0);b.useEffect(function(){if(a.pathOptions!==s.current){const t=a.pathOptions??{};r.instance.setStyle(t),s.current=t}},[r,a])}function pi(r){return function(s){const l=yt(),t=r($t(s,l),l);return Pe(t.current,s.eventHandlers),Se(t.current,l),ui(t.current,s),t}}function fi(r){function a(t,e){return ht(r(t),e)}const s=It(a),l=di(s);return Te(l)}function mi(r,a){const s=It(r,a),l=Ie(s);return De(l)}function qt(r,a){const s=It(r,a),l=pi(s);return De(l)}function gi(r,a){const s=It(r,a),l=Ie(s);return Te(l)}function _i(r,a,s){const{opacity:l,zIndex:t}=a;l!=null&&l!==s.opacity&&r.setOpacity(l),t!=null&&t!==s.zIndex&&r.setZIndex(t)}function Li(){return yt().map}const yi=qt(function({children:a,...s},l){const t=new N.FeatureGroup([],s);return ht(t,St(l,{layerContainer:t,overlayContainer:t}))});function vi({bounds:r,boundsOptions:a,center:s,children:l,className:t,id:e,placeholder:i,style:n,whenReady:o,zoom:c,...h},d){const[f]=b.useState({className:t,id:e,style:n}),[P,g]=b.useState(null),w=b.useRef(void 0);b.useImperativeHandle(d,()=>P?.map??null,[P]);const j=b.useCallback(st=>{if(st!==null&&!w.current){const k=new N.Map(st,h);w.current=k,s!=null&&c!=null?k.setView(s,c):r!=null&&k.fitBounds(r,a),o!=null&&k.whenReady(o),g(hi(k))}},[]);b.useEffect(()=>()=>{P?.map.remove()},[P]);const at=P?mt.createElement(Xt,{value:P},l):i??null;return mt.createElement("div",{...f,ref:j},at)}const wi=b.forwardRef(vi),Ot=mi(function({position:a,...s},l){const t=new N.Marker(a,s);return ht(t,St(l,{overlayContainer:t}))},function(a,s,l){s.position!==l.position&&a.setLatLng(s.position),s.icon!=null&&s.icon!==l.icon&&a.setIcon(s.icon),s.zIndexOffset!=null&&s.zIndexOffset!==l.zIndexOffset&&a.setZIndexOffset(s.zIndexOffset),s.opacity!=null&&s.opacity!==l.opacity&&a.setOpacity(s.opacity),a.dragging!=null&&s.draggable!==l.draggable&&(s.draggable===!0?a.dragging.enable():a.dragging.disable())}),ae=qt(function({positions:a,...s},l){const t=new N.Polygon(a,s);return ht(t,St(l,{overlayContainer:t}))},function(a,s,l){s.positions!==l.positions&&a.setLatLngs(s.positions)}),Mi=qt(function({positions:a,...s},l){const t=new N.Polyline(a,s);return ht(t,St(l,{overlayContainer:t}))},function(a,s,l){s.positions!==l.positions&&a.setLatLngs(s.positions)}),bi=fi(function(a){return new N.Control.Scale(a)}),se=gi(function({url:a,...s},l){const t=new N.TileLayer(a,$t(s,l));return ht(t,l)},function(a,s,l){_i(a,s,l);const{url:t}=s;t!=null&&t!==l.url&&a.setUrl(t)});var Rt={exports:{}};/*
	Leaflet.contextmenu, a context menu for Leaflet.
	(c) 2015, Adam Ratcliffe, GeoSmart Maps Limited

	@preserve
*/var le;function ki(){return le||(le=1,function(r){(function(a){var s;s=Ne(),r.exports=a(s)})(function(a){a.Map.mergeOptions({contextmenuItems:[]}),a.Map.ContextMenu=a.Handler.extend({_touchstart:a.Browser.msPointer?"MSPointerDown":a.Browser.pointer?"pointerdown":"touchstart",statics:{BASE_CLS:"leaflet-contextmenu"},initialize:function(n){a.Handler.prototype.initialize.call(this,n),this._items=[],this._visible=!1;var o=this._container=a.DomUtil.create("div",a.Map.ContextMenu.BASE_CLS,n._container);o.style.zIndex=1e4,o.style.position="absolute",n.options.contextmenuWidth&&(o.style.width=n.options.contextmenuWidth+"px"),this._createItems(),a.DomEvent.on(o,"click",a.DomEvent.stop).on(o,"mousedown",a.DomEvent.stop).on(o,"dblclick",a.DomEvent.stop).on(o,"contextmenu",a.DomEvent.stop)},addHooks:function(){var n=this._map.getContainer();a.DomEvent.on(n,"mouseleave",this._hide,this).on(document,"keydown",this._onKeyDown,this),a.Browser.touch&&a.DomEvent.on(document,this._touchstart,this._hide,this),this._map.on({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},removeHooks:function(){var n=this._map.getContainer();a.DomEvent.off(n,"mouseleave",this._hide,this).off(document,"keydown",this._onKeyDown,this),a.Browser.touch&&a.DomEvent.off(document,this._touchstart,this._hide,this),this._map.off({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},showAt:function(n,o){n instanceof a.LatLng&&(n=this._map.latLngToContainerPoint(n)),this._showAtPoint(n,o)},hide:function(){this._hide()},addItem:function(n){return this.insertItem(n)},insertItem:function(n,o){o=o!==void 0?o:this._items.length;var c=this._createItem(this._container,n,o);return this._items.push(c),this._sizeChanged=!0,this._map.fire("contextmenu.additem",{contextmenu:this,el:c.el,index:o}),c.el},removeItem:function(n){var o=this._container;return isNaN(n)||(n=o.children[n]),n?(this._removeItem(a.Util.stamp(n)),this._sizeChanged=!0,this._map.fire("contextmenu.removeitem",{contextmenu:this,el:n}),n):null},removeAllItems:function(){for(var n=this._container.children,o;n.length;)o=n[0],this._removeItem(a.Util.stamp(o));return n},hideAllItems:function(){var n,o,c;for(o=0,c=this._items.length;o<c;o++)n=this._items[o],n.el.style.display="none"},showAllItems:function(){var n,o,c;for(o=0,c=this._items.length;o<c;o++)n=this._items[o],n.el.style.display=""},setDisabled:function(n,o){var c=this._container,h=a.Map.ContextMenu.BASE_CLS+"-item";isNaN(n)||(n=c.children[n]),n&&a.DomUtil.hasClass(n,h)&&(o?(a.DomUtil.addClass(n,h+"-disabled"),this._map.fire("contextmenu.disableitem",{contextmenu:this,el:n})):(a.DomUtil.removeClass(n,h+"-disabled"),this._map.fire("contextmenu.enableitem",{contextmenu:this,el:n})))},isVisible:function(){return this._visible},_createItems:function(){var n=this._map.options.contextmenuItems,o,c;for(o=0,c=n.length;o<c;o++)this._items.push(this._createItem(this._container,n[o]))},_createItem:function(n,o,c){if(o.separator||o==="-")return this._createSeparator(n,c);var h=a.Map.ContextMenu.BASE_CLS+"-item",d=o.disabled?h+" "+h+"-disabled":h,f=this._insertElementAt("a",d,n,c),P=this._createEventHandler(f,o.callback,o.context,o.hideOnSelect),g=this._getIcon(o),w=this._getIconCls(o),j="";return g?j='<img class="'+a.Map.ContextMenu.BASE_CLS+'-icon" src="'+g+'"/>':w&&(j='<span class="'+a.Map.ContextMenu.BASE_CLS+"-icon "+w+'"></span>'),f.innerHTML=j+o.text,f.href="#",a.DomEvent.on(f,"mouseover",this._onItemMouseOver,this).on(f,"mouseout",this._onItemMouseOut,this).on(f,"mousedown",a.DomEvent.stopPropagation).on(f,"click",P),a.Browser.touch&&a.DomEvent.on(f,this._touchstart,a.DomEvent.stopPropagation),a.Browser.pointer||a.DomEvent.on(f,"click",this._onItemMouseOut,this),{id:a.Util.stamp(f),el:f,callback:P}},_removeItem:function(n){var o,c,h,d,f;for(h=0,d=this._items.length;h<d;h++)if(o=this._items[h],o.id===n)return c=o.el,f=o.callback,f&&(a.DomEvent.off(c,"mouseover",this._onItemMouseOver,this).off(c,"mouseover",this._onItemMouseOut,this).off(c,"mousedown",a.DomEvent.stopPropagation).off(c,"click",f),a.Browser.touch&&a.DomEvent.off(c,this._touchstart,a.DomEvent.stopPropagation),a.Browser.pointer||a.DomEvent.on(c,"click",this._onItemMouseOut,this)),this._container.removeChild(c),this._items.splice(h,1),o;return null},_createSeparator:function(n,o){var c=this._insertElementAt("div",a.Map.ContextMenu.BASE_CLS+"-separator",n,o);return{id:a.Util.stamp(c),el:c}},_createEventHandler:function(n,o,c,g){var d=this,f=this._map,P=a.Map.ContextMenu.BASE_CLS+"-item-disabled",g=g!==void 0?g:!0;return function(w){a.DomUtil.hasClass(n,P)||(g&&d._hide(),o&&o.call(c||f,d._showLocation),d._map.fire("contextmenu.select",{contextmenu:d,el:n}))}},_insertElementAt:function(n,o,c,h){var d,f=document.createElement(n);return f.className=o,h!==void 0&&(d=c.children[h]),d?c.insertBefore(f,d):c.appendChild(f),f},_show:function(n){this._showAtPoint(n.containerPoint,n)},_showAtPoint:function(n,o){if(this._items.length){var c=this._map,h=c.containerPointToLayerPoint(n),d=c.layerPointToLatLng(h),f=a.extend(o||{},{contextmenu:this});this._showLocation={latlng:d,layerPoint:h,containerPoint:n},o&&o.relatedTarget&&(this._showLocation.relatedTarget=o.relatedTarget),this._setPosition(n),this._visible||(this._container.style.display="block",this._visible=!0),this._map.fire("contextmenu.show",f)}},_hide:function(){this._visible&&(this._visible=!1,this._container.style.display="none",this._map.fire("contextmenu.hide",{contextmenu:this}))},_getIcon:function(n){return a.Browser.retina&&n.retinaIcon||n.icon},_getIconCls:function(n){return a.Browser.retina&&n.retinaIconCls||n.iconCls},_setPosition:function(n){var o=this._map.getSize(),c=this._container,h=this._getElementSize(c),d;this._map.options.contextmenuAnchor&&(d=a.point(this._map.options.contextmenuAnchor),n=n.add(d)),c._leaflet_pos=n,n.x+h.x>o.x?(c.style.left="auto",c.style.right=Math.min(Math.max(o.x-n.x,0),o.x-h.x-1)+"px"):(c.style.left=Math.max(n.x,0)+"px",c.style.right="auto"),n.y+h.y>o.y?(c.style.top="auto",c.style.bottom=Math.min(Math.max(o.y-n.y,0),o.y-h.y-1)+"px"):(c.style.top=Math.max(n.y,0)+"px",c.style.bottom="auto")},_getElementSize:function(n){var o=this._size,c=n.style.display;return(!o||this._sizeChanged)&&(o={},n.style.left="-999999px",n.style.right="auto",n.style.display="block",o.x=n.offsetWidth,o.y=n.offsetHeight,n.style.left="auto",n.style.display=c,this._sizeChanged=!1),o},_onKeyDown:function(n){var o=n.keyCode;o===27&&this._hide()},_onItemMouseOver:function(n){a.DomUtil.addClass(n.target||n.srcElement,"over")},_onItemMouseOut:function(n){a.DomUtil.removeClass(n.target||n.srcElement,"over")}}),a.Map.addInitHook("addHandler","contextmenu",a.Map.ContextMenu),a.Mixin.ContextMenu={bindContextMenu:function(n){return a.setOptions(this,n),this._initContextMenu(),this},unbindContextMenu:function(){return this.off("contextmenu",this._showContextMenu,this),this},addContextMenuItem:function(n){this.options.contextmenuItems.push(n)},removeContextMenuItemWithIndex:function(n){for(var o=[],c=0;c<this.options.contextmenuItems.length;c++)this.options.contextmenuItems[c].index==n&&o.push(c);for(var h=o.pop();h!==void 0;)this.options.contextmenuItems.splice(h,1),h=o.pop()},replaceContextMenuItem:function(n){this.removeContextMenuItemWithIndex(n.index),this.addContextMenuItem(n)},_initContextMenu:function(){this._items=[],this.on("contextmenu",this._showContextMenu,this)},_showContextMenu:function(n){var o,c,h,d,f;if(this._map.contextmenu){for(c=a.extend({relatedTarget:this},n),h=this._map.mouseEventToContainerPoint(n.originalEvent),this.options.contextmenuInheritItems||this._map.contextmenu.hideAllItems(),d=0,f=this.options.contextmenuItems.length;d<f;d++)o=this.options.contextmenuItems[d],this._items.push(this._map.contextmenu.insertItem(o,o.index));this._map.once("contextmenu.hide",this._hideContextMenu,this),this._map.contextmenu.showAt(h,c)}},_hideContextMenu:function(){var n,o;for(n=0,o=this._items.length;n<o;n++)this._map.contextmenu.removeItem(this._items[n]);this._items.length=0,this.options.contextmenuInheritItems||this._map.contextmenu.showAllItems()}};var s=[a.Marker,a.Path],l={contextmenu:!1,contextmenuItems:[],contextmenuInheritItems:!0},t,e,i;for(e=0,i=s.length;e<i;e++)t=s[e],t.prototype.options?t.mergeOptions(l):t.prototype.options=l,t.addInitHook(function(){this.options.contextmenu&&this._initContextMenu()}),t.include(a.Mixin.ContextMenu);return a.Map.ContextMenu})}(Rt)),Rt.exports}ki();const Ut=(r,a,s)=>{if(a===null)return;const l=W([r.lng,r.lat]),t=xt(l,r.radius,{units:r.unit});if(r.within){if(s)throw new Error("Cannot be masked");return _t(O([gt(a),t]))}else{if(!s)throw new Error("Must be masked");return Fe(O([...a.features,t]))}},xi=r=>{const a=et.get();return a===!1||(ge(W([r.lng,r.lat]),W([a.longitude,a.latitude]),{units:r.unit})<=r.radius?r.within=!0:r.within=!1),r},Ci=r=>{const a=xt(W([r.lng,r.lat]),r.radius,{units:r.unit});return Jt(a)};let Bt=!1;const Mt=({latitude:r,longitude:a,color:s,onChange:l,questionKey:t,sub:e=""})=>{const i=R(lt),n=R(et),o=R(Lt),[c,h]=b.useState(!1);return u.jsxs(Et,{open:c,onOpenChange:h,children:[u.jsx(Ot,{position:[r,a],icon:s?new N.Icon({iconUrl:`https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-${s}.png`,shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}):void 0,draggable:!0,eventHandlers:{dragstart:()=>{Bt=!0},dragend:d=>{l(d),setTimeout(()=>{Bt=!1},100)},click:()=>{Bt||h(!0)}}}),u.jsxs(Dt,{className:"!bg-[hsl(var(--sidebar-background))] !text-white",children:[t===-1&&n!==!1&&u.jsxs(u.Fragment,{children:[u.jsx("h2",{className:"text-center text-2xl font-bold font-poppins",children:e}),u.jsx(Tt,{children:u.jsx(Pt,{latitude:n.latitude,longitude:n.longitude,onChange:(d,f)=>{et.set({latitude:d??n.latitude,longitude:f??n.longitude})},latLabel:"Hider Latitude",lngLabel:"Hider Longitude"})})]}),i.filter(d=>d.key===t).map(d=>{switch(d.id){case"radius":return u.jsx(qe,{data:d.data,questionKey:d.key,sub:e,showDeleteButton:!1},d.key);case"tentacles":return u.jsx($e,{data:d.data,questionKey:d.key,sub:e,showDeleteButton:!1},d.key);case"thermometer":return u.jsx(Xe,{data:d.data,questionKey:d.key,sub:e,showDeleteButton:!1},d.key);case"matching":return u.jsx(Ke,{data:d.data,questionKey:d.key,sub:e,showDeleteButton:!1},d.key);case"measuring":return u.jsx(Qe,{data:d.data,questionKey:d.key,sub:e,showDeleteButton:!1},d.key);default:return null}}),u.jsx(je,{onClick:()=>{t===-1?et.set(!1):lt.set(i.filter(d=>d.key!==t))},variant:"destructive",className:"font-semibold font-poppins",children:t===-1?"Disable":"Delete"}),!o&&u.jsx("button",{onClick:Ct,className:"bg-blue-600 p-2 rounded-md font-semibold font-poppins transition-shadow duration-500",children:"Save"})]})]})},Ei=()=>{R(Vt);const r=R(lt),a=R(et);return u.jsxs(u.Fragment,{children:[a!==!1&&u.jsx(Mt,{color:"green",sub:"Hider Location",questionKey:-1,latitude:a.latitude,longitude:a.longitude,onChange:s=>{a.latitude=s.target.getLatLng().lat??a.latitude,a.longitude=s.target.getLatLng().lng??a.longitude,Lt.get()?et.set({...a}):Vt.set(Math.random())}},"hider"),r.map(s=>{if(!s.data||!s.data.drag||s.id==="matching"&&s.data.type==="custom-zone")return null;switch(s.id){case"radius":case"tentacles":case"matching":case"measuring":return u.jsx(Mt,{color:s.data.color,questionKey:s.key,latitude:s.data.lat,longitude:s.data.lng,onChange:l=>{s.data.lat=l.target.getLatLng().lat,s.data.lng=l.target.getLatLng().lng,Q()}},s.key);case"thermometer":return u.jsxs(u.Fragment,{children:[u.jsx(Mt,{color:s.data.colorA,questionKey:s.key,sub:"Start",latitude:s.data.latA,longitude:s.data.lngA,onChange:l=>{s.data.latA=l.target.getLatLng().lat,s.data.lngA=l.target.getLatLng().lng,Q()}},"a"+s.key.toString()),u.jsx(Mt,{color:s.data.colorB,questionKey:s.key,sub:"End",latitude:s.data.latB,longitude:s.data.lngB,onChange:l=>{s.data.latB=l.target.getLatLng().lat,s.data.lngB=l.target.getLatLng().lng,Q()}},"b"+s.key.toString())]},s.key);default:return null}})]})},Di=(r,a,s)=>{if(a===null)return;const l=W([r.lngA,r.latA]),t=W([r.lngB,r.latB]),e=ct(O([l,t]));return r.warmer?_t(O([gt(a),e.features[1]])):_t(O([gt(a),e.features[0]]))},Ti=r=>{const a=et.get();if(a===!1)return r;const s=W([r.lngA,r.latA]),l=W([r.lngB,r.latB]),t=ct(O([s,l])),e=W([a.longitude,a.latitude]);return(be(e,t.features[1])?1:0)===1?r.warmer=!0:r.warmer=!1,r},Pi=r=>{const a=W([r.lngA,r.latA]),s=W([r.lngB,r.latB]),l=ct(O([a,s]));return O(l.features.map(t=>Jt(t)))},Si=async(r,a,s)=>{if(a===null)return;if(r.location===!1)throw new Error("Must have a location");const l=r.locationType==="custom"?O(r.places):await Yt(r),e=ct(l).features.find(n=>r.location?n.properties.site.properties.name===r.location.properties.name:!1);if(!e)return a;const i=xt(W([r.lng,r.lat]),r.radius,{units:r.unit});return _t(O([gt(a),e,i]))},Ii=async r=>{const a=et.get();if(a===!1)return r;const s=r.locationType==="custom"?O(r.places):await Yt(r),l=ct(s),t=W([a.longitude,a.latitude]),e=W([r.lng,r.lat]);if(ge(t,e,{units:r.unit})>r.radius)return r.location=!1,r;let i=null;return l.features.find((o,c)=>{const h=be(t,o.geometry)||!1;return h&&(i=s.features[c]),h})&&(r.location=i),r},Oi=async r=>{const a=r.locationType==="custom"?O(r.places):await Yt(r),s=ct(a),l=xt(W([r.lng,r.lat]),r.radius,{units:r.unit}),t=s.features.map(e=>_t(O([e,l]))).filter(e=>e!==null);return Ce(O(t.map(e=>Jt(e))))};var Ht={exports:{}},Gt,ce;function zi(){if(ce)return Gt;ce=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Gt=r,Gt}var Wt,he;function ji(){if(he)return Wt;he=1;var r=zi();function a(){}function s(){}return s.resetWarningCache=a,Wt=function(){function l(i,n,o,c,h,d){if(d!==r){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}l.isRequired=l;function t(){return l}var e={array:l,bigint:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:t,element:l,elementType:l,instanceOf:t,node:l,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:a};return e.PropTypes=e,e},Wt}var de;function Ai(){return de||(de=1,Ht.exports=ji()()),Ht.exports}var E=Ai();(function(r,a,s){function l(t,e){for(;(t=t.parentElement)&&!t.classList.contains(e););return t}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e);var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire(L.Draw.Event.CREATED,{layer:t,layerType:this.type})},_cancelDrawing:function(t){t.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,i=e.getLatLngs(),n=i.splice(-1,1)[0];this._poly.setLatLngs(i),this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(n,!1)}},addVertex:function(t){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(t,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var t=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),e=this._poly.newLatLngIntersects(t[t.length-1]);if(!this.options.allowIntersection&&e||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),i=this._map.layerPointToLatLng(e);this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(t),this._clickHandled=!0,this._disableNewMarkers();var e=t.originalEvent,i=e.clientX,n=e.clientY;this._startPoint.call(this,i,n)}},_startPoint:function(t,e){this._mouseDownOrigin=L.point(t,e)},_onMouseUp:function(t){var e=t.originalEvent,i=e.clientX,n=e.clientY;this._endPoint.call(this,i,n,t),this._clickHandled=null},_endPoint:function(t,e,i){if(this._mouseDownOrigin){var n=L.point(t,e).distanceTo(this._mouseDownOrigin),o=this._calculateFinishDistance(i.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(i.latlng),this._finishShape()):o<10&&L.Browser.touch?this._finishShape():Math.abs(n)<9*(r.devicePixelRatio||1)&&this.addVertex(i.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(t){var e,i,n=t.originalEvent;!n.touches||!n.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(e=n.touches[0].clientX,i=n.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,e,i),this._endPoint.call(this,e,i,t),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(t){var e;if(this._markers.length>0){var i;if(this.type===L.Draw.Polyline.TYPE)i=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;i=this._markers[0]}var n=this._map.latLngToContainerPoint(i.getLatLng()),o=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),c=this._map.latLngToContainerPoint(o.getLatLng());e=n.distanceTo(c)}else e=1/0;return e},_updateFinishHandler:function(){var t=this._markers.length;t>1&&this._markers[t-1].on("click",this._finishShape,this),t>2&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers?this._markers.length:0;e>0&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,n,o,c=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),h=this.options.guidelineDistance,d=this.options.maxGuideLineLength,f=c>d?c-d:h;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));f<c;f+=this.options.guidelineDistance)i=f/c,n={x:Math.floor(t.x*(1-i)+i*e.x),y:Math.floor(t.y*(1-i)+i*e.y)},o=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),o.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(o,n)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;e<i;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e,i=this.options.showLength;return this._markers.length===0?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=i?this._getMeasurementString():"",t=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var i,n,o=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(i=o-(e?2:1),n=L.GeometryUtil.isVersion07x()?t.distanceTo(this._markers[i].getLatLng())*(this.options.factor||1):this._map.distance(t,this._markers[i].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=n*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=L.GeometryUtil.isVersion07x()?i&&e&&e.distanceTo?this._measurementRunningTotal+e.distanceTo(i)*(this.options.factor||1):this._measurementRunningTotal||0:i&&e?this._measurementRunningTotal+this._map.distance(e,i)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;t===1&&this._markers[0].on("click",this._finishShape,this),t>2&&(this._markers[t-1].on("dblclick",this._finishShape,this),t>3&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return this._markers.length===0?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(t=L.drawLocal.draw.handlers.polygon.tooltip.cont,e=this._getMeasurementString()):(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area,e="";return t||this.options.showLength?(this.options.showLength&&(e=L.Draw.Polyline.prototype._getMeasurementString.call(this)),t&&(e+="<br>"+L.GeometryUtil.readableArea(t,this.options.metric,this.options.precision)),e):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(t,e){var i;!this.options.allowIntersection&&this.options.showArea&&(i=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(i)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;t>0&&(this._markers[0].off("click",this._finishShape,this),t>2&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),a.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(a,"mouseup",this._onMouseUp,this),L.DomEvent.off(a,"touchend",this._onMouseUp,this),a.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(a,"mouseup",this._onMouseUp,this).on(a,"touchend",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(t){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!l(t.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e,i,n=L.Draw.SimpleShape.prototype._getTooltipText.call(this),o=this._shape,c=this.options.showArea;return o&&(t=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(t),i=c?L.GeometryUtil.readableArea(e,this.options.metric):""),{text:n.text,subtext:i}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=this._createMarker(e),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(t){return new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},_fireCreatedEvent:function(){var t=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)},_createMarker:function(t){return new L.CircleMarker(t,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){if(L.GeometryUtil.isVersion07x())var e=this._startLatLng.distanceTo(t);else var e=this._map.distance(this._startLatLng,t);this._shape?this._shape.setRadius(e):(this._shape=new L.Circle(this._startLatLng,e,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,n=this.options.showRadius,o=this.options.metric;if(this._tooltip.updatePosition(i),this._isDrawing){this._drawShape(i),e=this._shape.getRadius().toFixed(1);var c="";n&&(c=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(e,o,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:c})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&&(t.style.display="none",L.DomUtil.hasClass(t,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,4)),t.style.display="")},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,n=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+"px",t.style.marginLeft=n+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(t){this.latlngs=[t._latlngs],t._holes&&(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(t){for(var e=0;e<this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(t){t.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(t){t.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(t){t.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this._poly.options.poly))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&&(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(t,e,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=t,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this._latlngs=e,L.setOptions(this,i)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var t=this._poly,e=t._path;t instanceof L.Polygon||(t.options.fill=!1,t.options.editing&&(t.options.editing.fill=!1)),e&&t.options.editing&&t.options.editing.className&&(t.options.original.className&&t.options.original.className.split(" ").forEach(function(i){L.DomUtil.removeClass(e,i)}),t.options.editing.className.split(" ").forEach(function(i){L.DomUtil.addClass(e,i)})),t.setStyle(t.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly,e=t._path;e&&t.options.editing&&t.options.editing.className&&(t.options.editing.className.split(" ").forEach(function(i){L.DomUtil.removeClass(e,i)}),t.options.original.className&&t.options.original.className.split(" ").forEach(function(i){L.DomUtil.addClass(e,i)})),t.setStyle(t.options.original),t._map&&(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,n,o=this._defaultShape();for(t=0,i=o.length;t<i;t++)n=this._createMarker(o[t],t),n.on("click",this._onMarkerClick,this),n.on("contextmenu",this._onContextMenu,this),this._markers.push(n);var c,h;for(t=0,e=i-1;t<i;e=t++)(t!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(c=this._markers[e],h=this._markers[t],this._createMiddleMarker(c,h),this._updatePrevNext(c,h))},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(i),i},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var t=this._defaultShape(),e=[].splice.apply(t,arguments);return this._poly._convertLatLngs(t,!0),this._poly.redraw(),e},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(t){var e=t.target,i=this._poly,n=L.LatLngUtil.cloneLatLng(e._origLatLng);if(L.extend(e._origLatLng,e._latlng),i.options.poly){var o=i._map._editTooltip;if(!i.options.poly.allowIntersection&&i.intersects()){L.extend(e._origLatLng,n),e.setLatLng(n);var c=i.options.color;i.setStyle({color:this.options.drawError.color}),o&&o.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){i.setStyle({color:c}),o&&o.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var h=this._poly.getLatLngs();this._poly._convertLatLngs(h,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;this._defaultShape().length<e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(t){var e=t.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:e,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e),n=t.target;L.extend(n._origLatLng,i),n._middleLeft&&n._middleLeft.setLatLng(this._getMiddleLatLng(n._prev,n)),n._middleRight&&n._middleRight.setLatLng(this._getMiddleLatLng(n,n._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(t,e){this._markerGroup.eachLayer(function(i){i._index>t&&(i._index+=e)})},_createMiddleMarker:function(t,e){var i,n,o,c=this._getMiddleLatLng(t,e),h=this._createMarker(c);h.setOpacity(.6),t._middleRight=e._middleLeft=h,n=function(){h.off("touchmove",n,this);var d=e._index;h._index=d,h.off("click",i,this).on("click",this._onMarkerClick,this),c.lat=h.getLatLng().lat,c.lng=h.getLatLng().lng,this._spliceLatLngs(d,0,c),this._markers.splice(d,0,h),h.setOpacity(1),this._updateIndexes(d,1),e._index++,this._updatePrevNext(t,h),this._updatePrevNext(h,e),this._poly.fire("editstart")},o=function(){h.off("dragstart",n,this),h.off("dragend",o,this),h.off("touchmove",n,this),this._createMiddleMarker(t,h),this._createMiddleMarker(h,e)},i=function(){n.call(this),o.call(this),this._fireEdit()},h.on("click",i,this).on("dragstart",n,this).on("dragend",o,this).on("touchmove",n,this),this._markerGroup.addLayer(h)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,n=i.project(t.getLatLng()),o=i.project(e.getLatLng());return i.unproject(n._add(o)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(t,e){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&&(this._map=this._shape._map,t.setStyle(t.options.editing),t._map&&(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(t){t.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(t){t.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),typeof this._getCorners=="function"){var e=this._getCorners(),i=t.target,n=i._cornerIndex;i.setOpacity(0),this._oppositeCorner=e[(n+2)%4],this._toggleCornerMarkers(0,n)}this._shape.fire("editstart")},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e);return t.target===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),!1},_onTouchEnd:function(t){t.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds(),e=t.getCenter();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;e<i;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),i=t.target,n=i._cornerIndex;this._oppositeCorner=e[(n+2)%4],this._toggleCornerMarkers(0,n)},_onMarkerDragEnd:function(t){var e,i,n=t.target;n===this._moveMarker&&(e=this._shape.getBounds(),i=e.getCenter(),n.setLatLng(i)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),n=this._shape.getBounds(),o=n.getCenter(),c=[],h=0,d=i.length;h<d;h++)e=[i[h].lat-o.lat,i[h].lng-o.lng],c.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(c),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(t){if(this._resizeMarkers.length){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e)}this._shape.setLatLng(t),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_resize:function(t){var e=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=e.distanceTo(t):radius=this._map.distance(e,t),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(t,e){var i={};if(t.touches!==void 0){if(!t.touches.length)return;i=t.touches[0]}else if(t.pointerType!=="touch"||(i=t,!this._filterClick(t)))return;var n=this._map.mouseEventToContainerPoint(i),o=this._map.mouseEventToLayerPoint(i),c=this._map.layerPointToLatLng(o);this._map.fire(e,{latlng:c,layerPoint:o,containerPoint:n,pageX:i.pageX,pageY:i.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,i=L.DomEvent._lastClick&&e-L.DomEvent._lastClick;return i&&i>100&&i<500||t.target._simulatedClick&&!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){this._map._loaded&&this._touchEvent(t,"touchstart")},_onTouchEnd:function(t){this._map._loaded&&this._touchEvent(t,"touchend")},_onTouchCancel:function(t){if(this._map._loaded){var e="touchcancel";this._detectIE()&&(e="pointercancel"),this._touchEvent(t,e)}},_onTouchLeave:function(t){this._map._loaded&&this._touchEvent(t,"touchleave")},_onTouchMove:function(t){this._map._loaded&&this._touchEvent(t,"touchmove")},_detectIE:function(){var t=r.navigator.userAgent,e=t.indexOf("MSIE ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(t.indexOf("Trident/")>0){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}var n=t.indexOf("Edge/");return n>0&&parseInt(t.substring(n+5,t.indexOf(".",n)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?e.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):e.concat(["touchcancel"]),L.DomUtil.addClass(t,"leaflet-clickable"),L.DomEvent.on(t,"click",this._onMouseClick,this),L.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)L.DomEvent.on(t,e[i],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var t=r.navigator.userAgent,e=t.indexOf("MSIE ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(t.indexOf("Trident/")>0){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}var n=t.indexOf("Edge/");return n>0&&parseInt(t.substring(n+5,t.indexOf(".",n)),10)}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,n=t.length;i<n;i++)Array.isArray(t[i])?e.push(L.LatLngUtil.cloneLatLngs(t[i])):e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},function(){var t={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(e){var i,n,o=e.length,c=0,h=Math.PI/180;if(o>2){for(var d=0;d<o;d++)i=e[d],n=e[(d+1)%o],c+=(n.lng-i.lng)*h*(2+Math.sin(i.lat*h)+Math.sin(n.lat*h));c=6378137*c*6378137/2}return Math.abs(c)},formattedNumber:function(e,i){var n=parseFloat(e).toFixed(i),o=L.drawLocal.format&&L.drawLocal.format.numeric,c=o&&o.delimiters,h=c&&c.thousands,d=c&&c.decimal;if(h||d){var f=n.split(".");n=h?f[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+h):f[0],d=d||".",f.length>1&&(n=n+d+f[1])}return n},readableArea:function(e,i,h){var o,c,h=L.Util.extend({},t,h);return i?(c=["ha","m"],type=typeof i,type==="string"?c=[i]:type!=="boolean"&&(c=i),o=e>=1e6&&c.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*e,h.km)+" km²":e>=1e4&&c.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*e,h.ha)+" ha":L.GeometryUtil.formattedNumber(e,h.m)+" m²"):(e/=.836127,o=e>=3097600?L.GeometryUtil.formattedNumber(e/3097600,h.mi)+" mi²":e>=4840?L.GeometryUtil.formattedNumber(e/4840,h.ac)+" acres":L.GeometryUtil.formattedNumber(e,h.yd)+" yd²"),o},readableDistance:function(e,i,n,o,d){var h,d=L.Util.extend({},t,d);switch(i?typeof i=="string"?i:"metric":n?"feet":o?"nauticalMile":"yards"){case"metric":h=e>1e3?L.GeometryUtil.formattedNumber(e/1e3,d.km)+" km":L.GeometryUtil.formattedNumber(e,d.m)+" m";break;case"feet":e*=3.28083,h=L.GeometryUtil.formattedNumber(e,d.ft)+" ft";break;case"nauticalMile":e*=.53996,h=L.GeometryUtil.formattedNumber(e/1e3,d.nm)+" nm";break;case"yards":default:e*=1.09361,h=e>1760?L.GeometryUtil.formattedNumber(e/1760,d.mi)+" miles":L.GeometryUtil.formattedNumber(e,d.yd)+" yd"}return h},isVersion07x:function(){var e=L.version.split(".");return parseInt(e[0],10)===0&&parseInt(e[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,n){return this._checkCounterclockwise(t,i,n)!==this._checkCounterclockwise(e,i,n)&&this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,n)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,i,n=this._getProjectedPoints(),o=n?n.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=o-1;t>=3;t--)if(e=n[t-1],i=n[t],this._lineSegmentsIntersectsRange(e,i,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,e){var i=this._getProjectedPoints(),n=i?i.length:0,o=i?i[n-1]:null,c=n-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(o,t,c,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._getProjectedPoints(),i=e?e.length:0;return i+=t||0,!e||i<=3},_lineSegmentsIntersectsRange:function(t,e,i,n){var o,c,h=this._getProjectedPoints();n=n||0;for(var d=i;d>n;d--)if(o=h[d-1],c=h[d],L.LineUtil.segmentsIntersect(t,e,o,c))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var t=[],e=this._defaultShape(),i=0;i<e.length;i++)t.push(this._map.latLngToLayerPoint(e[i]));return t}}),L.Polygon.include({intersects:function(){var t,e,i,n,o=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(t=o.length,e=o[0],i=o[t-1],n=t-2,this._lineSegmentsIntersectsRange(i,e,n,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,t);var e;this._toolbars={},L.DrawToolbar&&this.options.draw&&(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,i=L.DomUtil.create("div","leaflet-draw"),n=!1;for(var o in this._toolbars)this._toolbars.hasOwnProperty(o)&&(e=this._toolbars[o].addToolbar(t))&&(n||(L.DomUtil.hasClass(e,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(e.childNodes[0],"leaflet-draw-toolbar-top"),n=!0),i.appendChild(e));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=t.target;for(var i in this._toolbars)this._toolbars[i]!==e&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null;var e=L.version.split(".");parseInt(e[0],10)===1&&parseInt(e[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,i=L.DomUtil.create("div","leaflet-draw-section"),n=0,o=this._toolbarClass||"",c=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<c.length;e++)c[e].enabled&&this._initModeHandler(c[e].handler,this._toolbarContainer,n++,o,c[e].title);if(n)return this._lastButtonIndex=--n,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;e<i;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,n,o){var c=t.type;this._modes[c]={},this._modes[c].handler=t,this._modes[c].button=this._createButton({type:c,title:o,className:n+"-"+c,container:e,callback:this._modes[c].handler.enable,context:this._modes[c].handler}),this._modes[c].buttonIndex=i,this._modes[c].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!r.MSStream},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container),i=L.DomUtil.create("span","sr-only",t.container);e.href="#",e.appendChild(i),t.title&&(e.title=t.title,i.innerHTML=t.title),t.text&&(e.innerHTML=t.text,i.innerHTML=t.text);var n=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"touchstart",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,n,t.callback,t.context),e},_disposeButton:function(t,e){var i=this._detectIOS()?"touchstart":"click";L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"touchstart",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,i,e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){var e,i,n,o,c=this._actionsContainer,h=this.getActions(t),d=h.length;for(i=0,n=this._actionButtons.length;i<n;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];c.firstChild;)c.removeChild(c.firstChild);for(var f=0;f<d;f++)"enabled"in h[f]&&!h[f].enabled||(e=L.DomUtil.create("li","",c),o=this._createButton({title:h[f].title,text:h[f].text,container:e,callback:h[f].callback,context:h[f].context}),this._actionButtons.push({button:o,callback:h[f].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+"px",t===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._visible=!1,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||"",t.subtext.length!==0||this._singleLineLabel?t.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>",t.text||t.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&&(this._visible&&(i.style.visibility="inherit"),L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(t,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){L.setOptions(this,t);for(var e in this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&&(t.edit.selectedPathOptions===void 0&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&&(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(t){var e=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return t.removeAllLayers&&e.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),e},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=this.options.featureGroup,i=e.getLayers().length!==0;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,i?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,i?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer(function(e){e.edited&&(t.addLayer(e),e.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:(t instanceof L.Marker||t instanceof L.CircleMarker)&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):(t instanceof L.Marker||t instanceof L.CircleMarker)&&t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire("revert-edited",{layer:t}))},_enableLayerEdit:function(t){var e,i,n=t.layer||t.target||t;this._backupLayer(n),this.options.poly&&(i=L.Util.extend({},this.options.poly),n.options.poly=i),this.options.selectedPathOptions&&(e=L.Util.extend({},this.options.selectedPathOptions),e.maintainColor&&(e.color=n.options.color,e.fillColor=n.options.fillColor),n.options.original=L.extend({},n.options),n.options.editing=e),n instanceof L.Marker?(n.editing&&n.editing.enable(),n.dragging.enable(),n.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):n.editing.enable()},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,e.editing&&e.editing.disable(),delete e.options.editing,delete e.options.original,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):e.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onMarkerDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_onTouchMove:function(t){var e=t.originalEvent.changedTouches[0],i=this._map.mouseEventToLayerPoint(e),n=this._map.layerPointToLatLng(i);t.target.setLatLng(n)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var i=L.version.split(".");parseInt(i[0],10)===1&&parseInt(i[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t),t.fire("revert-deleted",{layer:t})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(t){this._removeLayer({layer:t})},this),this.save()},_enableLayerDelete:function(t){(t.layer||t.target||t).on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e),e.fire("deleted")},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);function ue(r,a){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);a&&(l=l.filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})),s.push.apply(s,l)}return s}function ft(r){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?ue(Object(s),!0).forEach(function(l){Ni(r,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):ue(Object(s)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(s,l))})}return r}function Ni(r,a,s){return a in r?Object.defineProperty(r,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[a]=s,r}var rt={onEdited:"draw:edited",onDrawStart:"draw:drawstart",onDrawStop:"draw:drawstop",onDrawVertex:"draw:drawvertex",onEditStart:"draw:editstart",onEditMove:"draw:editmove",onEditResize:"draw:editresize",onEditVertex:"draw:editvertex",onEditStop:"draw:editstop",onDeleted:"draw:deleted",onDeleteStart:"draw:deletestart",onDeleteStop:"draw:deletestop"};function Oe(r){var a=yt(),s=b.useRef(),l=b.useRef(r),t=function(i){var n=r.onCreated,o=a.layerContainer||a.map;o.addLayer(i.layer),n&&n(i)};return mt.useEffect(function(){var e=a.map,i=r.onMounted;for(var n in rt)e.on(rt[n],function(o){var c=Object.keys(rt).filter(function(d){return rt[d]===o.type});if(c.length===1){var h=c[0];r[h]&&r[h](o)}});return e.on(Ft.Draw.Event.CREATED,t),s.current=pe(r,a),e.addControl(s.current),i&&i(s.current),function(){e.off(Ft.Draw.Event.CREATED,t);for(var o in rt)r[o]&&e.off(rt[o],r[o]);s.current.remove(e)}},[r.onCreated,r.onDeleted,r.onEdited]),mt.useEffect(function(){if(!(re(r.draw,l.current.draw)&&re(r.edit,l.current.edit)&&r.position===l.current.position)){var e=a.map;s.current.remove(e),s.current=pe(r,a),s.current.addTo(e);var i=r.onMounted;return i&&i(s.current),function(){s.current.remove(e)}}},[r.draw,r.edit,r.position,r.onCreated,r.onDeleted,r.onEdited]),null}function pe(r,a){var s=a.layerContainer,l=r.draw,t=r.edit,e=r.position,i={edit:ft(ft({},t),{},{featureGroup:s})};return l&&(i.draw=ft({},l)),e&&(i.position=e),new N.Control.Draw(i)}Oe.propTypes=ft(ft({},Object.keys(rt).reduce(function(r,a){return r[a]=E.PropTypes.func,r},{})),{},{onCreated:E.PropTypes.func,onMounted:E.PropTypes.func,draw:E.PropTypes.shape({polyline:E.PropTypes.oneOfType([E.PropTypes.object,E.PropTypes.bool]),polygon:E.PropTypes.oneOfType([E.PropTypes.object,E.PropTypes.bool]),rectangle:E.PropTypes.oneOfType([E.PropTypes.object,E.PropTypes.bool]),circle:E.PropTypes.oneOfType([E.PropTypes.object,E.PropTypes.bool]),marker:E.PropTypes.oneOfType([E.PropTypes.object,E.PropTypes.bool])}),edit:E.PropTypes.shape({edit:E.PropTypes.oneOfType([E.PropTypes.object,E.PropTypes.bool]),remove:E.PropTypes.oneOfType([E.PropTypes.object,E.PropTypes.bool]),poly:E.PropTypes.oneOfType([E.PropTypes.object,E.PropTypes.bool]),allowIntersection:E.PropTypes.bool}),position:E.PropTypes.oneOf(["topright","topleft","bottomright","bottomleft"]),leaflet:E.PropTypes.shape({map:E.PropTypes.instanceOf(N.Map),layerContainer:E.PropTypes.shape({addLayer:E.PropTypes.func.isRequired,removeLayer:E.PropTypes.func.isRequired})})});const Zt=r=>JSON.parse(JSON.stringify(r),(a,s)=>Array.isArray(s)&&s.length>=2&&typeof s[0]=="number"&&typeof s[1]=="number"?[s[1],s[0],...s.slice(2)]:s),Ri=({point:r})=>{const a=R(Lt),[s,l]=b.useState(!1);return u.jsxs(Et,{open:s,onOpenChange:l,children:[u.jsx(Ot,{properties:r.properties,position:[r.geometry.coordinates[1],r.geometry.coordinates[0]],eventHandlers:{click:()=>{l(!0)}}}),u.jsx(Dt,{children:u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsx(ri,{className:"text-center !text-2xl font-bold font-poppins mt-3",value:r.properties?.name,onChange:t=>{r.properties.name=t.target.value,Q()}}),u.jsxs(Tt,{children:[u.jsx(Pt,{latitude:r.geometry.coordinates[1],longitude:r.geometry.coordinates[0],onChange:(t,e)=>{t&&(r.geometry.coordinates[1]=t),e&&(r.geometry.coordinates[0]=e),Q()}}),!a&&u.jsx(Qt,{children:u.jsx(Kt,{className:"bg-blue-600 p-2 rounded-md font-semibold font-poppins transition-shadow duration-500 mt-2",onClick:Ct,children:"Save"})})]})]})})]})},Ui=({point:r})=>{const a=R(Lt),[s,l]=b.useState(!1);return u.jsxs(Et,{open:s,onOpenChange:l,children:[u.jsx(Ot,{position:[r.geometry.coordinates[1],r.geometry.coordinates[0]],isDialog:!0,eventHandlers:{click:()=>{l(!0)}}}),u.jsx(Dt,{children:u.jsx("div",{className:"flex flex-col gap-2",children:u.jsxs(Tt,{children:[u.jsx(Pt,{latitude:r.geometry.coordinates[1],longitude:r.geometry.coordinates[0],onChange:(t,e)=>{t&&(r.geometry.coordinates[1]=t),e&&(r.geometry.coordinates[0]=e),Q()}}),!a&&u.jsx(Qt,{children:u.jsx(Kt,{className:"bg-blue-600 p-2 rounded-md font-semibold font-poppins transition-shadow duration-500 mt-2",onClick:Ct,children:"Save"})})]})})})]})},Bi=({point:r})=>{const a=R(Lt),[s,l]=b.useState(!1);return u.jsxs(Et,{open:s,onOpenChange:l,children:[u.jsx(Ot,{position:[r.geometry.coordinates[1],r.geometry.coordinates[0]],isDialog:!0,eventHandlers:{click:()=>{l(!0)}}}),u.jsx(Dt,{children:u.jsx("div",{className:"flex flex-col gap-2",children:u.jsxs(Tt,{children:[u.jsx(Pt,{latitude:r.geometry.coordinates[1],longitude:r.geometry.coordinates[0],onChange:(t,e)=>{t&&(r.geometry.coordinates[1]=t),e&&(r.geometry.coordinates[0]=e),Q()}}),!a&&u.jsx(Qt,{children:u.jsx(Kt,{className:"bg-blue-600 p-2 rounded-md font-semibold font-poppins transition-shadow duration-500 mt-2",onClick:Ct,children:"Save"})})]})})})]})},Hi=()=>{const r=R(zt),a=R(lt),s=b.useRef(null);let l;r===-1?N.drawLocal.draw.toolbar.buttons.polygon="Draw the hiding zone!":(l=a.find(e=>e.key===r),l?.data.drag===!1&&zt.set(-1),l?.id==="matching"&&(N.drawLocal.draw.toolbar.buttons.polygon="Draw the matching zone(s)!"),l?.id==="measuring"&&(N.drawLocal.draw.toolbar.buttons.polygon="Draw the measuring zone(s)!"));const t=()=>{if(zt.get()===-1){if(!s.current?._layers)return;const e=s.current._layers,i=Object.values(e).map(o=>o.toGeoJSON()),n=O(i);kt.set(n),_e.set(n),lt.set([]),Le(Ue.ZONE_CACHE)}else if(l?.id==="tentacles"&&l.data.locationType==="custom"){if(!s.current?._layers)return;const e=s.current._layers,i=Object.values(e).map(o=>{const c=o.toGeoJSON();return c.properties=o.options.properties,c.properties||(c.properties={name:Ve(c.geometry.coordinates)}),c}),n=O(i);l.data.places=At.uniqBy(n.features,o=>o.geometry.coordinates.join(",")),s.current&&Object.values(s.current._layers).map(o=>{o.options.properties||s.current.removeLayer(o)}),Q()}else if(l?.id==="matching"&&l.data.type==="custom-zone"){if(!s.current?._layers)return;const e=s.current._layers,i=Object.values(e).map(o=>o.toGeoJSON()),n=Ce(O(i)).features[0];l.data.geo=n,s.current&&Object.values(s.current._layers).map(o=>{o.options.isSpecial||s.current.removeLayer(o)}),Q()}else if(l?.id==="matching"&&l.data.type==="custom-points"){if(!s.current?._layers)return;const e=s.current._layers,i=Object.values(e).map(o=>o.toGeoJSON()),n=O(i);l.data.geo=At.uniqBy(n.features,o=>o.geometry.coordinates.join(",")),s.current&&Object.values(s.current._layers).map(o=>{o.options.isDialog||s.current.removeLayer(o)}),Q()}else if(l?.id==="measuring"&&l.data.type==="custom-measure"){if(!s.current?._layers)return;const e=s.current._layers,i=Object.values(e).map(o=>o.toGeoJSON()),n=O(i);l.data.geo=O(At.uniqBy(n.features,o=>o.geometry.coordinates.join(","))),s.current&&Object.values(s.current._layers).map(o=>{!o.options.isSpecial&&!o.options.isDialog&&s.current.removeLayer(o)}),Q()}};return b.useEffect(()=>{s.current&&r===-1&&s.current.clearLayers()},[r]),u.jsxs(yi,{ref:s,children:[l&&l.id==="tentacles"&&l.data.locationType==="custom"&&l.data.places.map(e=>u.jsx(Ri,{point:e},e.geometry.coordinates.join(","))),l&&l.id==="matching"&&l.data.type==="custom-points"&&l.data.geo.map(e=>u.jsx(Ui,{point:e},e.geometry.coordinates.join(","))),l&&l.id==="measuring"&&l.data.type==="custom-measure"&&pt(l.data.geo).features.filter(e=>jt(e)==="Point").map(e=>u.jsx(Bi,{point:e},e.geometry.coordinates.join(","))),l&&l.id==="measuring"&&l.data.type==="custom-measure"&&pt(l.data.geo).features.filter(e=>jt(e)==="Polygon").map(e=>u.jsx(ae,{positions:Zt(e.geometry.coordinates),isSpecial:!0,stroke:!0,pathOptions:{color:"red"},fill:!1},e.geometry.coordinates.join(","))),l&&l.id==="measuring"&&l.data.type==="custom-measure"&&pt(l.data.geo).features.filter(e=>jt(e)==="LineString").map(e=>u.jsx(Mi,{positions:Zt(e.geometry.coordinates),isSpecial:!0,stroke:!0,pathOptions:{color:"red"},fill:!1},e.geometry.coordinates.join(","))),l&&l.id==="matching"&&l.data.type==="custom-zone"&&l.data.geo&&(l.data.geo.type==="FeatureCollection"?pt(l.data.geo):pt(O([l.data.geo]))).features.map(e=>u.jsx(ae,{positions:Zt(e.geometry.coordinates),isSpecial:!0,stroke:!0,pathOptions:{color:"red"},fill:!1},JSON.stringify(e))),u.jsx(Oe,{position:"bottomleft",draw:{rectangle:!1,circle:!1,circlemarker:!1,marker:l?.id==="tentacles"||l?.id==="matching"&&l.data.type==="custom-points"||l?.id==="measuring",polyline:l?.id==="measuring",polygon:l?.id==="tentacles"||l?.id==="matching"&&l.data.type==="custom-points"?!1:{shapeOptions:{fillOpacity:0}}},onCreated:t,onEdited:t,onDeleted:t})]})};function Gi(r){return Ee({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 0 0-11.3 0l-42.4 42.3a8.03 8.03 0 0 0 0 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 0 0 4.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 0 0 0 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 0 0 391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 0 0-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 0 0-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 0 0-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"},child:[]}]})(r)}function Wi(r){return Ee({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 0 0-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0 0 13.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 0 0 0 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 0 0-11.3 0l-42.4 42.3a8.03 8.03 0 0 0 0 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 0 0 4.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 0 0-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 0 0-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"},child:[]}]})(r)}const Zi=()=>{const[r,a]=b.useState(!1);return u.jsx("a",{className:"leaflet-full-screen-specific-name bg-white hover:bg-[#f4f4f4] w-[30px] h-[30px] rounded-sm leading-[30px] text-[22px] flex items-center justify-center border-2 border-black border-opacity-30 cursor-pointer",onClick:()=>{const s=document.querySelector("#map-modal-dialog-container-leaflet");document.fullscreenElement?(document.exitFullscreen(),a(!1)):(s&&s.requestFullscreen(),a(!0))},children:r?u.jsx(Gi,{className:"w-6 h-6 text-black"}):u.jsx(Wi,{className:"w-6 h-6 text-black"})})},Fi=async r=>{switch(r.id){case"radius":r.data=xi(r.data);break;case"thermometer":r.data=Ti(r.data);break;case"tentacles":r.data=await Ii(r.data);break;case"matching":r.data=await ei(r.data);break;case"measuring":r.data=await ti(r.data);break}return r};var fe={exports:{}},me;function Vi(){return me||(me=1,function(r,a){(function(s,l){l()})(0,function(){function s(i,n){return n={exports:{}},i(n,n.exports),n.exports}var l=typeof window<"u"?window:typeof ee<"u"?ee:typeof self<"u"?self:{},t=s(function(i){(function(n){function o(_,p){function m(v){return p.bgcolor&&(v.style.backgroundColor=p.bgcolor),p.width&&(v.style.width=p.width+"px"),p.height&&(v.style.height=p.height+"px"),p.style&&Object.keys(p.style).forEach(function(S){v.style[S]=p.style[S]}),v}return p=p||{},P(p),Promise.resolve(_).then(function(v){return w(v,p.filter,!0)}).then(j).then(at).then(m).then(function(v){return st(v,p.width||k.width(_),p.height||k.height(_))})}function c(_,p){return g(_,p||{}).then(function(m){return m.getContext("2d").getImageData(0,0,k.width(_),k.height(_)).data})}function h(_,p){return g(_,p||{}).then(function(m){return m.toDataURL()})}function d(_,p){return p=p||{},g(_,p).then(function(m){return m.toDataURL("image/jpeg",p.quality||1)})}function f(_,p){return g(_,p||{}).then(k.canvasToBlob)}function P(_){_.imagePlaceholder===void 0?z.impl.options.imagePlaceholder=D.imagePlaceholder:z.impl.options.imagePlaceholder=_.imagePlaceholder,_.cacheBust===void 0?z.impl.options.cacheBust=D.cacheBust:z.impl.options.cacheBust=_.cacheBust}function g(_,p){function m(v){var S=document.createElement("canvas");if(S.width=p.width||k.width(v),S.height=p.height||k.height(v),p.bgcolor){var x=S.getContext("2d");x.fillStyle=p.bgcolor,x.fillRect(0,0,S.width,S.height)}return S}return o(_,p).then(k.makeImage).then(k.delay(100)).then(function(v){var S=m(_);return S.getContext("2d").drawImage(v,0,0),S})}function w(_,p,m){function v(M){return M instanceof HTMLCanvasElement?k.makeImage(M.toDataURL()):M.cloneNode(!1)}function S(M,C,Z){var F=M.childNodes;return F.length===0?Promise.resolve(C):function(B,nt,V){var H=Promise.resolve();return nt.forEach(function(K){H=H.then(function(){return w(K,V)}).then(function($){$&&B.appendChild($)})}),H}(C,k.asArray(F),Z).then(function(){return C})}function x(M,C){function Z(){(function(V,H){V.cssText?H.cssText=V.cssText:function(K,$){k.asArray(K).forEach(function(Y){$.setProperty(Y,K.getPropertyValue(Y),K.getPropertyPriority(Y))})}(V,H)})(window.getComputedStyle(M),C.style)}function F(){function V(H){var K=window.getComputedStyle(M,H),$=K.getPropertyValue("content");if($!==""&&$!=="none"){var Y=k.uid();C.className=C.className+" "+Y;var y=document.createElement("style");y.appendChild(function(T,I,A){var X="."+T+":"+I,q=A.cssText?function(U){var tt=U.getPropertyValue("content");return U.cssText+" content: "+tt+";"}(A):function(U){function tt(ot){return ot+": "+U.getPropertyValue(ot)+(U.getPropertyPriority(ot)?" !important":"")}return k.asArray(U).map(tt).join("; ")+";"}(A);return document.createTextNode(X+"{"+q+"}")}(Y,H,K)),C.appendChild(y)}}[":before",":after"].forEach(function(H){V(H)})}function B(){M instanceof HTMLTextAreaElement&&(C.innerHTML=M.value),M instanceof HTMLInputElement&&C.setAttribute("value",M.value)}function nt(){C instanceof SVGElement&&(C.setAttribute("xmlns","http://www.w3.org/2000/svg"),C instanceof SVGRectElement&&["width","height"].forEach(function(V){var H=C.getAttribute(V);H&&C.style.setProperty(V,H)}))}return C instanceof Element?Promise.resolve().then(Z).then(F).then(B).then(nt).then(function(){return C}):C}return m||!p||p(_)?Promise.resolve(_).then(v).then(function(M){return S(_,M,p)}).then(function(M){return x(_,M)}):Promise.resolve()}function j(_){return G.resolveAll().then(function(p){var m=document.createElement("style");return _.appendChild(m),m.appendChild(document.createTextNode(p)),_})}function at(_){return vt.inlineAll(_).then(function(){return _})}function st(_,p,m){return Promise.resolve(_).then(function(v){return v.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(v)}).then(k.escapeXhtml).then(function(v){return'<foreignObject x="0" y="0" width="100%" height="100%">'+v+"</foreignObject>"}).then(function(v){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+p+'" height="'+m+'">'+v+"</svg>"}).then(function(v){return"data:image/svg+xml;charset=utf-8,"+v})}var k=function(){function _(){var y="application/font-woff",T="image/jpeg";return{woff:y,woff2:y,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:T,jpeg:T,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function p(y){var T=/\.([^\.\/]*?)$/g.exec(y);return T?T[1]:""}function m(y){var T=p(y).toLowerCase();return _()[T]||""}function v(y){return y.search(/^(data:)/)!==-1}function S(y){return new Promise(function(T){for(var I=window.atob(y.toDataURL().split(",")[1]),A=I.length,X=new Uint8Array(A),q=0;q<A;q++)X[q]=I.charCodeAt(q);T(new Blob([X],{type:"image/png"}))})}function x(y){return y.toBlob?new Promise(function(T){y.toBlob(T)}):S(y)}function M(y,T){var I=document.implementation.createHTMLDocument(),A=I.createElement("base");I.head.appendChild(A);var X=I.createElement("a");return I.body.appendChild(X),A.href=T,X.href=y,X.href}function C(y){return new Promise(function(T,I){var A=new Image;A.onload=function(){T(A)},A.onerror=I,A.src=y})}function Z(y){var T=3e4;return z.impl.options.cacheBust&&(y+=(/\?/.test(y)?"&":"?")+new Date().getTime()),new Promise(function(I){function A(){if(U.readyState===4){if(U.status!==200)return void(tt?I(tt):q("cannot fetch resource: "+y+", status: "+U.status));var dt=new FileReader;dt.onloadend=function(){var ze=dt.result.split(/,/)[1];I(ze)},dt.readAsDataURL(U.response)}}function X(){tt?I(tt):q("timeout of "+T+"ms occured while fetching resource: "+y)}function q(dt){console.error(dt),I("")}var U=new XMLHttpRequest;U.onreadystatechange=A,U.ontimeout=X,U.responseType="blob",U.timeout=T,U.open("GET",y,!0),U.send();var tt;if(z.impl.options.imagePlaceholder){var ot=z.impl.options.imagePlaceholder.split(/,/);ot&&ot[1]&&(tt=ot[1])}})}function F(y,T){return"data:"+T+";base64,"+y}function B(y){return y.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function nt(y){return function(T){return new Promise(function(I){setTimeout(function(){I(T)},y)})}}function V(y){for(var T=[],I=y.length,A=0;A<I;A++)T.push(y[A]);return T}function H(y){return y.replace(/#/g,"%23").replace(/\n/g,"%0A")}function K(y){var T=Y(y,"border-left-width"),I=Y(y,"border-right-width");return y.scrollWidth+T+I}function $(y){var T=Y(y,"border-top-width"),I=Y(y,"border-bottom-width");return y.scrollHeight+T+I}function Y(y,T){var I=window.getComputedStyle(y).getPropertyValue(T);return parseFloat(I.replace("px",""))}return{escape:B,parseExtension:p,mimeType:m,dataAsUrl:F,isDataUrl:v,canvasToBlob:x,resolveUrl:M,getAndEncode:Z,uid:function(){var y=0;return function(){return"u"+function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}()+y++}}(),delay:nt,asArray:V,escapeXhtml:H,makeImage:C,width:K,height:$}}(),it=function(){function _(x){return x.search(S)!==-1}function p(x){for(var M,C=[];(M=S.exec(x))!==null;)C.push(M[1]);return C.filter(function(Z){return!k.isDataUrl(Z)})}function m(x,M,C,Z){function F(B){return new RegExp(`(url\\(['"]?)(`+k.escape(B)+`)(['"]?\\))`,"g")}return Promise.resolve(M).then(function(B){return C?k.resolveUrl(B,C):B}).then(Z||k.getAndEncode).then(function(B){return k.dataAsUrl(B,k.mimeType(M))}).then(function(B){return x.replace(F(M),"$1"+B+"$3")})}function v(x,M,C){return function(){return!_(x)}()?Promise.resolve(x):Promise.resolve(x).then(p).then(function(Z){var F=Promise.resolve(x);return Z.forEach(function(B){F=F.then(function(nt){return m(nt,B,M,C)})}),F})}var S=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:v,shouldProcess:_,impl:{readUrls:p,inline:m}}}(),G=function(){function _(){return p().then(function(m){return Promise.all(m.map(function(v){return v.resolve()}))}).then(function(m){return m.join(`
`)})}function p(){function m(x){return x.filter(function(M){return M.type===CSSRule.FONT_FACE_RULE}).filter(function(M){return it.shouldProcess(M.style.getPropertyValue("src"))})}function v(x){var M=[];return x.forEach(function(C){try{k.asArray(C.cssRules||[]).forEach(M.push.bind(M))}catch(Z){console.log("Error while reading CSS rules from "+C.href,Z.toString())}}),M}function S(x){return{resolve:function(){var M=(x.parentStyleSheet||{}).href;return it.inlineAll(x.cssText,M)},src:function(){return x.style.getPropertyValue("src")}}}return Promise.resolve(k.asArray(document.styleSheets)).then(v).then(m).then(function(x){return x.map(S)})}return{resolveAll:_,impl:{readAll:p}}}(),vt=function(){function _(m){function v(S){return k.isDataUrl(m.src)?Promise.resolve():Promise.resolve(m.src).then(S||k.getAndEncode).then(function(x){return k.dataAsUrl(x,k.mimeType(m.src))}).then(function(x){return new Promise(function(M,C){m.onload=M,m.onerror=C,m.src=x})})}return{inline:v}}function p(m){return m instanceof Element?function(v){var S=v.style.getPropertyValue("background");return S?it.inlineAll(S).then(function(x){v.style.setProperty("background",x,v.style.getPropertyPriority("background"))}).then(function(){return v}):Promise.resolve(v)}(m).then(function(){return m instanceof HTMLImageElement?_(m).inline():Promise.all(k.asArray(m.childNodes).map(function(v){return p(v)}))}):Promise.resolve(m)}return{inlineAll:p,impl:{newImage:_}}}(),D={imagePlaceholder:void 0,cacheBust:!1},z={toSvg:o,toPng:h,toJpeg:d,toBlob:f,toPixelData:c,impl:{fontFaces:G,images:vt,util:k,inliner:it,options:{}}};i.exports=z})()}),e=s(function(i){var n=n||function(o){if(!(o===void 0||typeof navigator<"u"&&/MSIE [1-9]\./.test(navigator.userAgent))){var c=o.document,h=function(){return o.URL||o.webkitURL||o},d=c.createElementNS("http://www.w3.org/1999/xhtml","a"),f="download"in d,P=function(D){var z=new MouseEvent("click");D.dispatchEvent(z)},g=/constructor/i.test(o.HTMLElement)||o.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent),j=function(D){(o.setImmediate||o.setTimeout)(function(){throw D},0)},at=function(D){var z=function(){typeof D=="string"?h().revokeObjectURL(D):D.remove()};setTimeout(z,4e4)},st=function(D,z,_){z=[].concat(z);for(var p=z.length;p--;){var m=D["on"+z[p]];if(typeof m=="function")try{m.call(D,_||D)}catch(v){j(v)}}},k=function(D){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(D.type)?new Blob(["\uFEFF",D],{type:D.type}):D},it=function(D,z,_){_||(D=k(D));var p,m=this,v=D.type,S=v==="application/octet-stream",x=function(){st(m,"writestart progress write writeend".split(" "))};if(m.readyState=m.INIT,f)return p=h().createObjectURL(D),void setTimeout(function(){d.href=p,d.download=z,P(d),x(),at(p),m.readyState=m.DONE});(function(){if((w||S&&g)&&o.FileReader){var M=new FileReader;return M.onloadend=function(){var C=w?M.result:M.result.replace(/^data:[^;]*;/,"data:attachment/file;");o.open(C,"_blank")||(o.location.href=C),C=void 0,m.readyState=m.DONE,x()},M.readAsDataURL(D),void(m.readyState=m.INIT)}p||(p=h().createObjectURL(D)),S?o.location.href=p:o.open(p,"_blank")||(o.location.href=p),m.readyState=m.DONE,x(),at(p)})()},G=it.prototype,vt=function(D,z,_){return new it(D,z||D.name||"download",_)};return typeof navigator<"u"&&navigator.msSaveOrOpenBlob?function(D,z,_){return z=z||D.name||"download",_||(D=k(D)),navigator.msSaveOrOpenBlob(D,z)}:(G.abort=function(){},G.readyState=G.INIT=0,G.WRITING=1,G.DONE=2,G.error=G.onwritestart=G.onprogress=G.onwrite=G.onabort=G.onerror=G.onwriteend=null,vt)}}(typeof self<"u"&&self||typeof window<"u"&&window||l.content);i.exports&&(i.exports.saveAs=n)});L.Control.EasyPrint=L.Control.extend({options:{title:"Print map",position:"topleft",sizeModes:["Current"],filename:"map",exportOnly:!1,hidden:!1,tileWait:500,hideControlContainer:!0,hideClasses:[],customWindowTitle:window.document.title,spinnerBgCOlor:"#0DC5C1",customSpinnerClass:"epLoader",defaultSizeTitles:{Current:"Current Size",A4Landscape:"A4 Landscape",A4Portrait:"A4 Portrait"}},onAdd:function(){this.mapContainer=this._map.getContainer(),this.options.sizeModes=this.options.sizeModes.map(function(o){return o==="Current"?{name:this.options.defaultSizeTitles.Current,className:"CurrentSize"}:o==="A4Landscape"?{height:this._a4PageSize.height,width:this._a4PageSize.width,name:this.options.defaultSizeTitles.A4Landscape,className:"A4Landscape page"}:o==="A4Portrait"?{height:this._a4PageSize.width,width:this._a4PageSize.height,name:this.options.defaultSizeTitles.A4Portrait,className:"A4Portrait page"}:o},this);var i=L.DomUtil.create("div","leaflet-control-easyPrint leaflet-bar leaflet-control");if(!this.options.hidden){this._addCss(),L.DomEvent.addListener(i,"mouseover",this._togglePageSizeButtons,this),L.DomEvent.addListener(i,"mouseout",this._togglePageSizeButtons,this);var n="leaflet-control-easyPrint-button";this.options.exportOnly&&(n+="-export"),this.link=L.DomUtil.create("a",n,i),this.link.id="leafletEasyPrint",this.link.title=this.options.title,this.holder=L.DomUtil.create("ul","easyPrintHolder",i),this.options.sizeModes.forEach(function(o){var c=L.DomUtil.create("li","easyPrintSizeMode",this.holder);c.title=o.name,L.DomUtil.create("a",o.className,c),L.DomEvent.addListener(c,"click",this.printMap,this)},this),L.DomEvent.disableClickPropagation(i)}return i},printMap:function(i,n){n&&(this.options.filename=n),this.options.exportOnly||(this._page=window.open("","_blank","toolbar=no,status=no,menubar=no,scrollbars=no,resizable=no,left=10, top=10, width=200, height=250, visible=none"),this._page.document.write(this._createSpinner(this.options.customWindowTitle,this.options.customSpinnerClass,this.options.spinnerBgCOlor))),this.originalState={mapWidth:this.mapContainer.style.width,widthWasAuto:!1,widthWasPercentage:!1,mapHeight:this.mapContainer.style.height,zoom:this._map.getZoom(),center:this._map.getCenter()},this.originalState.mapWidth==="auto"?(this.originalState.mapWidth=this._map.getSize().x+"px",this.originalState.widthWasAuto=!0):this.originalState.mapWidth.includes("%")&&(this.originalState.percentageWidth=this.originalState.mapWidth,this.originalState.widthWasPercentage=!0,this.originalState.mapWidth=this._map.getSize().x+"px"),this._map.fire("easyPrint-start",{event:i}),this.options.hidden||this._togglePageSizeButtons({type:null}),this.options.hideControlContainer&&this._toggleControls(),this.options.hideClasses.length>0&&this._toggleClasses(this.options.hideClasses);var o=typeof i!="string"?i.target.className:i;if(o==="CurrentSize")return this._printOpertion(o);this.outerContainer=this._createOuterContainer(this.mapContainer),this.originalState.widthWasAuto&&(this.outerContainer.style.width=this.originalState.mapWidth),this._createImagePlaceholder(o)},_createImagePlaceholder:function(i){var n=this;t.toPng(this.mapContainer,{width:parseInt(this.originalState.mapWidth.replace("px")),height:parseInt(this.originalState.mapHeight.replace("px"))}).then(function(o){n.blankDiv=document.createElement("div");var c=n.blankDiv;n.outerContainer.parentElement.insertBefore(c,n.outerContainer),c.className="epHolder",c.style.backgroundImage='url("'+o+'")',c.style.position="absolute",c.style.zIndex=1011,c.style.display="initial",c.style.width=n.originalState.mapWidth,c.style.height=n.originalState.mapHeight,n._resizeAndPrintMap(i)}).catch(function(o){console.error("oops, something went wrong!",o)})},_resizeAndPrintMap:function(i){this.outerContainer.style.opacity=0;var n=this.options.sizeModes.filter(function(o){return o.className===i});n=n[0],this.mapContainer.style.width=n.width+"px",this.mapContainer.style.height=n.height+"px",this.mapContainer.style.width>this.mapContainer.style.height?this.orientation="portrait":this.orientation="landscape",this._map.setView(this.originalState.center),this._map.setZoom(this.originalState.zoom),this._map.invalidateSize(),this.options.tileLayer?this._pausePrint(i):this._printOpertion(i)},_pausePrint:function(i){var n=this,o=setInterval(function(){n.options.tileLayer.isLoading()||(clearInterval(o),n._printOpertion(i))},n.options.tileWait)},_printOpertion:function(i){var n=this,o=this.mapContainer.style.width;(this.originalState.widthWasAuto&&i==="CurrentSize"||this.originalState.widthWasPercentage&&i==="CurrentSize")&&(o=this.originalState.mapWidth),t.toPng(n.mapContainer,{width:parseInt(o),height:parseInt(n.mapContainer.style.height.replace("px"))}).then(function(c){var h=n._dataURItoBlob(c);n.options.exportOnly?e.saveAs(h,n.options.filename+".png"):n._sendToBrowserPrint(c,n.orientation),n._toggleControls(!0),n._toggleClasses(n.options.hideClasses,!0),n.outerContainer&&(n.originalState.widthWasAuto?n.mapContainer.style.width="auto":n.originalState.widthWasPercentage?n.mapContainer.style.width=n.originalState.percentageWidth:n.mapContainer.style.width=n.originalState.mapWidth,n.mapContainer.style.height=n.originalState.mapHeight,n._removeOuterContainer(n.mapContainer,n.outerContainer,n.blankDiv),n._map.invalidateSize(),n._map.setView(n.originalState.center),n._map.setZoom(n.originalState.zoom)),n._map.fire("easyPrint-finished")}).catch(function(c){console.error("Print operation failed",c)})},_sendToBrowserPrint:function(i,n){this._page.resizeTo(600,800);var o=this._createNewWindow(i,n,this);this._page.document.body.innerHTML="",this._page.document.write(o),this._page.document.close()},_createSpinner:function(i,n,o){return"<html><head><title>"+i+`</title></head><body><style>
      body{
        background: `+o+`;
      }
      .epLoader,
      .epLoader:before,
      .epLoader:after {
        border-radius: 50%;
      }
      .epLoader {
        color: #ffffff;
        font-size: 11px;
        text-indent: -99999em;
        margin: 55px auto;
        position: relative;
        width: 10em;
        height: 10em;
        box-shadow: inset 0 0 0 1em;
        -webkit-transform: translateZ(0);
        -ms-transform: translateZ(0);
        transform: translateZ(0);
      }
      .epLoader:before,
      .epLoader:after {
        position: absolute;
        content: '';
      }
      .epLoader:before {
        width: 5.2em;
        height: 10.2em;
        background: #0dc5c1;
        border-radius: 10.2em 0 0 10.2em;
        top: -0.1em;
        left: -0.1em;
        -webkit-transform-origin: 5.2em 5.1em;
        transform-origin: 5.2em 5.1em;
        -webkit-animation: load2 2s infinite ease 1.5s;
        animation: load2 2s infinite ease 1.5s;
      }
      .epLoader:after {
        width: 5.2em;
        height: 10.2em;
        background: #0dc5c1;
        border-radius: 0 10.2em 10.2em 0;
        top: -0.1em;
        left: 5.1em;
        -webkit-transform-origin: 0px 5.1em;
        transform-origin: 0px 5.1em;
        -webkit-animation: load2 2s infinite ease;
        animation: load2 2s infinite ease;
      }
      @-webkit-keyframes load2 {
        0% {
          -webkit-transform: rotate(0deg);
          transform: rotate(0deg);
        }
        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg);
        }
      }
      @keyframes load2 {
        0% {
          -webkit-transform: rotate(0deg);
          transform: rotate(0deg);
        }
        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg);
        }
      }
      </style>
    <div class="`+n+'">Loading...</div></body></html>'},_createNewWindow:function(i,n,o){return`<html><head>
        <style>@media print {
          img { max-width: 98%!important; max-height: 98%!important; }
          @page { size: `+n+`;}}
        </style>
        <script>function step1(){
        setTimeout('step2()', 10);}
        function step2(){window.print();window.close()}
        <\/script></head><body onload='step1()'>
        <img src="`+i+'" style="display:block; margin:auto;"></body></html>'},_createOuterContainer:function(i){var n=document.createElement("div");return i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),n.appendChild(i),n.style.width=i.style.width,n.style.height=i.style.height,n.style.display="inline-block",n.style.overflow="hidden",n},_removeOuterContainer:function(i,n,o){n.parentNode&&(n.parentNode.insertBefore(i,n),n.parentNode.removeChild(o),n.parentNode.removeChild(n))},_addCss:function(){var i=document.createElement("style");i.type="text/css",i.innerHTML=`.leaflet-control-easyPrint-button { 
      background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxMiA1MTI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPGc+Cgk8cGF0aCBkPSJNMTI4LDMyaDI1NnY2NEgxMjhWMzJ6IE00ODAsMTI4SDMyYy0xNy42LDAtMzIsMTQuNC0zMiwzMnYxNjBjMCwxNy42LDE0LjM5OCwzMiwzMiwzMmg5NnYxMjhoMjU2VjM1Mmg5NiAgIGMxNy42LDAsMzItMTQuNCwzMi0zMlYxNjBDNTEyLDE0Mi40LDQ5Ny42LDEyOCw0ODAsMTI4eiBNMzUyLDQ0OEgxNjBWMjg4aDE5MlY0NDh6IE00ODcuMTk5LDE3NmMwLDEyLjgxMy0xMC4zODcsMjMuMi0yMy4xOTcsMjMuMiAgIGMtMTIuODEyLDAtMjMuMjAxLTEwLjM4Ny0yMy4yMDEtMjMuMnMxMC4zODktMjMuMiwyMy4xOTktMjMuMkM0NzYuODE0LDE1Mi44LDQ4Ny4xOTksMTYzLjE4Nyw0ODcuMTk5LDE3NnoiIGZpbGw9IiMwMDAwMDAiLz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K);
      background-size: 16px 16px; 
      cursor: pointer; 
    }
    .leaflet-control-easyPrint-button-export { 
      background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDQzMy41IDQzMy41IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0MzMuNSA0MzMuNTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8Zz4KCTxnIGlkPSJmaWxlLWRvd25sb2FkIj4KCQk8cGF0aCBkPSJNMzk1LjI1LDE1M2gtMTAyVjBoLTE1M3YxNTNoLTEwMmwxNzguNSwxNzguNUwzOTUuMjUsMTUzeiBNMzguMjUsMzgyLjV2NTFoMzU3di01MUgzOC4yNXoiIGZpbGw9IiMwMDAwMDAiLz4KCTwvZz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K);
      background-size: 16px 16px; 
      cursor: pointer; 
    }
    .easyPrintHolder a {
      background-size: 16px 16px;
      cursor: pointer;
    }
    .easyPrintHolder .CurrentSize{
      background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTZweCIgdmVyc2lvbj0iMS4xIiBoZWlnaHQ9IjE2cHgiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNjQgNjQiPgogIDxnPgogICAgPGcgZmlsbD0iIzFEMUQxQiI+CiAgICAgIDxwYXRoIGQ9Ik0yNS4yNTUsMzUuOTA1TDQuMDE2LDU3LjE0NVY0Ni41OWMwLTEuMTA4LTAuODk3LTIuMDA4LTIuMDA4LTIuMDA4QzAuODk4LDQ0LjU4MiwwLDQ1LjQ4MSwwLDQ2LjU5djE1LjQwMiAgICBjMCwwLjI2MSwwLjA1MywwLjUyMSwwLjE1NSwwLjc2N2MwLjIwMywwLjQ5MiwwLjU5NCwwLjg4MiwxLjA4NiwxLjA4N0MxLjQ4Niw2My45NDcsMS43NDcsNjQsMi4wMDgsNjRoMTUuNDAzICAgIGMxLjEwOSwwLDIuMDA4LTAuODk4LDIuMDA4LTIuMDA4cy0wLjg5OC0yLjAwOC0yLjAwOC0yLjAwOEg2Ljg1NWwyMS4yMzgtMjEuMjRjMC43ODQtMC43ODQsMC43ODQtMi4wNTUsMC0yLjgzOSAgICBTMjYuMDM5LDM1LjEyMSwyNS4yNTUsMzUuOTA1eiIgZmlsbD0iIzAwMDAwMCIvPgogICAgICA8cGF0aCBkPSJtNjMuODQ1LDEuMjQxYy0wLjIwMy0wLjQ5MS0wLjU5NC0wLjg4Mi0xLjA4Ni0xLjA4Ny0wLjI0NS0wLjEwMS0wLjUwNi0wLjE1NC0wLjc2Ny0wLjE1NGgtMTUuNDAzYy0xLjEwOSwwLTIuMDA4LDAuODk4LTIuMDA4LDIuMDA4czAuODk4LDIuMDA4IDIuMDA4LDIuMDA4aDEwLjU1NmwtMjEuMjM4LDIxLjI0Yy0wLjc4NCwwLjc4NC0wLjc4NCwyLjA1NSAwLDIuODM5IDAuMzkyLDAuMzkyIDAuOTA2LDAuNTg5IDEuNDIsMC41ODlzMS4wMjctMC4xOTcgMS40MTktMC41ODlsMjEuMjM4LTIxLjI0djEwLjU1NWMwLDEuMTA4IDAuODk3LDIuMDA4IDIuMDA4LDIuMDA4IDEuMTA5LDAgMi4wMDgtMC44OTkgMi4wMDgtMi4wMDh2LTE1LjQwMmMwLTAuMjYxLTAuMDUzLTAuNTIyLTAuMTU1LTAuNzY3eiIgZmlsbD0iIzAwMDAwMCIvPgogICAgPC9nPgogIDwvZz4KPC9zdmc+Cg==)
    }
    .easyPrintHolder .page {
      background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTguMS4xLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDQ0NC44MzMgNDQ0LjgzMyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDQ0LjgzMyA0NDQuODMzOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjUxMnB4IiBoZWlnaHQ9IjUxMnB4Ij4KPGc+Cgk8Zz4KCQk8cGF0aCBkPSJNNTUuMjUsNDQ0LjgzM2gzMzQuMzMzYzkuMzUsMCwxNy03LjY1LDE3LTE3VjEzOS4xMTdjMC00LjgxNy0xLjk4My05LjM1LTUuMzgzLTEyLjQ2N0wyNjkuNzMzLDQuNTMzICAgIEMyNjYuNjE3LDEuNywyNjIuMzY3LDAsMjU4LjExNywwSDU1LjI1Yy05LjM1LDAtMTcsNy42NS0xNywxN3Y0MTAuODMzQzM4LjI1LDQzNy4xODMsNDUuOSw0NDQuODMzLDU1LjI1LDQ0NC44MzN6ICAgICBNMzcyLjU4MywxNDYuNDgzdjAuODVIMjU2LjQxN3YtMTA4LjhMMzcyLjU4MywxNDYuNDgzeiBNNzIuMjUsMzRoMTUwLjE2N3YxMzAuMzMzYzAsOS4zNSw3LjY1LDE3LDE3LDE3aDEzMy4xNjd2MjI5LjVINzIuMjVWMzR6ICAgICIgZmlsbD0iIzAwMDAwMCIvPgoJPC9nPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo=);
    }
    .easyPrintHolder .A4Landscape { 
      transform: rotate(-90deg);
    }

    .leaflet-control-easyPrint-button{
      display: inline-block;
    }
    .easyPrintHolder{
      margin-top:-31px;
      margin-bottom: -5px;
      margin-left: 30px;
      padding-left: 0px;
      display: none;
    }

    .easyPrintSizeMode {
      display: inline-block;
    }
    .easyPrintHolder .easyPrintSizeMode a {
      border-radius: 0px;
    }

    .easyPrintHolder .easyPrintSizeMode:last-child a{
      border-top-right-radius: 2px;
      border-bottom-right-radius: 2px;
      margin-left: -1px;
    }

    .easyPrintPortrait:hover, .easyPrintLandscape:hover{
      background-color: #757570;
      cursor: pointer;
    }`,document.body.appendChild(i)},_dataURItoBlob:function(i){for(var n=atob(i.split(",")[1]),o=i.split(",")[0].split(":")[1].split(";")[0],c=new ArrayBuffer(n.length),h=new DataView(c),d=0;d<n.length;d++)h.setUint8(d,n.charCodeAt(d));return new Blob([c],{type:o})},_togglePageSizeButtons:function(i){var n=this.holder.style,o=this.link.style;i.type==="mouseover"?(n.display="block",o.borderTopRightRadius="0",o.borderBottomRightRadius="0"):(n.display="none",o.borderTopRightRadius="2px",o.borderBottomRightRadius="2px")},_toggleControls:function(i){var n=document.getElementsByClassName("leaflet-control-container")[0];if(i)return n.style.display="block";n.style.display="none"},_toggleClasses:function(i,n){i.forEach(function(o){var c=document.getElementsByClassName(o)[0];if(n)return c.style.display="block";c.style.display="none"})},_a4PageSize:{height:715,width:1045}}),L.easyPrint=function(i){return new L.Control.EasyPrint(i)}})}()),fe.exports}Vi();const Yi=r=>{const a=Li();return b.useEffect(()=>{const s=Ft.easyPrint({...r});return a.addControl(s),()=>{a.removeControl(s)}},[a]),null},Ji=(r=!0,a)=>{const s=async()=>{const l=await Promise.all([{location:ve.get(),added:!0,base:!0},...ye.get()].map(async i=>({added:i.added,data:await Ge(i.location.properties.osm_id.toString(),i.location.properties.osm_type)})));let t=O([gt(O(l.filter(i=>i.added).flatMap(i=>i.data.features)))]);const e=l.filter(i=>!i.added).map(i=>i.data);if(e.length>0&&(t=O([oi(O([t.features[0],...e.flatMap(i=>i.features)]))])),We(t).length>1e4&&Je(t,{tolerance:5e-4,highQuality:!0,mutate:!0}),kt.set(t),r){if(!a)return;Qi(a,t)}return t};return bt.promise(s().catch(l=>console.log(l)),{error:"Error refreshing map data"})},dn=({className:r})=>{R(ye);const a=R(ve),s=R(lt),l=R(Be),t=R(et),e=R(wt),i=R(te),n=async(c=!1)=>{if(!i||e)return;wt.set(!0),s.length===0&&await Le();let h=kt.get();if(!h){const d=_e.get();d?(h=d,kt.set(d)):h=await Ji(!1,i)}if(t!==!1){for(const d of s)await Fi(d);Vt.set(Math.random())}i.eachLayer(d=>{(d.questionKey||d.questionKey===0)&&i.removeLayer(d)});try{for(let P=0;P<s.length;P++){const g=s[P];switch(g?.id){case"radius":if(g.data.drag&&J.get()){const w=Ci(g.data),j=N.geoJSON(w);j.questionKey=g.key,j.addTo(i)}if(J.get()&&g.data.drag||!g.data.within)break;h=Ut(g.data,h,!1);break;case"thermometer":if(g.data.drag&&J.get()){const w=Pi(g.data),j=N.geoJSON(w);j.questionKey=g.key,j.addTo(i)}if(J.get()&&g.data.drag)break;h=Di(g.data,h,!1);break;case"tentacles":if(g.data.drag&&J.get()){const w=await Oi(g.data),j=N.geoJSON(w);j.questionKey=g.key,j.addTo(i)}if(J.get()&&g.data.drag||g.data.location===!1)break;h=await Si(g.data,h,!1);break;case"matching":if(g.data.drag&&J.get()){const w=await ni(g.data);if(w){const j=N.geoJSON(w);j.questionKey=g.key,j.addTo(i)}}if(J.get()&&g.data.drag)break;try{h=await ne(g.data,h,!1)}catch(w){if(!(w&&w.message==="Must be masked"))throw console.log(w),w}break;case"measuring":if(g.data.drag&&J.get()){const w=await ii(g.data);if(w){const j=N.geoJSON(w);j.questionKey=g.key,j.addTo(i)}}if(J.get()&&g.data.drag)break;try{h=await ie(g.data,h,!1)}catch(w){if(!(w&&w.message==="Must be masked"))throw console.log(w),w}break}h.type!=="FeatureCollection"&&(h={type:"FeatureCollection",features:[h]})}let d;if(c){const P=ke(h);d=[[P[1],P[0]],[P[3],P[2]]]}h={type:"FeatureCollection",features:[xe(h)]};for(let P=0;P<s.length;P++){const g=s[P];if(!(J.get()&&g.data.drag)){switch(g?.id){case"radius":if(g.data.within)break;h=Ut(g.data,h,!0);break;case"tentacles":if(g.data.location!==!1)break;h=Ut({...g.data,within:!1},h,!0);break;case"matching":try{h=await ne(g.data,h,!0)}catch(w){if(!(w&&w.message==="Cannot be masked"))throw console.log(w),w}break;case"measuring":try{h=await ie(g.data,h,!0)}catch(w){if(!(w&&w.message==="Cannot be masked"))throw console.log(w),w}break}h.type!=="FeatureCollection"&&(h={type:"FeatureCollection",features:[h]})}}i.eachLayer(P=>{P.eliminationGeoJSON&&i.removeLayer(P)});const f=N.geoJSON(h);f.eliminationGeoJSON=!0,f.addTo(i),He.set(h),we.get()&&d&&(Me.get()?i.flyToBounds(d):i.fitBounds(d))}catch(d){if(console.log(d),wt.set(!1),document.querySelectorAll(".Toastify__toast").length===0)return bt.error("No solutions found / error occurred")}finally{wt.set(!1)}},o=b.useMemo(()=>u.jsxs(wi,{center:a.geometry.coordinates,zoom:5,className:Ae("w-[500px] h-[500px]",r),ref:te.set,contextmenu:!0,contextmenuWidth:140,contextmenuItems:[{text:"Add Radius",callback:c=>ut({id:"radius",data:{lat:c.latlng.lat,lng:c.latlng.lng}})},{text:"Add Thermometer",callback:c=>{const h=Ye([c.latlng.lng,c.latlng.lat],5,90,{units:"miles"});ut({id:"thermometer",data:{latA:c.latlng.lat,lngA:c.latlng.lng,latB:h.geometry.coordinates[1],lngB:h.geometry.coordinates[0]}})}},{text:"Add Tentacles",callback:c=>{ut({id:"tentacles",data:{lat:c.latlng.lat,lng:c.latlng.lng}})}},{text:"Add Matching",callback:c=>{ut({id:"matching",data:{lat:c.latlng.lat,lng:c.latlng.lng}})}},{text:"Add Measuring",callback:c=>{ut({id:"measuring",data:{lat:c.latlng.lat,lng:c.latlng.lng}})}},{text:"Copy Coordinates",callback:c=>{if(!navigator||!navigator.clipboard){bt.error("Clipboard API not supported in your browser");return}const h=c.latlng.lat,d=c.latlng.lng;bt.promise(navigator.clipboard.writeText(`${Math.abs(h)}°${h>0?"N":"S"}, ${Math.abs(d)}°${d>0?"E":"W"}`),{pending:"Writing to clipboard...",success:"Coordinates copied!",error:"An error occurred while copying"},{autoClose:1e3})}}],children:[u.jsx(se,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors © <a href="https://carto.com/attributions">CARTO</a> and <a href="http://www.thunderforest.com/">Thunderforest</a>',url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",subdomains:"abcd",maxZoom:20,minZoom:2,noWrap:!0}),l&&u.jsx(se,{url:"https://tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey=80add02166f6434d8e6dca27b0573474",maxZoom:22,minZoom:7,noWrap:!0}),u.jsx(Ei,{}),u.jsx("div",{className:"leaflet-top leaflet-right",children:u.jsx("div",{className:"leaflet-control flex-col flex gap-2",children:u.jsx(Zi,{})})}),u.jsx(Hi,{}),u.jsx(bi,{position:"bottomleft"}),u.jsx(Yi,{position:"topright",sizeModes:["Current","A4Portrait","A4Landscape"],hideControlContainer:!1,hideClasses:["leaflet-full-screen-specific-name","leaflet-top","leaflet-control-easyPrint","leaflet-draw"],title:"Print"})]}),[i,l]);return b.useEffect(()=>{i&&n(!0)},[s,i,t]),b.useEffect(()=>{const c=setInterval(async()=>{if(!i)return;let h=0;i.eachLayer(d=>{d.eliminationGeoJSON&&h++}),h>1&&(console.log("Too many layers, refreshing..."),n(!1))},1e3);return()=>clearInterval(c)},[i]),b.useEffect(()=>{const c=()=>{const h=document.querySelector("main");h&&(document.fullscreenElement?h.classList.add("fullscreen"):h.classList.remove("fullscreen"))};return document.addEventListener("fullscreenchange",c),()=>{document.removeEventListener("fullscreenchange",c)}},[]),o},Qi=(r,a)=>{r.eachLayer(e=>{e.eliminationGeoJSON&&r.removeLayer(e)});const s=N.geoJSON(xe(a));s.eliminationGeoJSON=!0,s.addTo(r);const l=ke(a),t=[[l[1],l[0]],[l[3],l[2]]];we.get()&&(Me.get()?r.flyToBounds(t):r.fitBounds(t))};export{dn as Map};
