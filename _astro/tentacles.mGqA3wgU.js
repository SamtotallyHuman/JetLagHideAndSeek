import{K as ps,j as T,O as Mu,P as bu,m as _s,W as Pu,h as Au,C as Du,q as Fu,y as Gu,T as zu,D as Yu,b as ks,R as qu,d as Bu,a as Le,L as xs,u as fe,M as ju}from"./index.Eoy0PIGW.js";import{L as qt,U as Es}from"./UnitSelect.DDefIxes.js";import{A as $t,X as Bt,x as dt,Y as pn,Z as Ai,G as Ee,y as Dt,J as ke,R as Ns,z as Is,N as $e,$ as Ar,a0 as Dr,a1 as wi,a2 as ei,a3 as Uu,a4 as Xu,a5 as Un,a6 as Ss,a7 as Xn,a8 as Vu,a9 as Fr,aa as Hu,q as gt,_ as _n,ab as Gr,H as Di,I as ut,p as Vn,m as ws,ac as zt,ad as Cs,n as Tt,O as Hn,K as Ft,L as Zu,c as Zn,t as kn,B as Ts,T as ot,i as xn,S as ye,ae as zr,af as jt,ag as Ut,ah as Xt,U as $u,ai as Wu,F as Qu,M as Ju,Q as Yr,aj as qr,P as Br,ak as jr}from"./context.BZhA5a5S.js";import{c as Ku,h as eo,d as to,e as no,f as Oe,M as Me}from"./sidebar-l.CRgB3qwZ.js";import{C as Ve,S as hn}from"./checkbox.AQu349VM.js";import{a as cn,e as io,i as ro,b as fn,g as so,u as gn,s as Fi,c as ao,h as mn,f as uo,j as oo}from"./geo-utils.DA-aplVt.js";import{y as mt}from"./_astro-entry_react-toastify.BqZZ0Rhh.js";import{g as lo,r as Ie}from"./index.DUAV1Q2A.js";import{G as Ls,S as Rs,I as Os}from"./iconBase.DK9oy1VT.js";function ho(a,o,c){var f=a.length,h=Gt(a[0],o),y=[],N,m,L;let p,_;for(c||(c=[]),N=1;N<f;N++){for(p=a[N-1],_=a[N],m=L=Gt(_,o);;)if(h|m){if(h&m)break;h?(p=Ci(p,_,h,o),h=Gt(p,o)):(_=Ci(p,_,m,o),m=Gt(_,o))}else{y.push(p),m!==L?(y.push(_),N<f-1&&(c.push(y),y=[])):N===f-1&&y.push(_);break}h=L}return y.length&&c.push(y),c}function co(a,o){var c,f,h,y,N,m,L;for(f=1;f<=8;f*=2){for(c=[],h=a[a.length-1],y=!(Gt(h,o)&f),N=0;N<a.length;N++)m=a[N],L=!(Gt(m,o)&f),L!==y&&c.push(Ci(h,m,f,o)),L&&c.push(m),h=m,y=L;if(a=c,!a.length)break}return c}function Ci(a,o,c,f){return c&8?[a[0]+(o[0]-a[0])*(f[3]-a[1])/(o[1]-a[1]),f[3]]:c&4?[a[0]+(o[0]-a[0])*(f[1]-a[1])/(o[1]-a[1]),f[1]]:c&2?[f[2],a[1]+(o[1]-a[1])*(f[2]-a[0])/(o[0]-a[0])]:c&1?[f[0],a[1]+(o[1]-a[1])*(f[0]-a[0])/(o[0]-a[0])]:null}function Gt(a,o){var c=0;return a[0]<o[0]?c|=1:a[0]>o[2]&&(c|=2),a[1]<o[1]?c|=4:a[1]>o[3]&&(c|=8),c}function fo(a,o){const c=$t(a),f=c.type,h=a.type==="Feature"?a.properties:{};let y=c.coordinates;switch(f){case"LineString":case"MultiLineString":{const N=[];return f==="LineString"&&(y=[y]),y.forEach(m=>{ho(m,o,N)}),N.length===1?pn(N[0],h):Ai(N,h)}case"Polygon":return dt(Ur(y,o),h);case"MultiPolygon":return Bt(y.map(N=>Ur(N,o)),h);default:throw new Error("geometry "+f+" not supported")}}function Ur(a,o){const c=[];for(const f of a){const h=co(f,o);h.length>0&&((h[0][0]!==h[h.length-1][0]||h[0][1]!==h[h.length-1][1])&&h.push(h[0]),h.length>=4&&c.push(h))}return c}function Ms(a,o={}){const c=Number(a[0]),f=Number(a[1]),h=Number(a[2]),y=Number(a[3]);if(a.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const N=[c,f];return dt([[N,[h,f],[h,y],[c,y],N]],o.properties,{bbox:a,id:o.id})}function Gi(a,o={}){const c=$t(a);switch(!o.properties&&a.type==="Feature"&&(o.properties=a.properties),c.type){case"Polygon":return go(c,o);case"MultiPolygon":return mo(c,o);default:throw new Error("invalid poly")}}function go(a,o={}){const f=$t(a).coordinates,h=o.properties?o.properties:a.type==="Feature"?a.properties:{};return bs(f,h)}function mo(a,o={}){const f=$t(a).coordinates,h=o.properties?o.properties:a.type==="Feature"?a.properties:{},y=[];return f.forEach(N=>{y.push(bs(N,h))}),Ee(y)}function bs(a,o){return a.length>1?Ai(a,o):pn(a[0],o)}var vo=Object.defineProperty,yo=Object.defineProperties,po=Object.getOwnPropertyDescriptors,Xr=Object.getOwnPropertySymbols,_o=Object.prototype.hasOwnProperty,ko=Object.prototype.propertyIsEnumerable,Vr=(a,o,c)=>o in a?vo(a,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[o]=c,Hr=(a,o)=>{for(var c in o||(o={}))_o.call(o,c)&&Vr(a,c,o[c]);if(Xr)for(var c of Xr(o))ko.call(o,c)&&Vr(a,c,o[c]);return a},Zr=(a,o)=>yo(a,po(o));function xo(a,o,c={}){if(!a||!o)throw new Error("lines and pt are required arguments");const f=Dt(o);let h=ke([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),y=0;return Ns(a,function(N,m,L){const p=Is(N);for(let _=0;_<p.length-1;_++){const E=ke(p[_]);E.properties.dist=$e(o,E,c);const k=Dt(E),C=ke(p[_+1]);C.properties.dist=$e(o,C,c);const w=Dt(C),H=$e(E,C,c);let G,Q;k[0]===f[0]&&k[1]===f[1]?[G,,Q]=[k,void 0,!1]:w[0]===f[0]&&w[1]===f[1]?[G,,Q]=[w,void 0,!0]:[G,,Q]=Io(E.geometry.coordinates,C.geometry.coordinates,Dt(o));let D;G&&(D=ke(G,{dist:$e(o,G,c),multiFeatureIndex:L,location:y+$e(E,G,c)})),D&&D.properties.dist<h.properties.dist&&(h=Zr(Hr({},D),{properties:Zr(Hr({},D.properties),{index:Q?_+1:_})})),y+=H}}),h}function Eo(a,o){const[c,f,h]=a,[y,N,m]=o;return c*y+f*N+h*m}function No(a,o){const[c,f,h]=a,[y,N,m]=o;return[f*m-h*N,h*y-c*m,c*N-f*y]}function $r(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2))}function St(a,o){const c=Eo(a,o)/($r(a)*$r(o));return Math.acos(Math.min(Math.max(c,-1),1))}function Ei(a){const o=Ar(a[1]),c=Ar(a[0]);return[Math.cos(o)*Math.cos(c),Math.cos(o)*Math.sin(c),Math.sin(o)]}function wt(a){const[o,c,f]=a,h=Dr(Math.asin(f));return[Dr(Math.atan2(c,o)),h]}function Io(a,o,c){const f=Ei(a),h=Ei(o),y=Ei(c),[N,m,L]=y,[p,_,E]=No(f,h),k=_*L-E*m,C=E*N-p*L,w=p*m-_*N,H=w*_-C*E,G=k*E-w*p,Q=C*p-k*_,D=1/Math.sqrt(Math.pow(H,2)+Math.pow(G,2)+Math.pow(Q,2)),A=[H*D,G*D,Q*D],V=[-1*H*D,-1*G*D,-1*Q*D],F=St(f,h),q=St(f,A),j=St(h,A),$=St(f,V),B=St(h,V);let se;return q<$&&q<B||j<$&&j<B?se=A:se=V,St(f,se)>F||St(h,se)>F?$e(wt(se),wt(f))<=$e(wt(se),wt(h))?[wt(f),!0,!1]:[wt(h),!1,!0]:[wt(se),!1,!1]}function So(a,o={}){const c=cn(a),f=(c[0]+c[2])/2,h=(c[1]+c[3])/2;return ke([f,h],o.properties,o)}var qn={exports:{}},wo=qn.exports,Wr;function Co(){return Wr||(Wr=1,function(a,o){(function(c,f){a.exports=f()})(wo,function(){function c(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function f(i,e,t){return e=_(e),function(n,r){if(r&&(typeof r=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(n)}(i,k()?Reflect.construct(e,t||[],_(i).constructor):e.apply(i,t))}function h(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function y(i,e,t){if(k())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(i.bind.apply(i,n));return t&&C(r,t.prototype),r}function N(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,G(n.key),n)}}function m(i,e,t){return e&&N(i.prototype,e),t&&N(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function L(i,e){var t=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!t){if(Array.isArray(i)||(t=Q(i))||e){t&&(i=t);var n=0,r=function(){};return{s:r,n:function(){return n>=i.length?{done:!0}:{done:!1,value:i[n++]}},e:function(g){throw g},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,u=!0,l=!1;return{s:function(){t=t.call(i)},n:function(){var g=t.next();return u=g.done,g},e:function(g){l=!0,s=g},f:function(){try{u||t.return==null||t.return()}finally{if(l)throw s}}}}function p(){return p=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,e,t){var n=function(s,u){for(;!{}.hasOwnProperty.call(s,u)&&(s=_(s))!==null;);return s}(i,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?i:t):r.value}},p.apply(null,arguments)}function _(i){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(i)}function E(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&C(i,e)}function k(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(k=function(){return!!i})()}function C(i,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},C(i,e)}function w(i,e,t,n){var r=p(_(1&n?i.prototype:i),e,t);return 2&n&&typeof r=="function"?function(s){return r.apply(t,s)}:r}function H(i){return function(e){if(Array.isArray(e))return c(e)}(i)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(i)||Q(i)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function G(i){var e=function(t,n){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i,"string");return typeof e=="symbol"?e:e+""}function Q(i,e){if(i){if(typeof i=="string")return c(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(i,e):void 0}}function D(i){var e=typeof Map=="function"?new Map:void 0;return D=function(t){if(t===null||!function(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return y(t,arguments,_(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),C(n,t)},D(i)}var A=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(e){this._quadrantSegments=e,this._quadrantSegments===0&&(this._joinStyle=i.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=i.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==i.JOIN_ROUND&&(this._quadrantSegments=i.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(e){this._joinStyle=e}},{key:"setSimplifyFactor",value:function(e){this._simplifyFactor=e<0?0:e}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(e){this._endCapStyle=e}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(e){this._mitreLimit=e}},{key:"setSingleSided",value:function(e){this._isSingleSided=e}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=i.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=i.CAP_ROUND,this._joinStyle=i.JOIN_ROUND,this._mitreLimit=i.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=i.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setQuadrantSegments(e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(n)}else if(arguments.length===4){var r=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(s),this.setJoinStyle(u),this.setMitreLimit(l)}}}},{key:"bufferDistanceError",value:function(e){var t=Math.PI/2/e;return 1-Math.cos(t/2)}}])}();A.CAP_ROUND=1,A.CAP_FLAT=2,A.CAP_SQUARE=3,A.JOIN_ROUND=1,A.JOIN_MITRE=2,A.JOIN_BEVEL=3,A.DEFAULT_QUADRANT_SEGMENTS=8,A.DEFAULT_MITRE_LIMIT=5,A.DEFAULT_SIMPLIFY_FACTOR=.01;var V=function(i){function e(t){var n;return h(this,e),(n=f(this,e,[t])).name=Object.keys({Exception:e})[0],n}return E(e,i),m(e,[{key:"toString",value:function(){return this.message}}])}(D(Error)),F=function(i){function e(t){var n;return h(this,e),(n=f(this,e,[t])).name=Object.keys({IllegalArgumentException:e})[0],n}return E(e,i),m(e)}(V),q=function(){return m(function i(){h(this,i)},[{key:"filter",value:function(i){}}])}();function j(){}function $(){}function B(){}var se,le,he,xe,P,te,oe,me,Se=function(){return m(function i(){h(this,i)},null,[{key:"equalsWithTolerance",value:function(i,e,t){return Math.abs(i-e)<=t}}])}(),we=function(){return m(function i(e,t){h(this,i),this.low=t||0,this.high=e||0},null,[{key:"toBinaryString",value:function(i){var e,t="";for(e=2147483648;e>0;e>>>=1)t+=(i.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)t+=(i.low&e)===e?"1":"0";return t}}])}();function Y(){}function Pe(){}Y.NaN=NaN,Y.isNaN=function(i){return Number.isNaN(i)},Y.isInfinite=function(i){return!Number.isFinite(i)},Y.MAX_VALUE=Number.MAX_VALUE,Y.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Y.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(te=2146435072,oe=new Float64Array(1),me=new Int32Array(oe.buffer),Y.doubleToLongBits=function(i){oe[0]=i;var e=0|me[0],t=0|me[1];return(t&te)===te&&1048575&t&&e!==0&&(e=0,t=2146959360),new we(t,e)},Y.longBitsToDouble=function(i){return me[0]=i.low,me[1]=i.high,oe[0]}):(se=1023,le=Math.log2,he=Math.floor,xe=Math.pow,P=function(){for(var i=53;i>0;i--){var e=xe(2,i)-1;if(he(le(e))+1===i)return e}return 0}(),Y.doubleToLongBits=function(i){var e,t,n,r,s,u,l,g,d;if(i<0||1/i===Number.NEGATIVE_INFINITY?(u=1<<31,i=-i):u=0,i===0)return new we(g=u,d=0);if(i===1/0)return new we(g=2146435072|u,d=0);if(i!=i)return new we(g=2146959360,d=0);if(r=0,d=0,(e=he(i))>1)if(e<=P)(r=he(le(e)))<=20?(d=0,g=e<<20-r&1048575):(d=e%(t=xe(2,n=r-20))<<32-n,g=e/t&1048575);else for(n=e,d=0;(n=he(t=n/2))!==0;)r++,d>>>=1,d|=(1&g)<<31,g>>>=1,t!==n&&(g|=524288);if(l=r+se,s=e===0,e=i-e,r<52&&e!==0)for(n=0;;){if((t=2*e)>=1?(e=t-1,s?(l--,s=!1):(n<<=1,n|=1,r++)):(e=t,s?--l==0&&(r++,s=!1):(n<<=1,r++)),r===20)g|=n,n=0;else if(r===52){d|=n;break}if(t===1){r<20?g|=n<<20-r:r<52&&(d|=n<<52-r);break}}return g|=l<<20,new we(g|=u,d)},Y.longBitsToDouble=function(i){var e,t,n,r,s=i.high,u=i.low,l=s&1<<31?-1:1;for(n=((2146435072&s)>>20)-se,r=0,t=1<<19,e=1;e<=20;e++)s&t&&(r+=xe(2,-e)),t>>>=1;for(t=1<<31,e=21;e<=52;e++)u&t&&(r+=xe(2,-e)),t>>>=1;if(n===-1023){if(r===0)return 0*l;n=-1022}else{if(n===1024)return r===0?l/0:NaN;r+=1}return l*r*xe(2,n)});var Ce=function(i){function e(t){var n;return h(this,e),(n=f(this,e,[t])).name=Object.keys({RuntimeException:e})[0],n}return E(e,i),m(e)}(V),De=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,null,[{key:"constructor_",value:function(){if(arguments.length===0)Ce.constructor_.call(this);else if(arguments.length===1){var t=arguments[0];Ce.constructor_.call(this,t)}}}])}(Ce),ee=function(){function i(){h(this,i)}return m(i,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)i.shouldNeverReachHere(null);else if(arguments.length===1){var e=arguments[0];throw new De("Should never reach here"+(e!==null?": "+e:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var e=arguments[0];i.isTrue(e,null)}else if(arguments.length===2){var t=arguments[1];if(!arguments[0])throw t===null?new De:new De(t)}}},{key:"equals",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];i.equals(e,t,null)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];if(!r.equals(n))throw new De("Expected "+n+" but encountered "+r+(s!==null?": "+s:""))}}}])}(),it=new ArrayBuffer(8),Ia=new Float64Array(it),Yi=new Int32Array(it),S=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getM",value:function(){return Y.NaN}},{key:"setOrdinate",value:function(e,t){switch(e){case i.X:this.x=t;break;case i.Y:this.y=t;break;case i.Z:this.setZ(t);break;default:throw new F("Invalid ordinate index: "+e)}}},{key:"equals2D",value:function(){if(arguments.length===1){var e=arguments[0];return this.x===e.x&&this.y===e.y}if(arguments.length===2){var t=arguments[0],n=arguments[1];return!!Se.equalsWithTolerance(this.x,t.x,n)&&!!Se.equalsWithTolerance(this.y,t.y,n)}}},{key:"setM",value:function(e){throw new F("Invalid ordinate index: "+i.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(e){switch(e){case i.X:return this.x;case i.Y:return this.y;case i.Z:return this.getZ()}throw new F("Invalid ordinate index: "+e)}},{key:"equals3D",value:function(e){return this.x===e.x&&this.y===e.y&&(this.getZ()===e.getZ()||Y.isNaN(this.getZ())&&Y.isNaN(e.getZ()))}},{key:"equals",value:function(e){return e instanceof i&&this.equals2D(e)}},{key:"equalInZ",value:function(e,t){return Se.equalsWithTolerance(this.getZ(),e.getZ(),t)}},{key:"setX",value:function(e){this.x=e}},{key:"compareTo",value:function(e){var t=e;return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(e){this.z=e}},{key:"clone",value:function(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return ee.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw e}}},{key:"copy",value:function(){return new i(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.getZ()-e.getZ();return Math.sqrt(t*t+n*n+r*r)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(e){this.y=e}},{key:"distance",value:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}},{key:"hashCode",value:function(){var e=17;return e=37*(e=37*e+i.hashCode(this.x))+i.hashCode(this.y)}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ()}},{key:"interfaces_",get:function(){return[j,$,B]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)i.constructor_.call(this,0,0);else if(arguments.length===1){var e=arguments[0];i.constructor_.call(this,e.x,e.y,e.getZ())}else if(arguments.length===2){var t=arguments[0],n=arguments[1];i.constructor_.call(this,t,n,i.NULL_ORDINATE)}else if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];this.x=r,this.y=s,this.z=u}}},{key:"hashCode",value:function(e){return Ia[0]=e,Yi[0]^Yi[1]}}])}(),Sa=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"compare",value:function(e,t){var n=i.compare(e.x,t.x);if(n!==0)return n;var r=i.compare(e.y,t.y);return r!==0?r:this._dimensionsToTest<=2?0:i.compare(e.getZ(),t.getZ())}},{key:"interfaces_",get:function(){return[Pe]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)i.constructor_.call(this,2);else if(arguments.length===1){var e=arguments[0];if(e!==2&&e!==3)throw new F("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}}},{key:"compare",value:function(e,t){return e<t?-1:e>t?1:Y.isNaN(e)?Y.isNaN(t)?0:-1:Y.isNaN(t)?1:0}}])}();S.DimensionalComparator=Sa,S.NULL_ORDINATE=Y.NaN,S.X=0,S.Y=1,S.Z=2,S.M=3;var ge=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(e){if(!(e instanceof i))return!1;var t=e;return this.isNull()?t.isNull():this._maxx===t.getMaxX()&&this._maxy===t.getMaxY()&&this._minx===t.getMinX()&&this._miny===t.getMinY()}},{key:"intersection",value:function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new i;var t=this._minx>e._minx?this._minx:e._minx,n=this._miny>e._miny?this._miny:e._miny;return new i(t,this._maxx<e._maxx?this._maxx:e._maxx,n,this._maxy<e._maxy?this._maxy:e._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];return this.covers(e.x,e.y)}if(arguments[0]instanceof i){var t=arguments[0];return!this.isNull()&&!t.isNull()&&t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&r>=this._miny&&r<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return!this.isNull()&&!e.isNull()&&!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}if(arguments[0]instanceof S){var t=arguments[0];return this.intersects(t.x,t.y)}}else if(arguments.length===2){if(arguments[0]instanceof S&&arguments[1]instanceof S){var n=arguments[0],r=arguments[1];return!this.isNull()&&!((n.x<r.x?n.x:r.x)>this._maxx)&&!((n.x>r.x?n.x:r.x)<this._minx)&&!((n.y<r.y?n.y:r.y)>this._maxy)&&!((n.y>r.y?n.y:r.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var s=arguments[0],u=arguments[1];return!this.isNull()&&!(s>this._maxx||s<this._minx||u>this._maxy||u<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return Math.sqrt(e*e+t*t)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof i){var t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=r,this._maxy=r):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e<t?e:t}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(e){var t=e;return this.isNull()?t.isNull()?0:-1:t.isNull()?1:this._minx<t._minx?-1:this._minx>t._minx?1:this._miny<t._miny?-1:this._miny>t._miny?1:this._maxx<t._maxx?-1:this._maxx>t._maxx?1:this._maxy<t._maxy?-1:this._maxy>t._maxy?1:0}},{key:"translate",value:function(e,t){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+t,this.getMaxY()+t)}},{key:"copy",value:function(){return new i(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(e){return!(!this.isNull()&&!e.isNull())||e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e>t?e:t}},{key:"expandBy",value:function(){if(arguments.length===1){var e=arguments[0];this.expandBy(e,e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return this.covers(e)}if(arguments[0]instanceof S){var t=arguments[0];return this.covers(t)}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.covers(n,r)}}},{key:"centre",value:function(){return this.isNull()?null:new S((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof i){var t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(arguments.length===4){var s=arguments[0],u=arguments[1],l=arguments[2],g=arguments[3];s<u?(this._minx=s,this._maxx=u):(this._minx=u,this._maxx=s),l<g?(this._miny=l,this._maxy=g):(this._miny=g,this._maxy=l)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(e){if(this.intersects(e))return 0;var t=0;this._maxx<e._minx?t=e._minx-this._maxx:this._minx>e._maxx&&(t=this._minx-e._maxx);var n=0;return this._maxy<e._miny?n=e._miny-this._maxy:this._miny>e._maxy&&(n=this._miny-e._maxy),t===0?n:n===0?t:Math.sqrt(t*t+n*n)}},{key:"hashCode",value:function(){var e=17;return e=37*(e=37*(e=37*(e=37*e+S.hashCode(this._minx))+S.hashCode(this._maxx))+S.hashCode(this._miny))+S.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[j,B]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof i){var t=arguments[0];this.init(t)}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(arguments.length===4){var s=arguments[0],u=arguments[1],l=arguments[2],g=arguments[3];this.init(s,u,l,g)}}},{key:"intersects",value:function(){if(arguments.length===3){var e=arguments[0],t=arguments[1],n=arguments[2];return n.x>=(e.x<t.x?e.x:t.x)&&n.x<=(e.x>t.x?e.x:t.x)&&n.y>=(e.y<t.y?e.y:t.y)&&n.y<=(e.y>t.y?e.y:t.y)}if(arguments.length===4){var r=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],g=Math.min(u.x,l.x),d=Math.max(u.x,l.x),x=Math.min(r.x,s.x),I=Math.max(r.x,s.x);return!(x>d)&&!(I<g)&&(g=Math.min(u.y,l.y),d=Math.max(u.y,l.y),x=Math.min(r.y,s.y),I=Math.max(r.y,s.y),!(x>d)&&!(I<g))}}}])}(),U=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===i.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(e){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(e){return this===e||this.equalsExact(e,0)}},{key:"geometryChanged",value:function(){this.apply(i.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(e){return e!==null&&this.norm().equalsExact(e.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var e;if(arguments.length===1){var t=arguments[0];return e=t,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(arguments.length===2){var n=arguments[0],r=arguments[1];return e=n,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n,r)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(e){if(e.getTypeCode()===i.TYPECODE_GEOMETRYCOLLECTION)throw new F("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(e,t,n){return n===0?e.equals(t):e.distance(t)<=n}},{key:"norm",value:function(){var e=this.copy();return e.normalize(),e}},{key:"reverse",value:function(){var e=this.reverseInternal();return this.envelope!=null&&(e.envelope=this.envelope.copy()),e.setSRID(this.getSRID()),e}},{key:"copy",value:function(){var e=this.copyInternal();return e.envelope=this._envelope==null?null:this._envelope.copy(),e._SRID=this._SRID,e._userData=this._userData,e}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new ge(this._envelope)}},{key:"setSRID",value:function(e){this._SRID=e}},{key:"setUserData",value:function(e){this._userData=e}},{key:"compare",value:function(e,t){for(var n=e.iterator(),r=t.iterator();n.hasNext()&&r.hasNext();){var s=n.next(),u=r.next(),l=s.compareTo(u);if(l!==0)return l}return n.hasNext()?1:r.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(e){return this.getClass()===e.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===i.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===i.TYPECODE_MULTIPOINT||this.getTypeCode()===i.TYPECODE_MULTILINESTRING||this.getTypeCode()===i.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[$,j,B]}},{key:"getClass",value:function(){return i}}],[{key:"hasNonEmptyElements",value:function(e){for(var t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(e){for(var t=0;t<e.length;t++)if(e[t]===null)return!0;return!1}}])}();U.constructor_=function(i){i&&(this._envelope=null,this._userData=null,this._factory=i,this._SRID=i.getSRID())},U.TYPECODE_POINT=0,U.TYPECODE_MULTIPOINT=1,U.TYPECODE_LINESTRING=2,U.TYPECODE_LINEARRING=3,U.TYPECODE_MULTILINESTRING=4,U.TYPECODE_POLYGON=5,U.TYPECODE_MULTIPOLYGON=6,U.TYPECODE_GEOMETRYCOLLECTION=7,U.TYPENAME_POINT="Point",U.TYPENAME_MULTIPOINT="MultiPoint",U.TYPENAME_LINESTRING="LineString",U.TYPENAME_LINEARRING="LinearRing",U.TYPENAME_MULTILINESTRING="MultiLineString",U.TYPENAME_POLYGON="Polygon",U.TYPENAME_MULTIPOLYGON="MultiPolygon",U.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",U.geometryChangedFilter={get interfaces_(){return[q]},filter:function(i){i.geometryChangedAction()}};var v=function(){function i(){h(this,i)}return m(i,null,[{key:"toLocationSymbol",value:function(e){switch(e){case i.EXTERIOR:return"e";case i.BOUNDARY:return"b";case i.INTERIOR:return"i";case i.NONE:return"-"}throw new F("Unknown location value: "+e)}}])}();v.INTERIOR=0,v.BOUNDARY=1,v.EXTERIOR=2,v.NONE=-1;var We=function(){return m(function i(){h(this,i)},[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])}(),Nn=function(i){function e(t){var n;return h(this,e),(n=f(this,e,[t])).name=Object.keys({NoSuchElementException:e})[0],n}return E(e,i),m(e)}(V),ht=function(i){function e(t){var n;return h(this,e),(n=f(this,e,[t])).name=Object.keys({UnsupportedOperationException:e})[0],n}return E(e,i),m(e)}(V),qi=function(i){function e(){return h(this,e),f(this,e,arguments)}return E(e,i),m(e,[{key:"contains",value:function(){}}])}(We),ti=function(i){function e(t){var n;return h(this,e),(n=f(this,e)).map=new Map,t instanceof We&&n.addAll(t),n}return E(e,i),m(e,[{key:"contains",value:function(t){var n=t.hashCode?t.hashCode():t;return!!this.map.has(n)}},{key:"add",value:function(t){var n=t.hashCode?t.hashCode():t;return!this.map.has(n)&&!!this.map.set(n,t)}},{key:"addAll",value:function(t){var n,r=L(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;this.add(s)}}catch(u){r.e(u)}finally{r.f()}return!0}},{key:"remove",value:function(){throw new ht}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new wa(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])}(qi),wa=function(){return m(function i(e){h(this,i),this.iterator=e.values();var t=this.iterator.next(),n=t.done,r=t.value;this.done=n,this.value=r},[{key:"next",value:function(){if(this.done)throw new Nn;var i=this.value,e=this.iterator.next(),t=e.done,n=e.value;return this.done=t,this.value=n,i}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new ht}}])}(),O=function(){function i(){h(this,i)}return m(i,null,[{key:"opposite",value:function(e){return e===i.LEFT?i.RIGHT:e===i.RIGHT?i.LEFT:e}}])}();O.ON=0,O.LEFT=1,O.RIGHT=2;var Bi=function(i){function e(t){var n;return h(this,e),(n=f(this,e,[t])).name=Object.keys({EmptyStackException:e})[0],n}return E(e,i),m(e)}(V),ji=function(i){function e(t){var n;return h(this,e),(n=f(this,e,[t])).name=Object.keys({IndexOutOfBoundsException:e})[0],n}return E(e,i),m(e)}(V),yt=function(i){function e(){return h(this,e),f(this,e,arguments)}return E(e,i),m(e,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])}(We),Ca=function(i){function e(){var t;return h(this,e),(t=f(this,e)).array=[],t}return E(e,i),m(e,[{key:"add",value:function(t){return this.array.push(t),!0}},{key:"get",value:function(t){if(t<0||t>=this.size())throw new ji;return this.array[t]}},{key:"push",value:function(t){return this.array.push(t),t}},{key:"pop",value:function(){if(this.array.length===0)throw new Bi;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new Bi;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(t){return this.array.indexOf(t)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])}(yt);function K(i,e){return i.interfaces_&&i.interfaces_.indexOf(e)>-1}var Qt=function(){return m(function i(e){h(this,i),this.str=e},[{key:"append",value:function(i){this.str+=i}},{key:"setCharAt",value:function(i,e){this.str=this.str.substr(0,i)+e+this.str.substr(i+1)}},{key:"toString",value:function(){return this.str}}])}(),In=function(){function i(e){h(this,i),this.value=e}return m(i,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(e){return this.value<e?-1:this.value>e?1:0}}],[{key:"compare",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"isNan",value:function(e){return Number.isNaN(e)}},{key:"valueOf",value:function(e){return new i(e)}}])}(),ni=function(){return m(function i(){h(this,i)},null,[{key:"isWhitespace",value:function(i){return i<=32&&i>=0||i===127}},{key:"toUpperCase",value:function(i){return i.toUpperCase()}}])}(),W=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"le",value:function(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<=e._lo}},{key:"extractSignificantDigits",value:function(e,t){var n=this.abs(),r=i.magnitude(n._hi),s=i.TEN.pow(r);(n=n.divide(s)).gt(i.TEN)?(n=n.divide(i.TEN),r+=1):n.lt(i.ONE)&&(n=n.multiply(i.TEN),r-=1);for(var u=r+1,l=new Qt,g=i.MAX_PRINT_DIGITS-1,d=0;d<=g;d++){e&&d===u&&l.append(".");var x=Math.trunc(n._hi);if(x<0)break;var I=!1,R=0;x>9?(I=!0,R="9"):R="0"+x,l.append(R),n=n.subtract(i.valueOf(x)).multiply(i.TEN),I&&n.selfAdd(i.TEN);var b=!0,z=i.magnitude(n._hi);if(z<0&&Math.abs(z)>=g-d&&(b=!1),!b)break}return t[0]=r,l.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return this.add(e.negate())}if(typeof arguments[0]=="number"){var t=arguments[0];return this.add(-t)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof i){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(e){return this.le(e)?this:e}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfDivide(t,0)}}else if(arguments.length===2){var n,r,s,u,l=arguments[0],g=arguments[1],d=null,x=null,I=null,R=null;return s=this._hi/l,R=(d=(I=i.SPLIT*s)-(d=I-s))*(x=(R=i.SPLIT*l)-(x=R-l))-(u=s*l)+d*(r=l-x)+(n=s-d)*x+n*r,R=s+(I=(this._hi-u-R+this._lo-s*g)/l),this._hi=R,this._lo=s-R+I,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof i){var e,t,n,r,s=arguments[0],u=null,l=null,g=null,d=null;return e=(n=this._hi/s._hi)-(u=(g=i.SPLIT*n)-(u=g-n)),d=u*(l=(d=i.SPLIT*s._hi)-(l=d-s._hi))-(r=n*s._hi)+u*(t=s._hi-l)+e*l+e*t,new i(d=n+(g=(this._hi-r-d+this._lo-n*s._lo)/s._hi),n-d+g)}if(typeof arguments[0]=="number"){var x=arguments[0];return Y.isNaN(x)?i.createNaN():i.copy(this).selfDivide(x,0)}}},{key:"ge",value:function(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>=e._lo}},{key:"pow",value:function(e){if(e===0)return i.valueOf(1);var t=new i(this),n=i.valueOf(1),r=Math.abs(e);if(r>1)for(;r>0;)r%2==1&&n.selfMultiply(t),(r/=2)>0&&(t=t.sqr());else n=t;return e<0?n.reciprocal():n}},{key:"ceil",value:function(){if(this.isNaN())return i.NaN;var e=Math.ceil(this._hi),t=0;return e===this._hi&&(t=Math.ceil(this._lo)),new i(e,t)}},{key:"compareTo",value:function(e){var t=e;return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return this.init(e),this}if(typeof arguments[0]=="number"){var t=arguments[0];return this.init(t),this}}},{key:"max",value:function(e){return this.ge(e)?this:e}},{key:"sqrt",value:function(){if(this.isZero())return i.valueOf(0);if(this.isNegative())return i.NaN;var e=1/Math.sqrt(this._hi),t=this._hi*e,n=i.valueOf(t),r=this.subtract(n.sqr())._hi*(.5*e);return n.add(r)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if(typeof arguments[0]=="number"){var t,n,r,s,u,l=arguments[0],g=null;return g=(r=this._hi+l)-(s=r-this._hi),n=(u=(g=l-s+(this._hi-g))+this._lo)+(r-(t=r+u)),this._hi=t+n,this._lo=n+(t-this._hi),this}}else if(arguments.length===2){var d,x,I,R,b=arguments[0],z=arguments[1],X=null,re=null,ne=null;I=this._hi+b,x=this._lo+z,re=I-(ne=I-this._hi),X=x-(R=x-this._lo);var ce=(d=I+(ne=(re=b-ne+(this._hi-re))+x))+(ne=(X=z-R+(this._lo-X))+(ne+(I-d))),Re=ne+(d-ce);return this._hi=ce,this._lo=Re,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof i){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfMultiply(t,0)}}else if(arguments.length===2){var n,r,s=arguments[0],u=arguments[1],l=null,g=null,d=null,x=null;l=(d=i.SPLIT*this._hi)-this._hi,x=i.SPLIT*s,l=d-l,n=this._hi-l,g=x-s;var I=(d=this._hi*s)+(x=l*(g=x-g)-d+l*(r=s-g)+n*g+n*r+(this._hi*u+this._lo*s)),R=x+(l=d-I);return this._hi=I,this._lo=R,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return i.NaN;var e=Math.floor(this._hi),t=0;return e===this._hi&&(t=Math.floor(this._lo)),new i(e,t)}},{key:"negate",value:function(){return this.isNaN()?this:new i(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return null;throw e}}},{key:"multiply",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return e.isNaN()?i.createNaN():i.copy(this).selfMultiply(e)}if(typeof arguments[0]=="number"){var t=arguments[0];return Y.isNaN(t)?i.createNaN():i.copy(this).selfMultiply(t,0)}}},{key:"isNaN",value:function(){return Y.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var e=i.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),n=this.extractSignificantDigits(!0,t),r=t[0]+1,s=n;if(n.charAt(0)===".")s="0"+n;else if(r<0)s="0."+i.stringOfChar("0",-r)+n;else if(n.indexOf(".")===-1){var u=r-n.length;s=n+i.stringOfChar("0",u)+".0"}return this.isNegative()?"-"+s:s}},{key:"reciprocal",value:function(){var e,t,n,r,s=null,u=null,l=null,g=null;e=(n=1/this._hi)-(s=(l=i.SPLIT*n)-(s=l-n)),u=(g=i.SPLIT*this._hi)-this._hi;var d=n+(l=(1-(r=n*this._hi)-(g=s*(u=g-u)-r+s*(t=this._hi-u)+e*u+e*t)-n*this._lo)/this._hi);return new i(d,n-d+l)}},{key:"toSciNotation",value:function(){if(this.isZero())return i.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),n=this.extractSignificantDigits(!1,t),r=i.SCI_NOT_EXPONENT_CHAR+t[0];if(n.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+n);var s="";n.length>1&&(s=n.substring(1));var u=n.charAt(0)+"."+s;return this.isNegative()?"-"+u+r:u+r}},{key:"abs",value:function(){return this.isNaN()?i.NaN:this.isNegative()?this.negate():new i(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<e._lo}},{key:"add",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return i.copy(this).selfAdd(e)}if(typeof arguments[0]=="number"){var t=arguments[0];return i.copy(this).selfAdd(t)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof i){var t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._hi=n,this._lo=r}}},{key:"gt",value:function(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>e._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?i.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[B,j,$]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof i){var t=arguments[0];this.init(t)}else if(typeof arguments[0]=="string"){var n=arguments[0];i.constructor_.call(this,i.parse(n))}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.init(r,s)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1],n=arguments[2],r=arguments[3];return i.determinant(i.valueOf(e),i.valueOf(t),i.valueOf(n),i.valueOf(r))}if(arguments[3]instanceof i&&arguments[2]instanceof i&&arguments[0]instanceof i&&arguments[1]instanceof i){var s=arguments[1],u=arguments[2],l=arguments[3];return arguments[0].multiply(l).selfSubtract(s.multiply(u))}}},{key:"sqr",value:function(e){return i.valueOf(e).selfMultiply(e)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var e=arguments[0];return i.parse(e)}if(typeof arguments[0]=="number")return new i(arguments[0])}},{key:"sqrt",value:function(e){return i.valueOf(e).sqrt()}},{key:"parse",value:function(e){for(var t=0,n=e.length;ni.isWhitespace(e.charAt(t));)t++;var r=!1;if(t<n){var s=e.charAt(t);s!=="-"&&s!=="+"||(t++,s==="-"&&(r=!0))}for(var u=new i,l=0,g=0,d=0,x=!1;!(t>=n);){var I=e.charAt(t);if(t++,ni.isDigit(I)){var R=I-"0";u.selfMultiply(i.TEN),u.selfAdd(R),l++}else{if(I!=="."){if(I==="e"||I==="E"){var b=e.substring(t);try{d=In.parseInt(b)}catch(ce){throw ce instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+b+" in string "+e):ce}break}throw new NumberFormatException("Unexpected character '"+I+"' at position "+t+" in string "+e)}g=l,x=!0}}var z=u;x||(g=l);var X=l-g-d;if(X===0)z=u;else if(X>0){var re=i.TEN.pow(X);z=u.divide(re)}else if(X<0){var ne=i.TEN.pow(-X);z=u.multiply(ne)}return r?z.negate():z}},{key:"createNaN",value:function(){return new i(Y.NaN,Y.NaN)}},{key:"copy",value:function(e){return new i(e)}},{key:"magnitude",value:function(e){var t=Math.abs(e),n=Math.log(t)/Math.log(10),r=Math.trunc(Math.floor(n));return 10*Math.pow(10,r)<=t&&(r+=1),r}},{key:"stringOfChar",value:function(e,t){for(var n=new Qt,r=0;r<t;r++)n.append(e);return n.toString()}}])}();W.PI=new W(3.141592653589793,12246467991473532e-32),W.TWO_PI=new W(6.283185307179586,24492935982947064e-32),W.PI_2=new W(1.5707963267948966,6123233995736766e-32),W.E=new W(2.718281828459045,14456468917292502e-32),W.NaN=new W(Y.NaN,Y.NaN),W.EPS=123259516440783e-46,W.SPLIT=134217729,W.MAX_PRINT_DIGITS=32,W.TEN=W.valueOf(10),W.ONE=W.valueOf(1),W.SCI_NOT_EXPONENT_CHAR="E",W.SCI_NOT_ZERO="0.0E0";var ii=function(){function i(){h(this,i)}return m(i,null,[{key:"orientationIndex",value:function(e,t,n){var r=i.orientationIndexFilter(e,t,n);if(r<=1)return r;var s=W.valueOf(t.x).selfAdd(-e.x),u=W.valueOf(t.y).selfAdd(-e.y),l=W.valueOf(n.x).selfAdd(-t.x),g=W.valueOf(n.y).selfAdd(-t.y);return s.selfMultiply(g).selfSubtract(u.selfMultiply(l)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof W&&arguments[2]instanceof W&&arguments[0]instanceof W&&arguments[1]instanceof W){var e=arguments[1],t=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(e.multiply(t)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var r=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],g=W.valueOf(r),d=W.valueOf(s),x=W.valueOf(u),I=W.valueOf(l);return g.multiply(I).selfSubtract(d.multiply(x)).signum()}}},{key:"intersection",value:function(e,t,n,r){var s=new W(e.y).selfSubtract(t.y),u=new W(t.x).selfSubtract(e.x),l=new W(e.x).selfMultiply(t.y).selfSubtract(new W(t.x).selfMultiply(e.y)),g=new W(n.y).selfSubtract(r.y),d=new W(r.x).selfSubtract(n.x),x=new W(n.x).selfMultiply(r.y).selfSubtract(new W(r.x).selfMultiply(n.y)),I=u.multiply(x).selfSubtract(d.multiply(l)),R=g.multiply(l).selfSubtract(s.multiply(x)),b=s.multiply(d).selfSubtract(g.multiply(u)),z=I.selfDivide(b).doubleValue(),X=R.selfDivide(b).doubleValue();return Y.isNaN(z)||Y.isInfinite(z)||Y.isNaN(X)||Y.isInfinite(X)?null:new S(z,X)}},{key:"orientationIndexFilter",value:function(e,t,n){var r=null,s=(e.x-n.x)*(t.y-n.y),u=(e.y-n.y)*(t.x-n.x),l=s-u;if(s>0){if(u<=0)return i.signum(l);r=s+u}else{if(!(s<0)||u>=0)return i.signum(l);r=-s-u}var g=i.DP_SAFE_EPSILON*r;return l>=g||-l>=g?i.signum(l):2}},{key:"signum",value:function(e){return e>0?1:e<0?-1:0}}])}();ii.DP_SAFE_EPSILON=1e-15;var ie=function(){return m(function i(){h(this,i)},[{key:"getM",value:function(i){if(this.hasM()){var e=this.getDimension()-this.getMeasures();return this.getOrdinate(i,e)}return Y.NaN}},{key:"setOrdinate",value:function(i,e,t){}},{key:"getZ",value:function(i){return this.hasZ()?this.getOrdinate(i,2):Y.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(i,e){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(i){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(i){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(i){}},{key:"copy",value:function(){}},{key:"getY",value:function(i){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[$]}}])}();ie.X=0,ie.Y=1,ie.Z=2,ie.M=3;var J=function(){function i(){h(this,i)}return m(i,null,[{key:"index",value:function(e,t,n){return ii.orientationIndex(e,t,n)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var e=arguments[0],t=e.length-1;if(t<3)throw new F("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=e[0],r=0,s=1;s<=t;s++){var u=e[s];u.y>n.y&&(n=u,r=s)}var l=r;do(l-=1)<0&&(l=t);while(e[l].equals2D(n)&&l!==r);var g=r;do g=(g+1)%t;while(e[g].equals2D(n)&&g!==r);var d=e[l],x=e[g];if(d.equals2D(n)||x.equals2D(n)||d.equals2D(x))return!1;var I=i.index(d,n,x);return I===0?d.x>x.x:I>0}if(K(arguments[0],ie)){var R=arguments[0],b=R.size()-1;if(b<3)throw new F("Ring has fewer than 4 points, so orientation cannot be determined");for(var z=R.getCoordinate(0),X=0,re=1;re<=b;re++){var ne=R.getCoordinate(re);ne.y>z.y&&(z=ne,X=re)}var ce=null,Re=X;do(Re-=1)<0&&(Re=b),ce=R.getCoordinate(Re);while(ce.equals2D(z)&&Re!==X);var be=null,It=X;do It=(It+1)%b,be=R.getCoordinate(It);while(be.equals2D(z)&&It!==X);if(ce.equals2D(z)||be.equals2D(z)||ce.equals2D(be))return!1;var un=i.index(ce,z,be);return un===0?ce.x>be.x:un>0}}}])}();J.CLOCKWISE=-1,J.RIGHT=J.CLOCKWISE,J.COUNTERCLOCKWISE=1,J.LEFT=J.COUNTERCLOCKWISE,J.COLLINEAR=0,J.STRAIGHT=J.COLLINEAR;var Ta=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(i,e){var t=this.getRightmostSideOfSegment(i,e);return t<0&&(t=this.getRightmostSideOfSegment(i,e-1)),t<0&&(this._minCoord=null,this.checkForRightmostCoordinate(i)),t}},{key:"findRightmostEdgeAtVertex",value:function(){var i=this._minDe.getEdge().getCoordinates();ee.isTrue(this._minIndex>0&&this._minIndex<i.length,"rightmost point expected to be interior vertex of edge");var e=i[this._minIndex-1],t=i[this._minIndex+1],n=J.index(this._minCoord,t,e),r=!1;(e.y<this._minCoord.y&&t.y<this._minCoord.y&&n===J.COUNTERCLOCKWISE||e.y>this._minCoord.y&&t.y>this._minCoord.y&&n===J.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(i,e){var t=i.getEdge().getCoordinates();if(e<0||e+1>=t.length||t[e].y===t[e+1].y)return-1;var n=O.LEFT;return t[e].y<t[e+1].y&&(n=O.RIGHT),n}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(i){for(var e=i.getEdge().getCoordinates(),t=0;t<e.length-1;t++)(this._minCoord===null||e[t].x>this._minCoord.x)&&(this._minDe=i,this._minIndex=t,this._minCoord=e[t])}},{key:"findRightmostEdgeAtNode",value:function(){var i=this._minDe.getNode().getEdges();this._minDe=i.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(i){for(var e=i.iterator();e.hasNext();){var t=e.next();t.isForward()&&this.checkForRightmostCoordinate(t)}ee.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===O.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])}(),rt=function(i){function e(t,n){var r;return h(this,e),(r=f(this,e,[n?t+" [ "+n+" ]":t])).pt=n?new S(n):void 0,r.name=Object.keys({TopologyException:e})[0],r}return E(e,i),m(e,[{key:"getCoordinate",value:function(){return this.pt}}])}(Ce),La=function(){return m(function i(){h(this,i),this.array=[]},[{key:"addLast",value:function(i){this.array.push(i)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])}(),Z=function(i){function e(t){var n;return h(this,e),(n=f(this,e)).array=[],t instanceof We&&n.addAll(t),n}return E(e,i),m(e,[{key:"interfaces_",get:function(){return[yt,We]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(t){return arguments.length===1?this.array.push(t):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(t){var n,r=L(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;this.array.push(s)}}catch(u){r.e(u)}finally{r.f()}}},{key:"set",value:function(t,n){var r=this.array[t];return this.array[t]=n,r}},{key:"iterator",value:function(){return new Ra(this)}},{key:"get",value:function(t){if(t<0||t>=this.size())throw new ji;return this.array[t]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(t){t?this.array.sort(function(n,r){return t.compare(n,r)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(t){for(var n=0,r=this.array.length;n<r;n++)if(this.array[n]===t)return!!this.array.splice(n,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])}(yt),Ra=function(){return m(function i(e){h(this,i),this.arrayList=e,this.position=0},[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new Nn;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(i){return this.arrayList.set(this.position-1,i)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])}(),Oa=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"clearVisitedEdges",value:function(){for(var i=this._dirEdgeList.iterator();i.hasNext();)i.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(i){for(var e=null,t=i.getEdges().iterator();t.hasNext();){var n=t.next();if(n.isVisited()||n.getSym().isVisited()){e=n;break}}if(e===null)throw new rt("unable to find edge to compute depths at "+i.getCoordinate());i.getEdges().computeDepths(e);for(var r=i.getEdges().iterator();r.hasNext();){var s=r.next();s.setVisited(!0),this.copySymDepths(s)}}},{key:"computeDepth",value:function(i){this.clearVisitedEdges();var e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(O.RIGHT,i),this.copySymDepths(e),this.computeDepths(e)}},{key:"create",value:function(i){this.addReachable(i),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var i=this._dirEdgeList.iterator();i.hasNext();){var e=i.next();e.getDepth(O.RIGHT)>=1&&e.getDepth(O.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}},{key:"computeDepths",value:function(i){var e=new ti,t=new La,n=i.getNode();for(t.addLast(n),e.add(n),i.setVisited(!0);!t.isEmpty();){var r=t.removeFirst();e.add(r),this.computeNodeDepth(r);for(var s=r.getEdges().iterator();s.hasNext();){var u=s.next().getSym();if(!u.isVisited()){var l=u.getNode();e.contains(l)||(t.addLast(l),e.add(l))}}}}},{key:"compareTo",value:function(i){var e=i;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var i=new ge,e=this._dirEdgeList.iterator();e.hasNext();)for(var t=e.next().getEdge().getCoordinates(),n=0;n<t.length-1;n++)i.expandToInclude(t[n]);this._env=i}return this._env}},{key:"addReachable",value:function(i){var e=new Ca;for(e.add(i);!e.empty();){var t=e.pop();this.add(t,e)}}},{key:"copySymDepths",value:function(i){var e=i.getSym();e.setDepth(O.LEFT,i.getDepth(O.RIGHT)),e.setDepth(O.RIGHT,i.getDepth(O.LEFT))}},{key:"add",value:function(i,e){i.setVisited(!0),this._nodes.add(i);for(var t=i.getEdges().iterator();t.hasNext();){var n=t.next();this._dirEdgeList.add(n);var r=n.getSym().getNode();r.isVisited()||e.push(r)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new Z,this._nodes=new Z,this._rightMostCoord=null,this._env=null,this._finder=new Ta}}])}(),ri=function(){return m(function i(){h(this,i)},null,[{key:"intersection",value:function(i,e,t,n){var r=i.x<e.x?i.x:e.x,s=i.y<e.y?i.y:e.y,u=i.x>e.x?i.x:e.x,l=i.y>e.y?i.y:e.y,g=t.x<n.x?t.x:n.x,d=t.y<n.y?t.y:n.y,x=t.x>n.x?t.x:n.x,I=t.y>n.y?t.y:n.y,R=((r>g?r:g)+(u<x?u:x))/2,b=((s>d?s:d)+(l<I?l:I))/2,z=i.x-R,X=i.y-b,re=e.x-R,ne=e.y-b,ce=t.x-R,Re=t.y-b,be=n.x-R,It=n.y-b,un=X-ne,Lr=re-z,Rr=z*ne-re*X,Or=Re-It,Mr=be-ce,br=ce*It-be*Re,Pr=un*Mr-Or*Lr,ki=(Lr*br-Mr*Rr)/Pr,xi=(Or*Rr-un*br)/Pr;return Y.isNaN(ki)||Y.isInfinite(ki)||Y.isNaN(xi)||Y.isInfinite(xi)?null:new S(ki+R,xi+b)}}])}(),Ye=function(){return m(function i(){h(this,i)},null,[{key:"arraycopy",value:function(i,e,t,n,r){for(var s=0,u=e;u<e+r;u++)t[n+s]=i[u],s++}},{key:"getProperty",value:function(i){return{"line.separator":`
`}[i]}}])}(),Jt=function(){function i(){h(this,i)}return m(i,null,[{key:"log10",value:function(e){var t=Math.log(e);return Y.isInfinite(t)||Y.isNaN(t)?t:t/i.LOG_10}},{key:"min",value:function(e,t,n,r){var s=e;return t<s&&(s=t),n<s&&(s=n),r<s&&(s=r),s}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1],n=arguments[2];return e<t?t:e>n?n:e}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],s=arguments[1],u=arguments[2];return r<s?s:r>u?u:r}}},{key:"wrap",value:function(e,t){return e<0?t- -e%t:e%t}},{key:"max",value:function(){if(arguments.length===3){var e=arguments[1],t=arguments[2],n=arguments[0];return e>n&&(n=e),t>n&&(n=t),n}if(arguments.length===4){var r=arguments[1],s=arguments[2],u=arguments[3],l=arguments[0];return r>l&&(l=r),s>l&&(l=s),u>l&&(l=u),l}}},{key:"average",value:function(e,t){return(e+t)/2}}])}();Jt.LOG_10=Math.log(10);var Qe=function(){function i(){h(this,i)}return m(i,null,[{key:"segmentToSegment",value:function(e,t,n,r){if(e.equals(t))return i.pointToSegment(e,n,r);if(n.equals(r))return i.pointToSegment(r,e,t);var s=!1;if(ge.intersects(e,t,n,r)){var u=(t.x-e.x)*(r.y-n.y)-(t.y-e.y)*(r.x-n.x);if(u===0)s=!0;else{var l=(e.y-n.y)*(r.x-n.x)-(e.x-n.x)*(r.y-n.y),g=((e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y))/u,d=l/u;(d<0||d>1||g<0||g>1)&&(s=!0)}}else s=!0;return s?Jt.min(i.pointToSegment(e,n,r),i.pointToSegment(t,n,r),i.pointToSegment(n,e,t),i.pointToSegment(r,e,t)):0}},{key:"pointToSegment",value:function(e,t,n){if(t.x===n.x&&t.y===n.y)return e.distance(t);var r=(n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y),s=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/r;if(s<=0)return e.distance(t);if(s>=1)return e.distance(n);var u=((t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y))/r;return Math.abs(u)*Math.sqrt(r)}},{key:"pointToLinePerpendicular",value:function(e,t,n){var r=(n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y),s=((t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y))/r;return Math.abs(s)*Math.sqrt(r)}},{key:"pointToSegmentString",value:function(e,t){if(t.length===0)throw new F("Line array must contain at least one vertex");for(var n=e.distance(t[0]),r=0;r<t.length-1;r++){var s=i.pointToSegment(e,t[r],t[r+1]);s<n&&(n=s)}return n}}])}(),Ui=function(){return m(function i(){h(this,i)},[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||K(arguments[0],ie);else if(arguments.length!==2){if(arguments.length===3){var i=arguments[0],e=arguments[1];return this.create(i,e)}}}}])}(),Sn=function(){return m(function i(){h(this,i)},[{key:"filter",value:function(i){}}])}(),Ma=function(){return m(function i(){h(this,i)},null,[{key:"ofLine",value:function(i){var e=i.size();if(e<=1)return 0;var t=0,n=new S;i.getCoordinate(0,n);for(var r=n.x,s=n.y,u=1;u<e;u++){i.getCoordinate(u,n);var l=n.x,g=n.y,d=l-r,x=g-s;t+=Math.sqrt(d*d+x*x),r=l,s=g}return t}}])}(),Xi=m(function i(){h(this,i)}),pt=function(){function i(){h(this,i)}return m(i,null,[{key:"copyCoord",value:function(e,t,n,r){for(var s=Math.min(e.getDimension(),n.getDimension()),u=0;u<s;u++)n.setOrdinate(r,u,e.getOrdinate(t,u))}},{key:"isRing",value:function(e){var t=e.size();return t===0||!(t<=3)&&e.getOrdinate(0,ie.X)===e.getOrdinate(t-1,ie.X)&&e.getOrdinate(0,ie.Y)===e.getOrdinate(t-1,ie.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(K(arguments[0],ie)&&Number.isInteger(arguments[1])){var e=arguments[0],t=arguments[1];i.scroll(e,t,i.isRing(e))}else if(K(arguments[0],ie)&&arguments[1]instanceof S){var n=arguments[0],r=arguments[1],s=i.indexOf(r,n);if(s<=0)return null;i.scroll(n,s)}}else if(arguments.length===3){var u=arguments[0],l=arguments[1],g=arguments[2];if(l<=0)return null;for(var d=u.copy(),x=g?u.size()-1:u.size(),I=0;I<x;I++)for(var R=0;R<u.getDimension();R++)u.setOrdinate(I,R,d.getOrdinate((l+I)%x,R));if(g)for(var b=0;b<u.getDimension();b++)u.setOrdinate(x,b,u.getOrdinate(0,b))}}},{key:"isEqual",value:function(e,t){var n=e.size();if(n!==t.size())return!1;for(var r=Math.min(e.getDimension(),t.getDimension()),s=0;s<n;s++)for(var u=0;u<r;u++){var l=e.getOrdinate(s,u),g=t.getOrdinate(s,u);if(e.getOrdinate(s,u)!==t.getOrdinate(s,u)&&(!Y.isNaN(l)||!Y.isNaN(g)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var e=arguments[0];return i.minCoordinateIndex(e,0,e.size()-1)}if(arguments.length===3){for(var t=arguments[0],n=arguments[2],r=-1,s=null,u=arguments[1];u<=n;u++){var l=t.getCoordinate(u);(s===null||s.compareTo(l)>0)&&(s=l,r=u)}return r}}},{key:"extend",value:function(e,t,n){var r=e.create(n,t.getDimension()),s=t.size();if(i.copy(t,0,r,0,s),s>0)for(var u=s;u<n;u++)i.copy(t,s-1,r,u,1);return r}},{key:"reverse",value:function(e){for(var t=e.size()-1,n=Math.trunc(t/2),r=0;r<=n;r++)i.swap(e,r,t-r)}},{key:"swap",value:function(e,t,n){if(t===n)return null;for(var r=0;r<e.getDimension();r++){var s=e.getOrdinate(t,r);e.setOrdinate(t,r,e.getOrdinate(n,r)),e.setOrdinate(n,r,s)}}},{key:"copy",value:function(e,t,n,r,s){for(var u=0;u<s;u++)i.copyCoord(e,t+u,n,r+u)}},{key:"ensureValidRing",value:function(e,t){var n=t.size();return n===0?t:n<=3?i.createClosedRing(e,t,4):t.getOrdinate(0,ie.X)===t.getOrdinate(n-1,ie.X)&&t.getOrdinate(0,ie.Y)===t.getOrdinate(n-1,ie.Y)?t:i.createClosedRing(e,t,n+1)}},{key:"indexOf",value:function(e,t){for(var n=0;n<t.size();n++)if(e.x===t.getOrdinate(n,ie.X)&&e.y===t.getOrdinate(n,ie.Y))return n;return-1}},{key:"createClosedRing",value:function(e,t,n){var r=e.create(n,t.getDimension()),s=t.size();i.copy(t,0,r,0,s);for(var u=s;u<n;u++)i.copy(t,0,r,u,1);return r}},{key:"minCoordinate",value:function(e){for(var t=null,n=0;n<e.size();n++){var r=e.getCoordinate(n);(t===null||t.compareTo(r)>0)&&(t=r)}return t}}])}(),M=function(){function i(){h(this,i)}return m(i,null,[{key:"toDimensionSymbol",value:function(e){switch(e){case i.FALSE:return i.SYM_FALSE;case i.TRUE:return i.SYM_TRUE;case i.DONTCARE:return i.SYM_DONTCARE;case i.P:return i.SYM_P;case i.L:return i.SYM_L;case i.A:return i.SYM_A}throw new F("Unknown dimension value: "+e)}},{key:"toDimensionValue",value:function(e){switch(ni.toUpperCase(e)){case i.SYM_FALSE:return i.FALSE;case i.SYM_TRUE:return i.TRUE;case i.SYM_DONTCARE:return i.DONTCARE;case i.SYM_P:return i.P;case i.SYM_L:return i.L;case i.SYM_A:return i.A}throw new F("Unknown dimension symbol: "+e)}}])}();M.P=0,M.L=1,M.A=2,M.FALSE=-1,M.TRUE=-2,M.DONTCARE=-3,M.SYM_FALSE="F",M.SYM_TRUE="T",M.SYM_DONTCARE="*",M.SYM_P="0",M.SYM_L="1",M.SYM_A="2";var wn=function(){return m(function i(){h(this,i)},[{key:"filter",value:function(i){}}])}(),Cn=function(){return m(function i(){h(this,i)},[{key:"filter",value:function(i,e){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])}(),Kt=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new ge:this._points.expandEnvelope(new ge)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new e(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof U){var t=arguments[0],n=arguments[1];if(!this.isEquivalentClass(t))return!1;var r=t;if(this._points.size()!==r._points.size())return!1;for(var s=0;s<this._points.size();s++)if(!this.equal(this._points.getCoordinate(s),r._points.getCoordinate(s),n))return!1;return!0}return w(e,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var n=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(n))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(n))>0){var r=this._points.copy();pt.reverse(r),this._points=r}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?M.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var t=this._points.copy();return pt.reverse(t),this.getFactory().createLineString(t)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return U.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return Ma.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var t=arguments[0],n=0,r=0;n<this._points.size()&&r<t._points.size();){var s=this._points.getCoordinate(n).compareTo(t._points.getCoordinate(r));if(s!==0)return s;n++,r++}return n<this._points.size()?1:r<t._points.size()?-1:0}if(arguments.length===2){var u=arguments[0];return arguments[1].compare(this._points,u._points)}}},{key:"apply",value:function(){if(K(arguments[0],Sn))for(var t=arguments[0],n=0;n<this._points.size();n++)t.filter(this._points.getCoordinate(n));else if(K(arguments[0],Cn)){var r=arguments[0];if(this._points.size()===0)return null;for(var s=0;s<this._points.size()&&(r.filter(this._points,s),!r.isDone());s++);r.isGeometryChanged()&&this.geometryChanged()}else K(arguments[0],wn)?arguments[0].filter(this):K(arguments[0],q)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new ht}},{key:"isEquivalentClass",value:function(t){return t instanceof e}},{key:"getCoordinateN",value:function(t){return this._points.getCoordinate(t)}},{key:"getGeometryType",value:function(){return U.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(t){if(t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),t.size()===1)throw new F("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}},{key:"isCoordinate",value:function(t){for(var n=0;n<this._points.size();n++)if(this._points.getCoordinate(n).equals(t))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}},{key:"interfaces_",get:function(){return[Xi]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var t=arguments[0],n=arguments[1];U.constructor_.call(this,n),this.init(t)}}}}])}(U),Vi=m(function i(){h(this,i)}),si=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new ge;var t=new ge;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new e(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof U){var t=arguments[0],n=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),n))}return w(e,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return M.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return U.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(arguments.length===2){var n=arguments[0];return arguments[1].compare(this._coordinates,n._coordinates)}}},{key:"apply",value:function(){if(K(arguments[0],Sn)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(K(arguments[0],Cn)){var n=arguments[0];if(this.isEmpty())return null;n.filter(this._coordinates,0),n.isGeometryChanged()&&this.geometryChanged()}else K(arguments[0],wn)?arguments[0].filter(this):K(arguments[0],q)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return U.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(t){t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),ee.isTrue(t.size()<=1),this._coordinates=t}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[Vi]}}],[{key:"constructor_",value:function(){this._coordinates=null;var t=arguments[0],n=arguments[1];U.constructor_.call(this,n),this.init(t)}}])}(U),Hi=function(){function i(){h(this,i)}return m(i,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];return Math.abs(i.ofRingSigned(e))}if(K(arguments[0],ie)){var t=arguments[0];return Math.abs(i.ofRingSigned(t))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var t=0,n=e[0].x,r=1;r<e.length-1;r++){var s=e[r].x-n,u=e[r+1].y;t+=s*(e[r-1].y-u)}return t/2}if(K(arguments[0],ie)){var l=arguments[0],g=l.size();if(g<3)return 0;var d=new S,x=new S,I=new S;l.getCoordinate(0,x),l.getCoordinate(1,I);var R=x.x;I.x-=R;for(var b=0,z=1;z<g-1;z++)d.y=x.y,x.x=I.x,x.y=I.y,l.getCoordinate(z+1,I),I.x-=R,b+=x.x*(d.y-I.y);return b/2}}}])}(),_t=function(){return m(function i(){h(this,i)},null,[{key:"sort",value:function(){var i=arguments,e=arguments[0];if(arguments.length===1)e.sort(function(R,b){return R.compareTo(b)});else if(arguments.length===2)e.sort(function(R,b){return i[1].compare(R,b)});else if(arguments.length===3){var t=e.slice(arguments[1],arguments[2]);t.sort();var n=e.slice(0,arguments[1]).concat(t,e.slice(arguments[2],e.length));e.splice(0,e.length);var r,s=L(n);try{for(s.s();!(r=s.n()).done;){var u=r.value;e.push(u)}}catch(R){s.e(R)}finally{s.f()}}else if(arguments.length===4){var l=e.slice(arguments[1],arguments[2]);l.sort(function(R,b){return i[3].compare(R,b)});var g=e.slice(0,arguments[1]).concat(l,e.slice(arguments[2],e.length));e.splice(0,e.length);var d,x=L(g);try{for(x.s();!(d=x.n()).done;){var I=d.value;e.push(I)}}catch(R){x.e(R)}finally{x.f()}}}},{key:"asList",value:function(i){var e,t=new Z,n=L(i);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.add(r)}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"copyOf",value:function(i,e){return i.slice(0,e)}}])}(),Zi=m(function i(){h(this,i)}),Tn=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),n=-1,r=this._shell.getCoordinates(),s=0;s<r.length;s++)t[++n]=r[s];for(var u=0;u<this._holes.length;u++)for(var l=this._holes[u].getCoordinates(),g=0;g<l.length;g++)t[++n]=l[g];return t}},{key:"getArea",value:function(){var t=0;t+=Hi.ofRing(this._shell.getCoordinateSequence());for(var n=0;n<this._holes.length;n++)t-=Hi.ofRing(this._holes[n].getCoordinateSequence());return t}},{key:"copyInternal",value:function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),r=0;r<this._holes.length;r++)n[r]=this._holes[r].copy();return new e(t,n,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var t=this._shell.getCoordinateSequence(),n=this.getEnvelopeInternal(),r=0;r<5;r++){var s=t.getX(r);if(s!==n.getMinX()&&s!==n.getMaxX())return!1;var u=t.getY(r);if(u!==n.getMinY()&&u!==n.getMaxY())return!1}for(var l=t.getX(0),g=t.getY(0),d=1;d<=4;d++){var x=t.getX(d),I=t.getY(d);if(x!==l==(I!==g))return!1;l=x,g=I}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof U){var t=arguments[0],n=arguments[1];if(!this.isEquivalentClass(t))return!1;var r=t,s=this._shell,u=r._shell;if(!s.equalsExact(u,n)||this._holes.length!==r._holes.length)return!1;for(var l=0;l<this._holes.length;l++)if(!this._holes[l].equalsExact(r._holes[l],n))return!1;return!0}return w(e,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var t=0;t<this._holes.length;t++)this._holes[t]=this.normalized(this._holes[t],!1);_t.sort(this._holes)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(n.isEmpty())return null;var s=n.getCoordinateSequence(),u=pt.minCoordinateIndex(s,0,s.size()-2);pt.scroll(s,u,!0),J.isCCW(s)===r&&pt.reverse(s)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var t=this.getExteriorRing().reverse(),n=new Array(this.getNumInteriorRing()).fill(null),r=0;r<n.length;r++)n[r]=this.getInteriorRingN(r).reverse();return this.getFactory().createPolygon(t,n)}},{key:"getTypeCode",value:function(){return U.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var t=0;t+=this._shell.getLength();for(var n=0;n<this._holes.length;n++)t+=this._holes[n].getLength();return t}},{key:"getNumPoints",value:function(){for(var t=this._shell.getNumPoints(),n=0;n<this._holes.length;n++)t+=this._holes[n].getNumPoints();return t}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(t,n){var r=t.copy();return this.normalize(r,n),r}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var t=arguments[0],n=this._shell,r=t._shell;return n.compareToSameClass(r)}if(arguments.length===2){var s=arguments[1],u=arguments[0],l=this._shell,g=u._shell,d=l.compareToSameClass(g,s);if(d!==0)return d;for(var x=this.getNumInteriorRing(),I=u.getNumInteriorRing(),R=0;R<x&&R<I;){var b=this.getInteriorRingN(R),z=u.getInteriorRingN(R),X=b.compareToSameClass(z,s);if(X!==0)return X;R++}return R<x?1:R<I?-1:0}}},{key:"apply",value:function(){if(K(arguments[0],Sn)){var t=arguments[0];this._shell.apply(t);for(var n=0;n<this._holes.length;n++)this._holes[n].apply(t)}else if(K(arguments[0],Cn)){var r=arguments[0];if(this._shell.apply(r),!r.isDone())for(var s=0;s<this._holes.length&&(this._holes[s].apply(r),!r.isDone());s++);r.isGeometryChanged()&&this.geometryChanged()}else if(K(arguments[0],wn))arguments[0].filter(this);else if(K(arguments[0],q)){var u=arguments[0];u.filter(this),this._shell.apply(u);for(var l=0;l<this._holes.length;l++)this._holes[l].apply(u)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var n=0;n<this._holes.length;n++)t[n+1]=this._holes[n];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}},{key:"getGeometryType",value:function(){return U.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(t){return this._holes[t]}},{key:"interfaces_",get:function(){return[Zi]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var t=arguments[0],n=arguments[1],r=arguments[2];if(U.constructor_.call(this,r),t===null&&(t=this.getFactory().createLinearRing()),n===null&&(n=[]),U.hasNullElements(n))throw new F("holes must not contain null elements");if(t.isEmpty()&&U.hasNonEmptyElements(n))throw new F("shell is empty but holes are not");this._shell=t,this._holes=n}}])}(U),ba=function(i){function e(){return h(this,e),f(this,e,arguments)}return E(e,i),m(e)}(qi),$i=function(i){function e(t){var n;return h(this,e),(n=f(this,e)).array=[],t instanceof We&&n.addAll(t),n}return E(e,i),m(e,[{key:"contains",value:function(t){var n,r=L(this.array);try{for(r.s();!(n=r.n()).done;)if(n.value.compareTo(t)===0)return!0}catch(s){r.e(s)}finally{r.f()}return!1}},{key:"add",value:function(t){if(this.contains(t))return!1;for(var n=0,r=this.array.length;n<r;n++)if(this.array[n].compareTo(t)===1)return!!this.array.splice(n,0,t);return this.array.push(t),!0}},{key:"addAll",value:function(t){var n,r=L(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;this.add(s)}}catch(u){r.e(u)}finally{r.f()}return!0}},{key:"remove",value:function(){throw new ht}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Pa(this.array)}}])}(ba),Pa=function(){return m(function i(e){h(this,i),this.array=e,this.position=0},[{key:"next",value:function(){if(this.position===this.array.length)throw new Nn;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new ht}}])}(),Fe=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"computeEnvelopeInternal",value:function(){for(var t=new ge,n=0;n<this._geometries.length;n++)t.expandToInclude(this._geometries[n].getEnvelopeInternal());return t}},{key:"getGeometryN",value:function(t){return this._geometries[t]}},{key:"getCoordinates",value:function(){for(var t=new Array(this.getNumPoints()).fill(null),n=-1,r=0;r<this._geometries.length;r++)for(var s=this._geometries[r].getCoordinates(),u=0;u<s.length;u++)t[++n]=s[u];return t}},{key:"getArea",value:function(){for(var t=0,n=0;n<this._geometries.length;n++)t+=this._geometries[n].getArea();return t}},{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof U){var t=arguments[0],n=arguments[1];if(!this.isEquivalentClass(t))return!1;var r=t;if(this._geometries.length!==r._geometries.length)return!1;for(var s=0;s<this._geometries.length;s++)if(!this._geometries[s].equalsExact(r._geometries[s],n))return!1;return!0}return w(e,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();_t.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var t=M.FALSE,n=0;n<this._geometries.length;n++)t=Math.max(t,this._geometries[n].getBoundaryDimension());return t}},{key:"reverseInternal",value:function(){for(var t=this._geometries.length,n=new Z(t),r=0;r<t;r++)n.add(this._geometries[r].reverse());return this.getFactory().buildGeometry(n)}},{key:"getTypeCode",value:function(){return U.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var t=M.FALSE,n=0;n<this._geometries.length;n++)t=Math.max(t,this._geometries[n].getDimension());return t}},{key:"getLength",value:function(){for(var t=0,n=0;n<this._geometries.length;n++)t+=this._geometries[n].getLength();return t}},{key:"getNumPoints",value:function(){for(var t=0,n=0;n<this._geometries.length;n++)t+=this._geometries[n].getNumPoints();return t}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var t=arguments[0],n=new $i(_t.asList(this._geometries)),r=new $i(_t.asList(t._geometries));return this.compare(n,r)}if(arguments.length===2){for(var s=arguments[1],u=arguments[0],l=this.getNumGeometries(),g=u.getNumGeometries(),d=0;d<l&&d<g;){var x=this.getGeometryN(d),I=u.getGeometryN(d),R=x.compareToSameClass(I,s);if(R!==0)return R;d++}return d<l?1:d<g?-1:0}}},{key:"apply",value:function(){if(K(arguments[0],Sn))for(var t=arguments[0],n=0;n<this._geometries.length;n++)this._geometries[n].apply(t);else if(K(arguments[0],Cn)){var r=arguments[0];if(this._geometries.length===0)return null;for(var s=0;s<this._geometries.length&&(this._geometries[s].apply(r),!r.isDone());s++);r.isGeometryChanged()&&this.geometryChanged()}else if(K(arguments[0],wn)){var u=arguments[0];u.filter(this);for(var l=0;l<this._geometries.length;l++)this._geometries[l].apply(u)}else if(K(arguments[0],q)){var g=arguments[0];g.filter(this);for(var d=0;d<this._geometries.length;d++)this._geometries[d].apply(g)}}},{key:"getBoundary",value:function(){return U.checkNotGeometryCollection(this),ee.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return U.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var t=arguments[0],n=arguments[1];if(U.constructor_.call(this,n),t===null&&(t=[]),U.hasNullElements(t))throw new F("geometries must not contain null elements");this._geometries=t}}}}])}(U),ai=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof U){var t=arguments[0],n=arguments[1];return!!this.isEquivalentClass(t)&&w(e,"equalsExact",this,1).call(this,t,n)}return w(e,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var t=arguments[0];return this._geometries[t].getCoordinate()}return w(e,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return M.FALSE}},{key:"getTypeCode",value:function(){return U.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return U.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[Vi]}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Fe.constructor_.call(this,t,n)}}])}(Fe),en=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"copyInternal",value:function(){return new e(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return M.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||w(e,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var t=this._points.copy();return pt.reverse(t),this.getFactory().createLinearRing(t)}},{key:"getTypeCode",value:function(){return U.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!w(e,"isClosed",this,1).call(this))throw new F("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new F("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return U.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Kt.constructor_.call(this,t,n),this.validateConstruction()}}])}(Kt);en.MINIMUM_VALID_SIZE=4;var kt=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"setOrdinate",value:function(t,n){switch(t){case e.X:this.x=n;break;case e.Y:this.y=n;break;default:throw new F("Invalid ordinate index: "+t)}}},{key:"getZ",value:function(){return S.NULL_ORDINATE}},{key:"getOrdinate",value:function(t){switch(t){case e.X:return this.x;case e.Y:return this.y}throw new F("Invalid ordinate index: "+t)}},{key:"setZ",value:function(t){throw new F("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)S.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof e){var t=arguments[0];S.constructor_.call(this,t.x,t.y)}else if(arguments[0]instanceof S){var n=arguments[0];S.constructor_.call(this,n.x,n.y)}}else if(arguments.length===2){var r=arguments[0],s=arguments[1];S.constructor_.call(this,r,s,S.NULL_ORDINATE)}}}])}(S);kt.X=0,kt.Y=1,kt.Z=-1,kt.M=-1;var xt=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(t,n){switch(t){case e.X:this.x=n;break;case e.Y:this.y=n;break;case e.M:this._m=n;break;default:throw new F("Invalid ordinate index: "+t)}}},{key:"setM",value:function(t){this._m=t}},{key:"getZ",value:function(){return S.NULL_ORDINATE}},{key:"getOrdinate",value:function(t){switch(t){case e.X:return this.x;case e.Y:return this.y;case e.M:return this._m}throw new F("Invalid ordinate index: "+t)}},{key:"setZ",value:function(t){throw new F("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)S.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof e){var t=arguments[0];S.constructor_.call(this,t.x,t.y),this._m=t._m}else if(arguments[0]instanceof S){var n=arguments[0];S.constructor_.call(this,n.x,n.y),this._m=this.getM()}}else if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];S.constructor_.call(this,r,s,S.NULL_ORDINATE),this._m=u}}}])}(S);xt.X=0,xt.Y=1,xt.Z=-1,xt.M=2;var ui=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(t,n){switch(t){case S.X:this.x=n;break;case S.Y:this.y=n;break;case S.Z:this.z=n;break;case S.M:this._m=n;break;default:throw new F("Invalid ordinate index: "+t)}}},{key:"setM",value:function(t){this._m=t}},{key:"getOrdinate",value:function(t){switch(t){case S.X:return this.x;case S.Y:return this.y;case S.Z:return this.getZ();case S.M:return this.getM()}throw new F("Invalid ordinate index: "+t)}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)S.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof e){var t=arguments[0];S.constructor_.call(this,t),this._m=t._m}else if(arguments[0]instanceof S){var n=arguments[0];S.constructor_.call(this,n),this._m=this.getM()}}else if(arguments.length===4){var r=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];S.constructor_.call(this,r,s,u),this._m=l}}}])}(S),Ln=function(){function i(){h(this,i)}return m(i,null,[{key:"measures",value:function(e){return e instanceof kt?0:e instanceof xt||e instanceof ui?1:0}},{key:"dimension",value:function(e){return e instanceof kt?2:e instanceof xt?3:e instanceof ui?4:3}},{key:"create",value:function(){if(arguments.length===1){var e=arguments[0];return i.create(e,0)}if(arguments.length===2){var t=arguments[0],n=arguments[1];return t===2?new kt:t===3&&n===0?new S:t===3&&n===1?new xt:t===4&&n===1?new ui:new S}}}])}(),tn=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"getCoordinate",value:function(t){return this.get(t)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&K(arguments[0],We)){for(var t=arguments[1],n=!1,r=arguments[0].iterator();r.hasNext();)this.add(r.next(),t),n=!0;return n}return w(e,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var t=w(e,"clone",this,1).call(this),n=0;n<this.size();n++)t.add(n,this.get(n).clone());return t}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(e.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(e.coordArrayType);for(var t=this.size(),n=new Array(t).fill(null),r=0;r<t;r++)n[r]=this.get(t-r-1);return n}}},{key:"add",value:function(){if(arguments.length===1){var t=arguments[0];return w(e,"add",this,1).call(this,t)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var n=arguments[0],r=arguments[1];return this.add(n,r,!0),!0}if(arguments[0]instanceof S&&typeof arguments[1]=="boolean"){var s=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(s))return null;w(e,"add",this,1).call(this,s)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var u=arguments[0],l=arguments[1];return this.add(u,l),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var g=arguments[0],d=arguments[1];if(arguments[2])for(var x=0;x<g.length;x++)this.add(g[x],d);else for(var I=g.length-1;I>=0;I--)this.add(g[I],d);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof S){var R=arguments[0],b=arguments[1];if(!arguments[2]){var z=this.size();if(z>0&&(R>0&&this.get(R-1).equals2D(b)||R<z&&this.get(R).equals2D(b)))return null}w(e,"add",this,1).call(this,R,b)}}else if(arguments.length===4){var X=arguments[0],re=arguments[1],ne=arguments[2],ce=arguments[3],Re=1;ne>ce&&(Re=-1);for(var be=ne;be!==ce;be+=Re)this.add(X[be],re);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var t=this.get(0).copy();this.add(t,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.ensureCapacity(n.length),this.add(n,r)}}}}])}(Z);tn.coordArrayType=new Array(0).fill(null);var Ne=function(){function i(){h(this,i)}return m(i,null,[{key:"isRing",value:function(e){return!(e.length<4)&&!!e[0].equals2D(e[e.length-1])}},{key:"ptNotInList",value:function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(i.indexOf(r,t)<0)return r}return null}},{key:"scroll",value:function(e,t){var n=i.indexOf(t,e);if(n<0)return null;var r=new Array(e.length).fill(null);Ye.arraycopy(e,n,r,0,e.length-n),Ye.arraycopy(e,0,r,e.length-n,n),Ye.arraycopy(r,0,e,0,e.length)}},{key:"equals",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];if(e===t)return!0;if(e===null||t===null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].equals(t[n]))return!1;return!0}if(arguments.length===3){var r=arguments[0],s=arguments[1],u=arguments[2];if(r===s)return!0;if(r===null||s===null||r.length!==s.length)return!1;for(var l=0;l<r.length;l++)if(u.compare(r[l],s[l])!==0)return!1;return!0}}},{key:"intersection",value:function(e,t){for(var n=new tn,r=0;r<e.length;r++)t.intersects(e[r])&&n.add(e[r],!0);return n.toCoordinateArray()}},{key:"measures",value:function(e){if(e===null||e.length===0)return 0;var t,n=0,r=L(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;n=Math.max(n,Ln.measures(s))}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"hasRepeatedPoints",value:function(e){for(var t=1;t<e.length;t++)if(e[t-1].equals(e[t]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(e){return i.hasRepeatedPoints(e)?new tn(e,!1).toCoordinateArray():e}},{key:"reverse",value:function(e){for(var t=e.length-1,n=Math.trunc(t/2),r=0;r<=n;r++){var s=e[r];e[r]=e[t-r],e[t-r]=s}}},{key:"removeNull",value:function(e){for(var t=0,n=0;n<e.length;n++)e[n]!==null&&t++;var r=new Array(t).fill(null);if(t===0)return r;for(var s=0,u=0;u<e.length;u++)e[u]!==null&&(r[s++]=e[u]);return r}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var e=arguments[0],t=new Array(e.length).fill(null),n=0;n<e.length;n++)t[n]=e[n].copy();return t}if(arguments.length===5)for(var r=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],g=arguments[4],d=0;d<g;d++)u[l+d]=r[s+d].copy()}},{key:"isEqualReversed",value:function(e,t){for(var n=0;n<e.length;n++){var r=e[n],s=t[e.length-n-1];if(r.compareTo(s)!==0)return!1}return!0}},{key:"envelope",value:function(e){for(var t=new ge,n=0;n<e.length;n++)t.expandToInclude(e[n]);return t}},{key:"toCoordinateArray",value:function(e){return e.toArray(i.coordArrayType)}},{key:"dimension",value:function(e){if(e===null||e.length===0)return 3;var t,n=0,r=L(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;n=Math.max(n,Ln.dimension(s))}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"atLeastNCoordinatesOrNothing",value:function(e,t){return t.length>=e?t:[]}},{key:"indexOf",value:function(e,t){for(var n=0;n<t.length;n++)if(e.equals(t[n]))return n;return-1}},{key:"increasingDirection",value:function(e){for(var t=0;t<Math.trunc(e.length/2);t++){var n=e.length-1-t,r=e[t].compareTo(e[n]);if(r!==0)return r}return 1}},{key:"compare",value:function(e,t){for(var n=0;n<e.length&&n<t.length;){var r=e[n].compareTo(t[n]);if(r!==0)return r;n++}return n<t.length?-1:n<e.length?1:0}},{key:"minCoordinate",value:function(e){for(var t=null,n=0;n<e.length;n++)(t===null||t.compareTo(e[n])>0)&&(t=e[n]);return t}},{key:"extract",value:function(e,t,n){t=Jt.clamp(t,0,e.length);var r=(n=Jt.clamp(n,-1,e.length))-t+1;n<0&&(r=0),t>=e.length&&(r=0),n<t&&(r=0);var s=new Array(r).fill(null);if(r===0)return s;for(var u=0,l=t;l<=n;l++)s[u++]=e[l];return s}}])}(),Aa=function(){return m(function i(){h(this,i)},[{key:"compare",value:function(i,e){var t=i,n=e;return Ne.compare(t,n)}},{key:"interfaces_",get:function(){return[Pe]}}])}(),Da=function(){return m(function i(){h(this,i)},[{key:"compare",value:function(i,e){var t=i,n=e;if(t.length<n.length)return-1;if(t.length>n.length)return 1;if(t.length===0)return 0;var r=Ne.compare(t,n);return Ne.isEqualReversed(t,n)?0:r}},{key:"OLDcompare",value:function(i,e){var t=i,n=e;if(t.length<n.length)return-1;if(t.length>n.length)return 1;if(t.length===0)return 0;for(var r=Ne.increasingDirection(t),s=Ne.increasingDirection(n),u=r>0?0:t.length-1,l=s>0?0:t.length-1,g=0;g<t.length;g++){var d=t[u].compareTo(n[l]);if(d!==0)return d;u+=r,l+=s}return 0}},{key:"interfaces_",get:function(){return[Pe]}}])}();Ne.ForwardComparator=Aa,Ne.BidirectionalComparator=Da,Ne.coordArrayType=new Array(0).fill(null);var Rn=function(){return m(function i(e){h(this,i),this.str=e},[{key:"append",value:function(i){this.str+=i}},{key:"setCharAt",value:function(i,e){this.str=this.str.substr(0,i)+e+this.str.substr(i+1)}},{key:"toString",value:function(){return this.str}}])}(),nn=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getM",value:function(e){return this.hasM()?this._coordinates[e].getM():Y.NaN}},{key:"setOrdinate",value:function(e,t,n){switch(t){case ie.X:this._coordinates[e].x=n;break;case ie.Y:this._coordinates[e].y=n;break;default:this._coordinates[e].setOrdinate(t,n)}}},{key:"getZ",value:function(e){return this.hasZ()?this._coordinates[e].getZ():Y.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(e,t){switch(t){case ie.X:return this._coordinates[e].x;case ie.Y:return this._coordinates[e].y;default:return this._coordinates[e].getOrdinate(t)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var e=arguments[0];return this._coordinates[e]}if(arguments.length===2){var t=arguments[0];arguments[1].setCoordinate(this._coordinates[t])}}},{key:"getCoordinateCopy",value:function(e){var t=this.createCoordinate();return t.setCoordinate(this._coordinates[e]),t}},{key:"createCoordinate",value:function(){return Ln.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(e){return this._coordinates[e].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(e){for(var t=0;t<this._coordinates.length;t++)e.expandToInclude(this._coordinates[t]);return e}},{key:"copy",value:function(){for(var e=new Array(this.size()).fill(null),t=0;t<this._coordinates.length;t++){var n=this.createCoordinate();n.setCoordinate(this._coordinates[t]),e[t]=n}return new i(e,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var e=new Rn(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var t=1;t<this._coordinates.length;t++)e.append(", "),e.append(this._coordinates[t]);return e.append(")"),e.toString()}return"()"}},{key:"getY",value:function(e){return this._coordinates[e].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[ie,B]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];i.constructor_.call(this,e,Ne.dimension(e),Ne.measures(e))}else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var n=0;n<t;n++)this._coordinates[n]=new S}else if(K(arguments[0],ie)){var r=arguments[0];if(r===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=r.getDimension(),this._measures=r.getMeasures(),this._coordinates=new Array(r.size()).fill(null);for(var s=0;s<this._coordinates.length;s++)this._coordinates[s]=r.getCoordinateCopy(s)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var u=arguments[0],l=arguments[1];i.constructor_.call(this,u,l,Ne.measures(u))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var g=arguments[0],d=arguments[1];this._coordinates=new Array(g).fill(null),this._dimension=d;for(var x=0;x<g;x++)this._coordinates[x]=Ln.create(d)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var I=arguments[0],R=arguments[1],b=arguments[2];this._dimension=R,this._measures=b,this._coordinates=I===null?new Array(0).fill(null):I}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var z=arguments[0],X=arguments[1],re=arguments[2];this._coordinates=new Array(z).fill(null),this._dimension=X,this._measures=re;for(var ne=0;ne<z;ne++)this._coordinates[ne]=this.createCoordinate()}}}}])}(),oi=function(){function i(){h(this,i)}return m(i,[{key:"readResolve",value:function(){return i.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new nn(arguments[0]);if(K(arguments[0],ie))return new nn(arguments[0])}else{if(arguments.length===2){var e=arguments[1];return e>3&&(e=3),e<2&&(e=2),new nn(arguments[0],e)}if(arguments.length===3){var t=arguments[2],n=arguments[1]-t;return t>1&&(t=1),n>3&&(n=3),n<2&&(n=2),new nn(arguments[0],n+t,t)}}}},{key:"interfaces_",get:function(){return[Ui,B]}}],[{key:"instance",value:function(){return i.instanceObject}}])}();oi.instanceObject=new oi;var li=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof U){var t=arguments[0],n=arguments[1];return!!this.isEquivalentClass(t)&&w(e,"equalsExact",this,1).call(this,t,n)}return w(e,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return U.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new Z,n=0;n<this._geometries.length;n++)for(var r=this._geometries[n].getBoundary(),s=0;s<r.getNumGeometries();s++)t.add(r.getGeometryN(s));var u=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(u))}},{key:"getGeometryType",value:function(){return U.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Zi]}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Fe.constructor_.call(this,t,n)}}])}(Fe),Wi=function(){return m(function i(){h(this,i)},[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])}(),Fa=function(i){function e(){var t;return h(this,e),(t=f(this,e)).map=new Map,t}return E(e,i),m(e,[{key:"get",value:function(t){return this.map.get(t)||null}},{key:"put",value:function(t,n){return this.map.set(t,n),n}},{key:"values",value:function(){for(var t=new Z,n=this.map.values(),r=n.next();!r.done;)t.add(r.value),r=n.next();return t}},{key:"entrySet",value:function(){var t=new ti;return this.map.entries().forEach(function(n){return t.add(n)}),t}},{key:"size",value:function(){return this.map.size()}}])}(Wi),He=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"equals",value:function(e){if(!(e instanceof i))return!1;var t=e;return this._modelType===t._modelType&&this._scale===t._scale}},{key:"compareTo",value:function(e){var t=e,n=this.getMaximumSignificantDigits(),r=t.getMaximumSignificantDigits();return In.compare(n,r)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===i.FLOATING||this._modelType===i.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var e="UNKNOWN";return this._modelType===i.FLOATING?e="Floating":this._modelType===i.FLOATING_SINGLE?e="Floating-Single":this._modelType===i.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var e=arguments[0];return Y.isNaN(e)||this._modelType===i.FLOATING_SINGLE?e:this._modelType===i.FIXED?Math.round(e*this._scale)/this._scale:e}if(arguments[0]instanceof S){var t=arguments[0];if(this._modelType===i.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}},{key:"getMaximumSignificantDigits",value:function(){var e=16;return this._modelType===i.FLOATING?e=16:this._modelType===i.FLOATING_SINGLE?e=6:this._modelType===i.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e}},{key:"setScale",value:function(e){this._scale=Math.abs(e)}},{key:"interfaces_",get:function(){return[B,j]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=i.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Lt){var e=arguments[0];this._modelType=e,e===i.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var t=arguments[0];this._modelType=i.FIXED,this.setScale(t)}else if(arguments[0]instanceof i){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}}}},{key:"mostPrecise",value:function(e,t){return e.compareTo(t)>=0?e:t}}])}(),Lt=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"readResolve",value:function(){return i.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){this._name=null;var e=arguments[0];this._name=e,i.nameToTypeMap.put(e,this)}}])}();Lt.nameToTypeMap=new Fa,He.Type=Lt,He.FIXED=new Lt("FIXED"),He.FLOATING=new Lt("FLOATING"),He.FLOATING_SINGLE=new Lt("FLOATING SINGLE"),He.maximumPreciseValue=9007199254740992;var hi=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"copyInternal",value:function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof U){var t=arguments[0],n=arguments[1];return!!this.isEquivalentClass(t)&&w(e,"equalsExact",this,1).call(this,t,n)}return w(e,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?M.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return U.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new ht}},{key:"getGeometryType",value:function(){return U.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[Xi]}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Fe.constructor_.call(this,t,n)}}])}(Fe),Rt=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"createEmpty",value:function(e){switch(e){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new F("Invalid dimension: "+e)}}},{key:"toGeometry",value:function(e){return e.isNull()?this.createPoint():e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new S(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new S(e.getMinX(),e.getMinY()),new S(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new S(e.getMinX(),e.getMinY()),new S(e.getMinX(),e.getMaxY()),new S(e.getMaxX(),e.getMaxY()),new S(e.getMaxX(),e.getMinY()),new S(e.getMinX(),e.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLineString(e!==null?this.getCoordinateSequenceFactory().create(e):null)}if(K(arguments[0],ie))return new Kt(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new hi(null,this):arguments.length===1?new hi(arguments[0],this):void 0}},{key:"buildGeometry",value:function(e){for(var t=null,n=!1,r=!1,s=e.iterator();s.hasNext();){var u=s.next(),l=u.getTypeCode();t===null&&(t=l),l!==t&&(n=!0),u instanceof Fe&&(r=!0)}if(t===null)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(i.toGeometryArray(e));var g=e.iterator().next();if(e.size()>1){if(g instanceof Tn)return this.createMultiPolygon(i.toPolygonArray(e));if(g instanceof Kt)return this.createMultiLineString(i.toLineStringArray(e));if(g instanceof si)return this.createMultiPoint(i.toPointArray(e));ee.shouldNeverReachHere("Unhandled geometry type: "+g.getGeometryType())}return g}},{key:"createMultiPointFromCoords",value:function(e){return this.createMultiPoint(e!==null?this.getCoordinateSequenceFactory().create(e):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];return this.createPoint(e!==null?this.getCoordinateSequenceFactory().create([e]):null)}if(K(arguments[0],ie))return new si(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(K(arguments[0],ie)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Array){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof en){var n=arguments[0];return this.createPolygon(n,null)}}else if(arguments.length===2)return new Tn(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new Fe(null,this):arguments.length===1?new Fe(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(e!==null?this.getCoordinateSequenceFactory().create(e):null)}if(K(arguments[0],ie))return new en(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new li(null,this):arguments.length===1?new li(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new ai(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new ai(arguments[0],this);if(K(arguments[0],ie)){var e=arguments[0];if(e===null)return this.createMultiPoint(new Array(0).fill(null));for(var t=new Array(e.size()).fill(null),n=0;n<e.size();n++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension(),e.getMeasures());pt.copy(e,n,r,0,1),t[n]=this.createPoint(r)}return this.createMultiPoint(t)}}}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)i.constructor_.call(this,new He,0);else if(arguments.length===1){if(K(arguments[0],Ui)){var e=arguments[0];i.constructor_.call(this,new He,0,e)}else if(arguments[0]instanceof He){var t=arguments[0];i.constructor_.call(this,t,0,i.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];i.constructor_.call(this,n,r,i.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];this._precisionModel=s,this._coordinateSequenceFactory=l,this._SRID=u}}},{key:"toMultiPolygonArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toGeometryArray",value:function(e){if(e===null)return null;var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return oi.instance()}},{key:"toMultiLineStringArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toLineStringArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toMultiPointArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toLinearRingArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toPointArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toPolygonArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"createPointFromInternalCoord",value:function(e,t){return t.getPrecisionModel().makePrecise(e),t.getFactory().createPoint(e)}}])}(),ci="XY",Ga="XYZ",za="XYM",Ya="XYZM",Qi={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Ji="EMPTY",On=1,st=2,ct=3,Ki=4,Ot=5,qa=6;for(var Ba in Qi)Qi[Ba].toUpperCase();var ja=function(){return m(function i(e){h(this,i),this.wkt=e,this.index_=-1},[{key:"isAlpha_",value:function(i){return i>="a"&&i<="z"||i>="A"&&i<="Z"}},{key:"isNumeric_",value:function(i,e){return i>="0"&&i<="9"||i=="."&&!(e!==void 0&&e)}},{key:"isWhiteSpace_",value:function(i){return i==" "||i=="	"||i=="\r"||i==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var i,e=this.nextChar_(),t=this.index_,n=e;if(e=="(")i=st;else if(e==",")i=Ot;else if(e==")")i=ct;else if(this.isNumeric_(e)||e=="-")i=Ki,n=this.readNumber_();else if(this.isAlpha_(e))i=On,n=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(e!=="")throw new Error("Unexpected character: "+e);i=qa}return{position:t,value:n,type:i}}},{key:"readNumber_",value:function(){var i,e=this.index_,t=!1,n=!1;do i=="."?t=!0:i!="e"&&i!="E"||(n=!0),i=this.nextChar_();while(this.isNumeric_(i,t)||!n&&(i=="e"||i=="E")||n&&(i=="-"||i=="+"));return parseFloat(this.wkt.substring(e,this.index_--))}},{key:"readText_",value:function(){var i,e=this.index_;do i=this.nextChar_();while(this.isAlpha_(i));return this.wkt.substring(e,this.index_--).toUpperCase()}}])}(),Ua=function(){return m(function i(e,t){h(this,i),this.lexer_=e,this.token_,this.layout_=ci,this.factory=t},[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(i){return this.token_.type==i}},{key:"match",value:function(i){var e=this.isTokenType(i);return e&&this.consume_(),e}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var i=ci,e=this.token_;if(this.isTokenType(On)){var t=e.value;t==="Z"?i=Ga:t==="M"?i=za:t==="ZM"&&(i=Ya),i!==ci&&this.consume_()}return i}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(st)){var i=[];do i.push(this.parseGeometry_());while(this.match(Ot));if(this.match(ct))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(st)){var i=this.parsePoint_();if(this.match(ct))return i}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(st)){var i=this.parsePointList_();if(this.match(ct))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(st)){var i=this.parseLineStringTextList_();if(this.match(ct))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var i;if(this.match(st)){if(i=this.token_.type==st?this.parsePointTextList_():this.parsePointList_(),this.match(ct))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(st)){var i=this.parseLineStringTextList_();if(this.match(ct))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(st)){var i=this.parsePolygonTextList_();if(this.match(ct))return i}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var i=[],e=this.layout_.length,t=0;t<e;++t){var n=this.token_;if(!this.match(Ki))break;i.push(n.value)}if(i.length==e)return i;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var i=[this.parsePoint_()];this.match(Ot);)i.push(this.parsePoint_());return i}},{key:"parsePointTextList_",value:function(){for(var i=[this.parsePointText_()];this.match(Ot);)i.push(this.parsePointText_());return i}},{key:"parseLineStringTextList_",value:function(){for(var i=[this.parseLineStringText_()];this.match(Ot);)i.push(this.parseLineStringText_());return i}},{key:"parsePolygonTextList_",value:function(){for(var i=[this.parsePolygonText_()];this.match(Ot);)i.push(this.parsePolygonText_());return i}},{key:"isEmptyGeometry_",value:function(){var i=this.isTokenType(On)&&this.token_.value==Ji;return i&&this.consume_(),i}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var i=this.factory,e=function(X){return y(S,H(X))},t=function(X){var re=X.map(function(ne){return i.createLinearRing(ne.map(e))});return re.length>1?i.createPolygon(re[0],re.slice(1)):i.createPolygon(re[0])},n=this.token_;if(this.match(On)){var r=n.value;if(this.layout_=this.parseGeometryLayout_(),r=="GEOMETRYCOLLECTION"){var s=this.parseGeometryCollectionText_();return i.createGeometryCollection(s)}switch(r){case"POINT":var u=this.parsePointText_();return u?i.createPoint(y(S,H(u))):i.createPoint();case"LINESTRING":var l=this.parseLineStringText_().map(e);return i.createLineString(l);case"LINEARRING":var g=this.parseLineStringText_().map(e);return i.createLinearRing(g);case"POLYGON":var d=this.parsePolygonText_();return d&&d.length!==0?t(d):i.createPolygon();case"MULTIPOINT":var x=this.parseMultiPointText_();if(!x||x.length===0)return i.createMultiPoint();var I=x.map(e).map(function(X){return i.createPoint(X)});return i.createMultiPoint(I);case"MULTILINESTRING":var R=this.parseMultiLineStringText_().map(function(X){return i.createLineString(X.map(e))});return i.createMultiLineString(R);case"MULTIPOLYGON":var b=this.parseMultiPolygonText_();if(!b||b.length===0)return i.createMultiPolygon();var z=b.map(t);return i.createMultiPolygon(z);default:throw new Error("Invalid geometry type: "+r)}}throw new Error(this.formatErrorMessage_())}}])}();function er(i){if(i.isEmpty())return"";var e=i.getCoordinate(),t=[e.x,e.y];return e.z===void 0||Number.isNaN(e.z)||t.push(e.z),e.m===void 0||Number.isNaN(e.m)||t.push(e.m),t.join(" ")}function rn(i){for(var e=i.getCoordinates().map(function(s){var u=[s.x,s.y];return s.z===void 0||Number.isNaN(s.z)||u.push(s.z),s.m===void 0||Number.isNaN(s.m)||u.push(s.m),u}),t=[],n=0,r=e.length;n<r;++n)t.push(e[n].join(" "));return t.join(", ")}function tr(i){var e=[];e.push("("+rn(i.getExteriorRing())+")");for(var t=0,n=i.getNumInteriorRing();t<n;++t)e.push("("+rn(i.getInteriorRingN(t))+")");return e.join(", ")}var Xa={Point:er,LineString:rn,LinearRing:rn,Polygon:tr,MultiPoint:function(i){for(var e=[],t=0,n=i.getNumGeometries();t<n;++t)e.push("("+er(i.getGeometryN(t))+")");return e.join(", ")},MultiLineString:function(i){for(var e=[],t=0,n=i.getNumGeometries();t<n;++t)e.push("("+rn(i.getGeometryN(t))+")");return e.join(", ")},MultiPolygon:function(i){for(var e=[],t=0,n=i.getNumGeometries();t<n;++t)e.push("("+tr(i.getGeometryN(t))+")");return e.join(", ")},GeometryCollection:function(i){for(var e=[],t=0,n=i.getNumGeometries();t<n;++t)e.push(nr(i.getGeometryN(t)));return e.join(", ")}};function nr(i){var e=i.getGeometryType(),t=Xa[e];e=e.toUpperCase();var n=function(r){var s="";if(r.isEmpty())return s;var u=r.getCoordinate();return u.z===void 0||Number.isNaN(u.z)||(s+="Z"),u.m===void 0||Number.isNaN(u.m)||(s+="M"),s}(i);return n.length>0&&(e+=" "+n),i.isEmpty()?e+" "+Ji:e+" ("+t(i)+")"}var Va=function(){return m(function i(e){h(this,i),this.geometryFactory=e||new Rt,this.precisionModel=this.geometryFactory.getPrecisionModel()},[{key:"read",value:function(i){var e=new ja(i);return new Ua(e,this.geometryFactory).parse()}},{key:"write",value:function(i){return nr(i)}}])}(),fi=function(){return m(function i(e){h(this,i),this.parser=new Va(e)},[{key:"write",value:function(i){return this.parser.write(i)}}],[{key:"toLineString",value:function(i,e){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+i.x+" "+i.y+", "+e.x+" "+e.y+" )"}}])}(),de=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getIndexAlongSegment",value:function(e,t){return this.computeIntLineIndex(),this._intLineIndex[e][t]}},{key:"getTopologySummary",value:function(){var e=new Rn;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()}},{key:"computeIntersection",value:function(e,t,n,r){this._inputLines[0][0]=e,this._inputLines[0][1]=t,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(e,t,n,r)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var e=arguments[0];this.getEdgeDistance(e,0)>this.getEdgeDistance(e,1)?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var e=arguments[0],t=0;t<this._result;t++)if(!this._intPt[t].equals2D(this._inputLines[e][0])&&!this._intPt[t].equals2D(this._inputLines[e][1]))return!0;return!1}}},{key:"getIntersection",value:function(e){return this._intPt[e]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==i.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(e,t){return i.computeEdgeDistance(this._intPt[t],this._inputLines[e][0],this._inputLines[e][1])}},{key:"isCollinear",value:function(){return this._result===i.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return fi.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+fi.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(e,t){return this._inputLines[e][t]}},{key:"isIntersection",value:function(e){for(var t=0;t<this._result;t++)if(this._intPt[t].equals2D(e))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(e,t){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][t]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new S,this._intPt[1]=new S,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(e,t,n){var r=Math.abs(n.x-t.x),s=Math.abs(n.y-t.y),u=-1;if(e.equals(t))u=0;else if(e.equals(n))u=r>s?r:s;else{var l=Math.abs(e.x-t.x),g=Math.abs(e.y-t.y);(u=r>s?l:g)!==0||e.equals(t)||(u=Math.max(l,g))}return ee.isTrue(!(u===0&&!e.equals(t)),"Bad distance calculation"),u}},{key:"nonRobustComputeEdgeDistance",value:function(e,t,n){var r=e.x-t.x,s=e.y-t.y,u=Math.sqrt(r*r+s*s);return ee.isTrue(!(u===0&&!e.equals(t)),"Invalid distance calculation"),u}}])}();de.DONT_INTERSECT=0,de.DO_INTERSECT=1,de.COLLINEAR=2,de.NO_INTERSECTION=0,de.POINT_INTERSECTION=1,de.COLLINEAR_INTERSECTION=2;var Et=function(i){function e(){return h(this,e),f(this,e)}return E(e,i),m(e,[{key:"isInSegmentEnvelopes",value:function(t){var n=new ge(this._inputLines[0][0],this._inputLines[0][1]),r=new ge(this._inputLines[1][0],this._inputLines[1][1]);return n.contains(t)&&r.contains(t)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return w(e,"computeIntersection",this,1).apply(this,arguments);var t=arguments[0],n=arguments[1],r=arguments[2];if(this._isProper=!1,ge.intersects(n,r,t)&&J.index(n,r,t)===0&&J.index(r,n,t)===0)return this._isProper=!0,(t.equals(n)||t.equals(r))&&(this._isProper=!1),this._result=de.POINT_INTERSECTION,null;this._result=de.NO_INTERSECTION}},{key:"intersection",value:function(t,n,r,s){var u=this.intersectionSafe(t,n,r,s);return this.isInSegmentEnvelopes(u)||(u=new S(e.nearestEndpoint(t,n,r,s))),this._precisionModel!==null&&this._precisionModel.makePrecise(u),u}},{key:"checkDD",value:function(t,n,r,s,u){var l=ii.intersection(t,n,r,s),g=this.isInSegmentEnvelopes(l);Ye.out.println("DD in env = "+g+"  --------------------- "+l),u.distance(l)>1e-4&&Ye.out.println("Distance = "+u.distance(l))}},{key:"intersectionSafe",value:function(t,n,r,s){var u=ri.intersection(t,n,r,s);return u===null&&(u=e.nearestEndpoint(t,n,r,s)),u}},{key:"computeCollinearIntersection",value:function(t,n,r,s){var u=ge.intersects(t,n,r),l=ge.intersects(t,n,s),g=ge.intersects(r,s,t),d=ge.intersects(r,s,n);return u&&l?(this._intPt[0]=r,this._intPt[1]=s,de.COLLINEAR_INTERSECTION):g&&d?(this._intPt[0]=t,this._intPt[1]=n,de.COLLINEAR_INTERSECTION):u&&g?(this._intPt[0]=r,this._intPt[1]=t,!r.equals(t)||l||d?de.COLLINEAR_INTERSECTION:de.POINT_INTERSECTION):u&&d?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||l||g?de.COLLINEAR_INTERSECTION:de.POINT_INTERSECTION):l&&g?(this._intPt[0]=s,this._intPt[1]=t,!s.equals(t)||u||d?de.COLLINEAR_INTERSECTION:de.POINT_INTERSECTION):l&&d?(this._intPt[0]=s,this._intPt[1]=n,!s.equals(n)||u||g?de.COLLINEAR_INTERSECTION:de.POINT_INTERSECTION):de.NO_INTERSECTION}},{key:"computeIntersect",value:function(t,n,r,s){if(this._isProper=!1,!ge.intersects(t,n,r,s))return de.NO_INTERSECTION;var u=J.index(t,n,r),l=J.index(t,n,s);if(u>0&&l>0||u<0&&l<0)return de.NO_INTERSECTION;var g=J.index(r,s,t),d=J.index(r,s,n);return g>0&&d>0||g<0&&d<0?de.NO_INTERSECTION:u===0&&l===0&&g===0&&d===0?this.computeCollinearIntersection(t,n,r,s):(u===0||l===0||g===0||d===0?(this._isProper=!1,t.equals2D(r)||t.equals2D(s)?this._intPt[0]=t:n.equals2D(r)||n.equals2D(s)?this._intPt[0]=n:u===0?this._intPt[0]=new S(r):l===0?this._intPt[0]=new S(s):g===0?this._intPt[0]=new S(t):d===0&&(this._intPt[0]=new S(n))):(this._isProper=!0,this._intPt[0]=this.intersection(t,n,r,s)),de.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(t,n,r,s){var u=t,l=Qe.pointToSegment(t,r,s),g=Qe.pointToSegment(n,r,s);return g<l&&(l=g,u=n),(g=Qe.pointToSegment(r,t,n))<l&&(l=g,u=r),(g=Qe.pointToSegment(s,t,n))<l&&(l=g,u=s),u}}])}(de),Ha=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"countSegment",value:function(e,t){if(e.x<this._p.x&&t.x<this._p.x)return null;if(this._p.x===t.x&&this._p.y===t.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&t.y===this._p.y){var n=e.x,r=t.x;return n>r&&(n=t.x,r=e.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&t.y<=this._p.y||t.y>this._p.y&&e.y<=this._p.y){var s=J.index(e,t,this._p);if(s===J.COLLINEAR)return this._isPointOnSegment=!0,null;t.y<e.y&&(s=-s),s===J.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==v.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?v.BOUNDARY:this._crossingCount%2==1?v.INTERIOR:v.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=arguments[0];this._p=e}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof S&&K(arguments[1],ie)){for(var e=arguments[1],t=new i(arguments[0]),n=new S,r=new S,s=1;s<e.size();s++)if(e.getCoordinate(s,n),e.getCoordinate(s-1,r),t.countSegment(n,r),t.isOnSegment())return t.getLocation();return t.getLocation()}if(arguments[0]instanceof S&&arguments[1]instanceof Array){for(var u=arguments[1],l=new i(arguments[0]),g=1;g<u.length;g++){var d=u[g],x=u[g-1];if(l.countSegment(d,x),l.isOnSegment())return l.getLocation()}return l.getLocation()}}}])}(),gi=function(){function i(){h(this,i)}return m(i,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof S&&K(arguments[1],ie)){for(var e=arguments[0],t=arguments[1],n=new Et,r=new S,s=new S,u=t.size(),l=1;l<u;l++)if(t.getCoordinate(l-1,r),t.getCoordinate(l,s),n.computeIntersection(e,r,s),n.hasIntersection())return!0;return!1}if(arguments[0]instanceof S&&arguments[1]instanceof Array){for(var g=arguments[0],d=arguments[1],x=new Et,I=1;I<d.length;I++){var R=d[I-1],b=d[I];if(x.computeIntersection(g,R,b),x.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(e,t){return Ha.locatePointInRing(e,t)}},{key:"isInRing",value:function(e,t){return i.locateInRing(e,t)!==v.EXTERIOR}}])}(),qe=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"setAllLocations",value:function(e){for(var t=0;t<this.location.length;t++)this.location[t]=e}},{key:"isNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]!==v.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(e){for(var t=0;t<this.location.length;t++)this.location[t]===v.NONE&&(this.location[t]=e)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(e){if(e.location.length>this.location.length){var t=new Array(3).fill(null);t[O.ON]=this.location[O.ON],t[O.LEFT]=v.NONE,t[O.RIGHT]=v.NONE,this.location=t}for(var n=0;n<this.location.length;n++)this.location[n]===v.NONE&&n<e.location.length&&(this.location[n]=e.location[n])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var e=this.location[O.LEFT];this.location[O.LEFT]=this.location[O.RIGHT],this.location[O.RIGHT]=e}},{key:"toString",value:function(){var e=new Qt;return this.location.length>1&&e.append(v.toLocationSymbol(this.location[O.LEFT])),e.append(v.toLocationSymbol(this.location[O.ON])),this.location.length>1&&e.append(v.toLocationSymbol(this.location[O.RIGHT])),e.toString()}},{key:"setLocations",value:function(e,t,n){this.location[O.ON]=e,this.location[O.LEFT]=t,this.location[O.RIGHT]=n}},{key:"get",value:function(e){return e<this.location.length?this.location[e]:v.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]===v.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var e=arguments[0];this.setLocation(O.ON,e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.location[t]=n}}},{key:"init",value:function(e){this.location=new Array(e).fill(null),this.setAllLocations(v.NONE)}},{key:"isEqualOnSide",value:function(e,t){return this.location[t]===e.location[t]}},{key:"allPositionsEqual",value:function(e){for(var t=0;t<this.location.length;t++)if(this.location[t]!==e)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var t=arguments[0];this.init(1),this.location[O.ON]=t}else if(arguments[0]instanceof i){var n=arguments[0];if(this.init(n.location.length),n!==null)for(var r=0;r<this.location.length;r++)this.location[r]=n.location[r]}}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];this.init(3),this.location[O.ON]=s,this.location[O.LEFT]=u,this.location[O.RIGHT]=l}}}])}(),Be=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getGeometryCount",value:function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e}},{key:"setAllLocations",value:function(e,t){this.elt[e].setAllLocations(t)}},{key:"isNull",value:function(e){return this.elt[e].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.elt[t].setAllLocationsIfNull(n)}}},{key:"isLine",value:function(e){return this.elt[e].isLine()}},{key:"merge",value:function(e){for(var t=0;t<2;t++)this.elt[t]===null&&e.elt[t]!==null?this.elt[t]=new qe(e.elt[t]):this.elt[t].merge(e.elt[t])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var e=arguments[0];return this.elt[e].get(O.ON)}if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.elt[t].get(n)}}},{key:"toString",value:function(){var e=new Qt;return this.elt[0]!==null&&(e.append("A:"),e.append(this.elt[0].toString())),this.elt[1]!==null&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var e=arguments[0];return this.elt[e].isArea()}}},{key:"isAnyNull",value:function(e){return this.elt[e].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.elt[e].setLocation(O.ON,t)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];this.elt[n].setLocation(r,s)}}},{key:"isEqualOnSide",value:function(e,t){return this.elt[0].isEqualOnSide(e.elt[0],t)&&this.elt[1].isEqualOnSide(e.elt[1],t)}},{key:"allPositionsEqual",value:function(e,t){return this.elt[e].allPositionsEqual(t)}},{key:"toLine",value:function(e){this.elt[e].isArea()&&(this.elt[e]=new qe(this.elt[e].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new qe(e),this.elt[1]=new qe(e)}else if(arguments[0]instanceof i){var t=arguments[0];this.elt[0]=new qe(t.elt[0]),this.elt[1]=new qe(t.elt[1])}}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.elt[0]=new qe(v.NONE),this.elt[1]=new qe(v.NONE),this.elt[n].setLocation(r)}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];this.elt[0]=new qe(s,u,l),this.elt[1]=new qe(s,u,l)}else if(arguments.length===4){var g=arguments[0],d=arguments[1],x=arguments[2],I=arguments[3];this.elt[0]=new qe(v.NONE,v.NONE,v.NONE),this.elt[1]=new qe(v.NONE,v.NONE,v.NONE),this.elt[g].setLocations(d,x,I)}}},{key:"toLineLabel",value:function(e){for(var t=new i(v.NONE),n=0;n<2;n++)t.setLocation(n,e.getLocation(n));return t}}])}(),Mn=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var i=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)i[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(i),this._isHole=J.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(i){this._startDe=i;var e=i,t=!0;do{if(e===null)throw new rt("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new rt("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var n=e.getLabel();ee.isTrue(n.isArea()),this.mergeLabel(n),this.addPoints(e.getEdge(),e.isForward(),t),t=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(i){return this._pts.get(i)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var i=this._startDe;do{var e=i.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),i=this.getNext(i)}while(i!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(i,e,t){var n=i.getCoordinates();if(e){var r=1;t&&(r=0);for(var s=r;s<n.length;s++)this._pts.add(n[s])}else{var u=n.length-2;t&&(u=n.length-1);for(var l=u;l>=0;l--)this._pts.add(n[l])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var i=this._startDe;do i.getEdge().setInResult(!0),i=i.getNext();while(i!==this._startDe)}},{key:"containsPoint",value:function(i){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(i)||!gi.isInRing(i,e.getCoordinates()))return!1;for(var t=this._holes.iterator();t.hasNext();)if(t.next().containsPoint(i))return!1;return!0}},{key:"addHole",value:function(i){this._holes.add(i)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var i=arguments[0];this.mergeLabel(i,0),this.mergeLabel(i,1)}else if(arguments.length===2){var e=arguments[1],t=arguments[0].getLocation(e,O.RIGHT);if(t===v.NONE)return null;if(this._label.getLocation(e)===v.NONE)return this._label.setLocation(e,t),null}}},{key:"setShell",value:function(i){this._shell=i,i!==null&&i.addHole(this)}},{key:"toPolygon",value:function(i){for(var e=new Array(this._holes.size()).fill(null),t=0;t<this._holes.size();t++)e[t]=this._holes.get(t).getLinearRing();return i.createPolygon(this.getLinearRing(),e)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new Z,this._pts=new Z,this._label=new Be(v.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Z,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var i=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(i),this.computeRing()}}}}])}(),Za=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"setEdgeRing",value:function(t,n){t.setMinEdgeRing(n)}},{key:"getNext",value:function(t){return t.getNextMin()}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Mn.constructor_.call(this,t,n)}}])}(Mn),$a=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"buildMinimalRings",value:function(){var t=new Z,n=this._startDe;do{if(n.getMinEdgeRing()===null){var r=new Za(n,this._geometryFactory);t.add(r)}n=n.getNext()}while(n!==this._startDe);return t}},{key:"setEdgeRing",value:function(t,n){t.setEdgeRing(n)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var t=this._startDe;do t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext();while(t!==this._startDe)}},{key:"getNext",value:function(t){return t.getNext()}}],[{key:"constructor_",value:function(){var t=arguments[0],n=arguments[1];Mn.constructor_.call(this,t,n)}}])}(Mn),ir=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"setVisited",value:function(i){this._isVisited=i}},{key:"setInResult",value:function(i){this._isInResult=i}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(i){this._label=i}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(i){this._isCovered=i,this._isCoveredSet=!0}},{key:"updateIM",value:function(i){ee.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(i)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var i=arguments[0];this._label=i}}}}])}(),bn=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"isIncidentEdgeInResult",value:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(t){t.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(t){}},{key:"computeMergedLocation",value:function(t,n){var r=v.NONE;if(r=this._label.getLocation(n),!t.isNull(n)){var s=t.getLocation(n);r!==v.BOUNDARY&&(r=s)}return r}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return w(e,"setLabel",this,1).apply(this,arguments);var t=arguments[0],n=arguments[1];this._label===null?this._label=new Be(t,n):this._label.setLocation(t,n)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Be)for(var n=arguments[0],r=0;r<2;r++){var s=this.computeMergedLocation(n,r);this._label.getLocation(r)===v.NONE&&this._label.setLocation(r,s)}}},{key:"add",value:function(t){this._edges.insert(t),t.setNode(this)}},{key:"setLabelBoundary",value:function(t){if(this._label===null)return null;var n=v.NONE;this._label!==null&&(n=this._label.getLocation(t));var r=null;switch(n){case v.BOUNDARY:r=v.INTERIOR;break;case v.INTERIOR:default:r=v.BOUNDARY}this._label.setLocation(t,r)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var t=arguments[0],n=arguments[1];this._coord=t,this._edges=n,this._label=new Be(0,v.NONE)}}])}(ir),Wa=function(i){function e(){return h(this,e),f(this,e,arguments)}return E(e,i),m(e)}(Wi);function rr(i){return i==null?0:i.color}function ue(i){return i==null?null:i.parent}function Je(i,e){i!==null&&(i.color=e)}function mi(i){return i==null?null:i.left}function sr(i){return i==null?null:i.right}var sn=function(i){function e(){var t;return h(this,e),(t=f(this,e)).root_=null,t.size_=0,t}return E(e,i),m(e,[{key:"get",value:function(t){for(var n=this.root_;n!==null;){var r=t.compareTo(n.key);if(r<0)n=n.left;else{if(!(r>0))return n.value;n=n.right}}return null}},{key:"put",value:function(t,n){if(this.root_===null)return this.root_={key:t,value:n,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var r,s,u=this.root_;do if(r=u,(s=t.compareTo(u.key))<0)u=u.left;else{if(!(s>0)){var l=u.value;return u.value=n,l}u=u.right}while(u!==null);var g={key:t,left:null,right:null,value:n,parent:r,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return s<0?r.left=g:r.right=g,this.fixAfterInsertion(g),this.size_++,null}},{key:"fixAfterInsertion",value:function(t){var n;for(t.color=1;t!=null&&t!==this.root_&&t.parent.color===1;)ue(t)===mi(ue(ue(t)))?rr(n=sr(ue(ue(t))))===1?(Je(ue(t),0),Je(n,0),Je(ue(ue(t)),1),t=ue(ue(t))):(t===sr(ue(t))&&(t=ue(t),this.rotateLeft(t)),Je(ue(t),0),Je(ue(ue(t)),1),this.rotateRight(ue(ue(t)))):rr(n=mi(ue(ue(t))))===1?(Je(ue(t),0),Je(n,0),Je(ue(ue(t)),1),t=ue(ue(t))):(t===mi(ue(t))&&(t=ue(t),this.rotateRight(t)),Je(ue(t),0),Je(ue(ue(t)),1),this.rotateLeft(ue(ue(t))));this.root_.color=0}},{key:"values",value:function(){var t=new Z,n=this.getFirstEntry();if(n!==null)for(t.add(n.value);(n=e.successor(n))!==null;)t.add(n.value);return t}},{key:"entrySet",value:function(){var t=new ti,n=this.getFirstEntry();if(n!==null)for(t.add(n);(n=e.successor(n))!==null;)t.add(n);return t}},{key:"rotateLeft",value:function(t){if(t!=null){var n=t.right;t.right=n.left,n.left!=null&&(n.left.parent=t),n.parent=t.parent,t.parent==null?this.root_=n:t.parent.left===t?t.parent.left=n:t.parent.right=n,n.left=t,t.parent=n}}},{key:"rotateRight",value:function(t){if(t!=null){var n=t.left;t.left=n.right,n.right!=null&&(n.right.parent=t),n.parent=t.parent,t.parent==null?this.root_=n:t.parent.right===t?t.parent.right=n:t.parent.left=n,n.right=t,t.parent=n}}},{key:"getFirstEntry",value:function(){var t=this.root_;if(t!=null)for(;t.left!=null;)t=t.left;return t}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(t){for(var n=this.root_;n!==null;){var r=t.compareTo(n.key);if(r<0)n=n.left;else{if(!(r>0))return!0;n=n.right}}return!1}}],[{key:"successor",value:function(t){var n;if(t===null)return null;if(t.right!==null){for(n=t.right;n.left!==null;)n=n.left;return n}n=t.parent;for(var r=t;n!==null&&r===n.right;)r=n,n=n.parent;return n}}])}(Wa),ar=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"find",value:function(i){return this.nodeMap.get(i)}},{key:"addNode",value:function(){if(arguments[0]instanceof S){var i=arguments[0],e=this.nodeMap.get(i);return e===null&&(e=this.nodeFact.createNode(i),this.nodeMap.put(i,e)),e}if(arguments[0]instanceof bn){var t=arguments[0],n=this.nodeMap.get(t.getCoordinate());return n===null?(this.nodeMap.put(t.getCoordinate(),t),t):(n.mergeLabel(t),n)}}},{key:"print",value:function(i){for(var e=this.iterator();e.hasNext();)e.next().print(i)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(i){for(var e=new Z,t=this.iterator();t.hasNext();){var n=t.next();n.getLabel().getLocation(i)===v.BOUNDARY&&e.add(n)}return e}},{key:"add",value:function(i){var e=i.getCoordinate();this.addNode(e).add(i)}}],[{key:"constructor_",value:function(){this.nodeMap=new sn,this.nodeFact=null;var i=arguments[0];this.nodeFact=i}}])}(),Ae=function(){function i(){h(this,i)}return m(i,null,[{key:"isNorthern",value:function(e){return e===i.NE||e===i.NW}},{key:"isOpposite",value:function(e,t){return e!==t&&(e-t+4)%4===2}},{key:"commonHalfPlane",value:function(e,t){if(e===t)return e;if((e-t+4)%4===2)return-1;var n=e<t?e:t;return n===0&&(e>t?e:t)===3?3:n}},{key:"isInHalfPlane",value:function(e,t){return t===i.SE?e===i.SE||e===i.SW:e===t||e===t+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new F("Cannot compute the quadrant for point ( "+e+", "+t+" )");return e>=0?t>=0?i.NE:i.SE:t>=0?i.NW:i.SW}if(arguments[0]instanceof S&&arguments[1]instanceof S){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new F("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?i.NE:i.SE:r.y>=n.y?i.NW:i.SW}}}])}();Ae.NE=0,Ae.NW=1,Ae.SW=2,Ae.SE=3;var ur=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"compareDirection",value:function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:J.index(e._p0,e._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(e){this._node=e}},{key:"print",value:function(e){var t=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),s=n.substring(r+1);e.print("  "+s+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label)}},{key:"compareTo",value:function(e){var t=e;return this.compareDirection(t)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var e=Math.atan2(this._dy,this._dx),t=this.getClass().getName(),n=t.lastIndexOf(".");return"  "+t.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label}},{key:"computeLabel",value:function(e){}},{key:"init",value:function(e,t){this._p0=e,this._p1=t,this._dx=t.x-e.x,this._dy=t.y-e.y,this._quadrant=Ae.quadrant(this._dx,this._dy),ee.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var e=arguments[0];this._edge=e}else if(arguments.length===3){var t=arguments[0],n=arguments[1],r=arguments[2];i.constructor_.call(this,t,n,r,null)}else if(arguments.length===4){var s=arguments[0],u=arguments[1],l=arguments[2],g=arguments[3];i.constructor_.call(this,s),this.init(u,l),this._label=g}}}])}(),di=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(t){return this._depth[t]}},{key:"setVisited",value:function(t){this._isVisited=t}},{key:"computeDirectedLabel",value:function(){this._label=new Be(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(t,n){if(this._depth[t]!==-999&&this._depth[t]!==n)throw new rt("assigned depths do not match",this.getCoordinate());this._depth[t]=n}},{key:"isInteriorAreaEdge",value:function(){for(var t=!0,n=0;n<2;n++)this._label.isArea(n)&&this._label.getLocation(n,O.LEFT)===v.INTERIOR&&this._label.getLocation(n,O.RIGHT)===v.INTERIOR||(t=!1);return t}},{key:"setNextMin",value:function(t){this._nextMin=t}},{key:"print",value:function(t){w(e,"print",this,1).call(this,t),t.print(" "+this._depth[O.LEFT]+"/"+this._depth[O.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}},{key:"setMinEdgeRing",value:function(t){this._minEdgeRing=t}},{key:"isLineEdge",value:function(){var t=this._label.isLine(0)||this._label.isLine(1),n=!this._label.isArea(0)||this._label.allPositionsEqual(0,v.EXTERIOR),r=!this._label.isArea(1)||this._label.allPositionsEqual(1,v.EXTERIOR);return t&&n&&r}},{key:"setEdgeRing",value:function(t){this._edgeRing=t}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}},{key:"setInResult",value:function(t){this._isInResult=t}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}},{key:"setSym",value:function(t){this._sym=t}},{key:"setVisitedEdge",value:function(t){this.setVisited(t),this._sym.setVisited(t)}},{key:"setEdgeDepths",value:function(t,n){var r=this.getEdge().getDepthDelta();this._isForward||(r=-r);var s=1;t===O.LEFT&&(s=-1);var u=O.opposite(t),l=n+r*s;this.setDepth(t,n),this.setDepth(u,l)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(t){this._next=t}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var t=arguments[0],n=arguments[1];if(ur.constructor_.call(this,t),this._isForward=n,n)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var r=t.getNumPoints()-1;this.init(t.getCoordinate(r),t.getCoordinate(r-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(t,n){return t===v.EXTERIOR&&n===v.INTERIOR?1:t===v.INTERIOR&&n===v.EXTERIOR?-1:0}}])}(ur),or=function(){return m(function i(){h(this,i)},[{key:"createNode",value:function(i){return new bn(i,null)}}])}(),lr=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"printEdges",value:function(i){i.println("Edges:");for(var e=0;e<this._edges.size();e++){i.println("edge "+e+":");var t=this._edges.get(e);t.print(i),t.eiList.print(i)}}},{key:"find",value:function(i){return this._nodes.find(i)}},{key:"addNode",value:function(){if(arguments[0]instanceof bn){var i=arguments[0];return this._nodes.addNode(i)}if(arguments[0]instanceof S){var e=arguments[0];return this._nodes.addNode(e)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var i=this._nodes.iterator();i.hasNext();)i.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(i){Ye.out.println(i)}},{key:"isBoundaryNode",value:function(i,e){var t=this._nodes.find(e);if(t===null)return!1;var n=t.getLabel();return n!==null&&n.getLocation(i)===v.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var i=this._nodes.iterator();i.hasNext();)i.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(i,e,t,n){return!!i.equals(t)&&J.index(i,e,n)===J.COLLINEAR&&Ae.quadrant(i,e)===Ae.quadrant(t,n)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(i){Ye.out.print(i)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(i,e){for(var t=0;t<this._edges.size();t++){var n=this._edges.get(t),r=n.getCoordinates();if(this.matchInSameDirection(i,e,r[0],r[1])||this.matchInSameDirection(i,e,r[r.length-1],r[r.length-2]))return n}return null}},{key:"insertEdge",value:function(i){this._edges.add(i)}},{key:"findEdgeEnd",value:function(i){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var t=e.next();if(t.getEdge()===i)return t}return null}},{key:"addEdges",value:function(i){for(var e=i.iterator();e.hasNext();){var t=e.next();this._edges.add(t);var n=new di(t,!0),r=new di(t,!1);n.setSym(r),r.setSym(n),this.add(n),this.add(r)}}},{key:"add",value:function(i){this._nodes.add(i),this._edgeEndList.add(i)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(i,e){for(var t=0;t<this._edges.size();t++){var n=this._edges.get(t),r=n.getCoordinates();if(i.equals(r[0])&&e.equals(r[1]))return n}return null}}],[{key:"constructor_",value:function(){if(this._edges=new Z,this._nodes=null,this._edgeEndList=new Z,arguments.length===0)this._nodes=new ar(new or);else if(arguments.length===1){var i=arguments[0];this._nodes=new ar(i)}}},{key:"linkResultDirectedEdges",value:function(i){for(var e=i.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}}])}(),Qa=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"sortShellsAndHoles",value:function(e,t,n){for(var r=e.iterator();r.hasNext();){var s=r.next();s.isHole()?n.add(s):t.add(s)}}},{key:"computePolygons",value:function(e){for(var t=new Z,n=e.iterator();n.hasNext();){var r=n.next().toPolygon(this._geometryFactory);t.add(r)}return t}},{key:"placeFreeHoles",value:function(e,t){for(var n=t.iterator();n.hasNext();){var r=n.next();if(r.getShell()===null){var s=i.findEdgeRingContaining(r,e);if(s===null)throw new rt("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(s)}}}},{key:"buildMinimalEdgeRings",value:function(e,t,n){for(var r=new Z,s=e.iterator();s.hasNext();){var u=s.next();if(u.getMaxNodeDegree()>2){u.linkDirectedEdgesForMinimalEdgeRings();var l=u.buildMinimalRings(),g=this.findShell(l);g!==null?(this.placePolygonHoles(g,l),t.add(g)):n.addAll(l)}else r.add(u)}return r}},{key:"buildMaximalEdgeRings",value:function(e){for(var t=new Z,n=e.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&r.getLabel().isArea()&&r.getEdgeRing()===null){var s=new $a(r,this._geometryFactory);t.add(s),s.setInResult()}}return t}},{key:"placePolygonHoles",value:function(e,t){for(var n=t.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(e)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(e){for(var t=0,n=null,r=e.iterator();r.hasNext();){var s=r.next();s.isHole()||(n=s,t++)}return ee.isTrue(t<=1,"found two shells in MinimalEdgeRing list"),n}},{key:"add",value:function(){if(arguments.length===1){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(arguments.length===2){var t=arguments[0],n=arguments[1];lr.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(t),s=new Z,u=this.buildMinimalEdgeRings(r,this._shellList,s);this.sortShellsAndHoles(u,this._shellList,s),this.placeFreeHoles(this._shellList,s)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new Z;var e=arguments[0];this._geometryFactory=e}},{key:"findEdgeRingContaining",value:function(e,t){for(var n=e.getLinearRing(),r=n.getEnvelopeInternal(),s=n.getCoordinateN(0),u=null,l=null,g=t.iterator();g.hasNext();){var d=g.next(),x=d.getLinearRing(),I=x.getEnvelopeInternal();if(!I.equals(r)&&I.contains(r)){s=Ne.ptNotInList(n.getCoordinates(),x.getCoordinates());var R=!1;gi.isInRing(s,x.getCoordinates())&&(R=!0),R&&(u===null||l.contains(I))&&(l=(u=d).getLinearRing().getEnvelopeInternal())}}return u}}])}(),hr=function(){return m(function i(){h(this,i)},[{key:"getBounds",value:function(){}}])}(),at=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[hr,B]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var i=arguments[0],e=arguments[1];this._bounds=i,this._item=e}}])}(),Pn=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"poll",value:function(){if(this.isEmpty())return null;var i=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),i}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(i){for(var e=null,t=this._items.get(i);2*i<=this._size&&((e=2*i)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(t)<0);i=e)this._items.set(i,this._items.get(e));this._items.set(i,t)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(i){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,i);i.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,i)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new Z,this._items.add(null)}}])}(),Ja=function(){return m(function i(){h(this,i)},[{key:"insert",value:function(i,e){}},{key:"remove",value:function(i,e){}},{key:"query",value:function(){}}])}(),je=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(i){ee.isTrue(this._bounds===null),this._childBoundables.add(i)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[hr,B]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new Z,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var i=arguments[0];this._level=i}}}}])}(),Mt={reverseOrder:function(){return{compare:function(i,e){return e.compareTo(i)}}},min:function(i){return Mt.sort(i),i.get(0)},sort:function(i,e){var t=i.toArray();e?_t.sort(t,e):_t.sort(t);for(var n=i.iterator(),r=0,s=t.length;r<s;r++)n.next(),n.set(t[r])},singletonList:function(i){var e=new Z;return e.add(i),e}},Ka=function(){function i(){h(this,i)}return m(i,null,[{key:"maxDistance",value:function(e,t,n,r,s,u,l,g){var d=i.distance(e,t,s,u);return d=Math.max(d,i.distance(e,t,l,g)),d=Math.max(d,i.distance(n,r,s,u)),d=Math.max(d,i.distance(n,r,l,g))}},{key:"distance",value:function(e,t,n,r){var s=n-e,u=r-t;return Math.sqrt(s*s+u*u)}},{key:"maximumDistance",value:function(e,t){var n=Math.min(e.getMinX(),t.getMinX()),r=Math.min(e.getMinY(),t.getMinY()),s=Math.max(e.getMaxX(),t.getMaxX()),u=Math.max(e.getMaxY(),t.getMaxY());return i.distance(n,r,s,u)}},{key:"minMaxDistance",value:function(e,t){var n=e.getMinX(),r=e.getMinY(),s=e.getMaxX(),u=e.getMaxY(),l=t.getMinX(),g=t.getMinY(),d=t.getMaxX(),x=t.getMaxY(),I=i.maxDistance(n,r,n,u,l,g,l,x);return I=Math.min(I,i.maxDistance(n,r,n,u,l,g,d,g)),I=Math.min(I,i.maxDistance(n,r,n,u,d,x,l,x)),I=Math.min(I,i.maxDistance(n,r,n,u,d,x,d,g)),I=Math.min(I,i.maxDistance(n,r,s,r,l,g,l,x)),I=Math.min(I,i.maxDistance(n,r,s,r,l,g,d,g)),I=Math.min(I,i.maxDistance(n,r,s,r,d,x,l,x)),I=Math.min(I,i.maxDistance(n,r,s,r,d,x,d,g)),I=Math.min(I,i.maxDistance(s,u,n,u,l,g,l,x)),I=Math.min(I,i.maxDistance(s,u,n,u,l,g,d,g)),I=Math.min(I,i.maxDistance(s,u,n,u,d,x,l,x)),I=Math.min(I,i.maxDistance(s,u,n,u,d,x,d,g)),I=Math.min(I,i.maxDistance(s,u,s,r,l,g,l,x)),I=Math.min(I,i.maxDistance(s,u,s,r,l,g,d,g)),I=Math.min(I,i.maxDistance(s,u,s,r,d,x,l,x)),I=Math.min(I,i.maxDistance(s,u,s,r,d,x,d,g))}}])}(),bt=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"maximumDistance",value:function(){return Ka.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(e,t){var n=i.isComposite(this._boundable1),r=i.isComposite(this._boundable2);if(n&&r)return i.area(this._boundable1)>i.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,e,t),null):(this.expand(this._boundable2,this._boundable1,!0,e,t),null);if(n)return this.expand(this._boundable1,this._boundable2,!1,e,t),null;if(r)return this.expand(this._boundable2,this._boundable1,!0,e,t),null;throw new F("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(i.isComposite(this._boundable1)||i.isComposite(this._boundable2))}},{key:"compareTo",value:function(e){var t=e;return this._distance<t._distance?-1:this._distance>t._distance?1:0}},{key:"expand",value:function(e,t,n,r,s){for(var u=e.getChildBoundables().iterator();u.hasNext();){var l=u.next(),g=null;(g=n?new i(t,l,this._itemDistance):new i(l,t,this._itemDistance)).getDistance()<s&&r.add(g)}}},{key:"getBoundable",value:function(e){return e===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var e=arguments[0],t=arguments[1],n=arguments[2];this._boundable1=e,this._boundable2=t,this._itemDistance=n,this._distance=this.distance()}},{key:"area",value:function(e){return e.getBounds().getArea()}},{key:"isComposite",value:function(e){return e instanceof je}}])}(),cr=function(){return m(function i(){h(this,i)},[{key:"visitItem",value:function(i){}}])}(),Pt=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"queryInternal",value:function(){if(K(arguments[2],cr)&&arguments[0]instanceof Object&&arguments[1]instanceof je)for(var e=arguments[0],t=arguments[2],n=arguments[1].getChildBoundables(),r=0;r<n.size();r++){var s=n.get(r);this.getIntersectsOp().intersects(s.getBounds(),e)&&(s instanceof je?this.queryInternal(e,s,t):s instanceof at?t.visitItem(s.getItem()):ee.shouldNeverReachHere())}else if(K(arguments[2],yt)&&arguments[0]instanceof Object&&arguments[1]instanceof je)for(var u=arguments[0],l=arguments[2],g=arguments[1].getChildBoundables(),d=0;d<g.size();d++){var x=g.get(d);this.getIntersectsOp().intersects(x.getBounds(),u)&&(x instanceof je?this.queryInternal(u,x,l):x instanceof at?l.add(x.getItem()):ee.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(e){return e.get(e.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var e=0,t=arguments[0].getChildBoundables().iterator();t.hasNext();){var n=t.next();n instanceof je?e+=this.size(n):n instanceof at&&(e+=1)}return e}}},{key:"removeItem",value:function(e,t){for(var n=null,r=e.getChildBoundables().iterator();r.hasNext();){var s=r.next();s instanceof at&&s.getItem()===t&&(n=s)}return n!==null&&(e.getChildBoundables().remove(n),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var e=this.itemsTree(this._root);return e===null?new Z:e}if(arguments.length===1){for(var t=arguments[0],n=new Z,r=t.getChildBoundables().iterator();r.hasNext();){var s=r.next();if(s instanceof je){var u=this.itemsTree(s);u!==null&&n.add(u)}else s instanceof at?n.add(s.getItem()):ee.shouldNeverReachHere()}return n.size()<=0?null:n}}},{key:"insert",value:function(e,t){ee.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new at(e,t))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var e=arguments[0],t=new Z;return this.boundablesAtLevel(e,this._root,t),t}if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2];if(ee.isTrue(n>-2),r.getLevel()===n)return s.add(r),null;for(var u=r.getChildBoundables().iterator();u.hasNext();){var l=u.next();l instanceof je?this.boundablesAtLevel(n,l,s):(ee.isTrue(l instanceof at),n===-1&&s.add(l))}return null}}},{key:"query",value:function(){if(arguments.length===1){var e=arguments[0];this.build();var t=new Z;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.queryInternal(e,this._root,t),t}if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.queryInternal(n,this._root,r)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,t)}if(arguments.length===3){var n=arguments[0],r=arguments[1],s=arguments[2],u=this.removeItem(r,s);if(u)return!0;for(var l=null,g=r.getChildBoundables().iterator();g.hasNext();){var d=g.next();if(this.getIntersectsOp().intersects(d.getBounds(),n)&&d instanceof je&&(u=this.remove(n,d,s))){l=d;break}}return l!==null&&l.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(l),u}}},{key:"createHigherLevels",value:function(e,t){ee.isTrue(!e.isEmpty());var n=this.createParentBoundables(e,t+1);return n.size()===1?n.get(0):this.createHigherLevels(n,t+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var e=0,t=arguments[0].getChildBoundables().iterator();t.hasNext();){var n=t.next();if(n instanceof je){var r=this.depth(n);r>e&&(e=r)}}return e+1}}},{key:"createParentBoundables",value:function(e,t){ee.isTrue(!e.isEmpty());var n=new Z;n.add(this.createNode(t));var r=new Z(e);Mt.sort(r,this.getComparator());for(var s=r.iterator();s.hasNext();){var u=s.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(t)),this.lastNode(n).addChildBoundable(u)}return n}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new Z,this._nodeCapacity=null,arguments.length===0)i.constructor_.call(this,i.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var e=arguments[0];ee.isTrue(e>1,"Node capacity must be greater than 1"),this._nodeCapacity=e}}},{key:"compareDoubles",value:function(e,t){return e>t?1:e<t?-1:0}}])}();Pt.IntersectsOp=function(){},Pt.DEFAULT_NODE_CAPACITY=10;var eu=function(){return m(function i(){h(this,i)},[{key:"distance",value:function(i,e){}}])}(),Ke=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"createParentBoundablesFromVerticalSlices",value:function(t,n){ee.isTrue(t.length>0);for(var r=new Z,s=0;s<t.length;s++)r.addAll(this.createParentBoundablesFromVerticalSlice(t[s],n));return r}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.nearestNeighbourK(t,Y.POSITIVE_INFINITY,n)}if(arguments.length===3){var r=arguments[0],s=arguments[2],u=arguments[1],l=new Pn;l.add(r);for(var g=new Pn;!l.isEmpty()&&u>=0;){var d=l.poll(),x=d.getDistance();if(x>=u)break;d.isLeaves()?g.size()<s?g.add(d):(g.peek().getDistance()>x&&(g.poll(),g.add(d)),u=g.peek().getDistance()):d.expandToQueue(l,u)}return e.getItems(g)}}},{key:"createNode",value:function(t){return new fr(t)}},{key:"size",value:function(){return arguments.length===0?w(e,"size",this,1).call(this):w(e,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof ge))return w(e,"insert",this,1).apply(this,arguments);var t=arguments[0],n=arguments[1];if(t.isNull())return null;w(e,"insert",this,1).call(this,t,n)}},{key:"getIntersectsOp",value:function(){return e.intersectsOp}},{key:"verticalSlices",value:function(t,n){for(var r=Math.trunc(Math.ceil(t.size()/n)),s=new Array(n).fill(null),u=t.iterator(),l=0;l<n;l++){s[l]=new Z;for(var g=0;u.hasNext()&&g<r;){var d=u.next();s[l].add(d),g++}}return s}},{key:"query",value:function(){if(arguments.length===1){var t=arguments[0];return w(e,"query",this,1).call(this,t)}if(arguments.length===2){var n=arguments[0],r=arguments[1];w(e,"query",this,1).call(this,n,r)}}},{key:"getComparator",value:function(){return e.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(t,n){return w(e,"createParentBoundables",this,1).call(this,t,n)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof ge){var t=arguments[0],n=arguments[1];return w(e,"remove",this,1).call(this,t,n)}return w(e,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?w(e,"depth",this,1).call(this):w(e,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(t,n){ee.isTrue(!t.isEmpty());var r=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),s=new Z(t);Mt.sort(s,e.xComparator);var u=this.verticalSlices(s,Math.trunc(Math.ceil(Math.sqrt(r))));return this.createParentBoundablesFromVerticalSlices(u,n)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(K(arguments[0],eu)){var t=arguments[0];if(this.isEmpty())return null;var n=new bt(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(n)}if(arguments[0]instanceof bt){var r=arguments[0],s=Y.POSITIVE_INFINITY,u=null,l=new Pn;for(l.add(r);!l.isEmpty()&&s>0;){var g=l.poll(),d=g.getDistance();if(d>=s)break;g.isLeaves()?(s=d,u=g):g.expandToQueue(l,s)}return u===null?null:[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else{if(arguments.length===2){var x=arguments[0],I=arguments[1];if(this.isEmpty()||x.isEmpty())return null;var R=new bt(this.getRoot(),x.getRoot(),I);return this.nearestNeighbour(R)}if(arguments.length===3){var b=arguments[2],z=new at(arguments[0],arguments[1]),X=new bt(this.getRoot(),z,b);return this.nearestNeighbour(X)[0]}if(arguments.length===4){var re=arguments[2],ne=arguments[3],ce=new at(arguments[0],arguments[1]),Re=new bt(this.getRoot(),ce,re);return this.nearestNeighbourK(Re,ne)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var t=arguments[0],n=arguments[1],r=Y.POSITIVE_INFINITY,s=new Pn;for(s.add(t);!s.isEmpty();){var u=s.poll(),l=u.getDistance();if(l>n)return!1;if(u.maximumDistance()<=n)return!0;if(u.isLeaves()){if((r=l)<=n)return!0}else u.expandToQueue(s,r)}return!1}if(arguments.length===3){var g=arguments[0],d=arguments[1],x=arguments[2],I=new bt(this.getRoot(),g.getRoot(),d);return this.isWithinDistance(I,x)}}},{key:"interfaces_",get:function(){return[Ja,B]}}],[{key:"constructor_",value:function(){if(arguments.length===0)e.constructor_.call(this,e.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var t=arguments[0];Pt.constructor_.call(this,t)}}},{key:"centreX",value:function(t){return e.avg(t.getMinX(),t.getMaxX())}},{key:"avg",value:function(t,n){return(t+n)/2}},{key:"getItems",value:function(t){for(var n=new Array(t.size()).fill(null),r=0;!t.isEmpty();){var s=t.poll();n[r]=s.getBoundable(0).getItem(),r++}return n}},{key:"centreY",value:function(t){return e.avg(t.getMinY(),t.getMaxY())}}])}(Pt),fr=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"computeBounds",value:function(){for(var t=null,n=this.getChildBoundables().iterator();n.hasNext();){var r=n.next();t===null?t=new ge(r.getBounds()):t.expandToInclude(r.getBounds())}return t}}],[{key:"constructor_",value:function(){var t=arguments[0];je.constructor_.call(this,t)}}])}(je);Ke.STRtreeNode=fr,Ke.xComparator=new(function(){return m(function i(){h(this,i)},[{key:"interfaces_",get:function(){return[Pe]}},{key:"compare",value:function(i,e){return Pt.compareDoubles(Ke.centreX(i.getBounds()),Ke.centreX(e.getBounds()))}}])}()),Ke.yComparator=new(function(){return m(function i(){h(this,i)},[{key:"interfaces_",get:function(){return[Pe]}},{key:"compare",value:function(i,e){return Pt.compareDoubles(Ke.centreY(i.getBounds()),Ke.centreY(e.getBounds()))}}])}()),Ke.intersectsOp=new(function(){return m(function i(){h(this,i)},[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(i,e){return i.intersects(e)}}])}()),Ke.DEFAULT_NODE_CAPACITY=10;var tu=function(){function i(){h(this,i)}return m(i,null,[{key:"relativeSign",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"compare",value:function(e,t,n){if(t.equals2D(n))return 0;var r=i.relativeSign(t.x,n.x),s=i.relativeSign(t.y,n.y);switch(e){case 0:return i.compareValue(r,s);case 1:return i.compareValue(s,r);case 2:return i.compareValue(s,-r);case 3:return i.compareValue(-r,s);case 4:return i.compareValue(-r,-s);case 5:return i.compareValue(-s,-r);case 6:return i.compareValue(-s,r);case 7:return i.compareValue(r,-s)}return ee.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(e,t){return e<0?-1:e>0?1:t<0?-1:t>0?1:0}}])}(),nu=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(i){i.print(this.coord),i.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(i){var e=i;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:this._isInterior?e._isInterior?tu.compare(this._segmentOctant,this.coord,e.coord):1:-1}},{key:"isEndPoint",value:function(i){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===i}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var i=arguments[0],e=arguments[1],t=arguments[2],n=arguments[3];this._segString=i,this.coord=new S(e),this.segmentIndex=t,this._segmentOctant=n,this._isInterior=!e.equals2D(i.getCoordinate(t))}}])}(),iu=function(){return m(function i(){h(this,i)},[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])}(),ru=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"getSplitCoordinates",value:function(){var i=new tn;this.addEndpoints();for(var e=this.iterator(),t=e.next();e.hasNext();){var n=e.next();this.addEdgeCoordinates(t,n,i),t=n}return i.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var i=new Z;this.findCollapsesFromInsertedNodes(i),this.findCollapsesFromExistingVertices(i);for(var e=i.iterator();e.hasNext();){var t=e.next().intValue();this.add(this._edge.getCoordinate(t),t)}}},{key:"createSplitEdgePts",value:function(i,e){var t=e.segmentIndex-i.segmentIndex+2;if(t===2)return[new S(i.coord),new S(e.coord)];var n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);r||t--;var s=new Array(t).fill(null),u=0;s[u++]=new S(i.coord);for(var l=i.segmentIndex+1;l<=e.segmentIndex;l++)s[u++]=this._edge.getCoordinate(l);return r&&(s[u]=new S(e.coord)),s}},{key:"print",value:function(i){i.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(i)}},{key:"findCollapsesFromExistingVertices",value:function(i){for(var e=0;e<this._edge.size()-2;e++){var t=this._edge.getCoordinate(e);this._edge.getCoordinate(e+1);var n=this._edge.getCoordinate(e+2);t.equals2D(n)&&i.add(In.valueOf(e+1))}}},{key:"addEdgeCoordinates",value:function(i,e,t){var n=this.createSplitEdgePts(i,e);t.add(n,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(i){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),t=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(t,n);i.add(r),t=n}}},{key:"findCollapseIndex",value:function(i,e,t){if(!i.coord.equals2D(e.coord))return!1;var n=e.segmentIndex-i.segmentIndex;return e.isInterior()||n--,n===1&&(t[0]=i.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(i){for(var e=new Array(1).fill(null),t=this.iterator(),n=t.next();t.hasNext();){var r=t.next();this.findCollapseIndex(n,r,e)&&i.add(In.valueOf(e[0])),n=r}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var i=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(i),i)}},{key:"createSplitEdge",value:function(i,e){var t=this.createSplitEdgePts(i,e);return new Nt(t,this._edge.getData())}},{key:"add",value:function(i,e){var t=new nu(this._edge,i,e,this._edge.getSegmentOctant(e)),n=this._nodeMap.get(t);return n!==null?(ee.isTrue(n.coord.equals2D(i),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(t,t),t)}},{key:"checkSplitEdgesCorrectness",value:function(i){var e=this._edge.getCoordinates(),t=i.get(0).getCoordinate(0);if(!t.equals2D(e[0]))throw new Ce("bad split edge start point at "+t);var n=i.get(i.size()-1).getCoordinates(),r=n[n.length-1];if(!r.equals2D(e[e.length-1]))throw new Ce("bad split edge end point at "+r)}}],[{key:"constructor_",value:function(){this._nodeMap=new sn,this._edge=null;var i=arguments[0];this._edge=i}}])}(),su=function(){function i(){h(this,i)}return m(i,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new F("Cannot compute the octant for point ( "+e+", "+t+" )");var n=Math.abs(e),r=Math.abs(t);return e>=0?t>=0?n>=r?0:1:n>=r?7:6:t>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof S&&arguments[1]instanceof S){var s=arguments[0],u=arguments[1],l=u.x-s.x,g=u.y-s.y;if(l===0&&g===0)throw new F("Cannot compute the octant for two identical points "+s);return i.octant(l,g)}}}])}(),au=function(){return m(function i(){h(this,i)},[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(i){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(i){}},{key:"getData",value:function(){}}])}(),uu=function(){return m(function i(){h(this,i)},[{key:"addIntersection",value:function(i,e){}},{key:"interfaces_",get:function(){return[au]}}])}(),Nt=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(e){return this._pts[e]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))}},{key:"setData",value:function(e){this._data=e}},{key:"safeOctant",value:function(e,t){return e.equals2D(t)?0:su.octant(e,t)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.addIntersectionNode(e,t)}else if(arguments.length===4){var n=arguments[1],r=arguments[3],s=new S(arguments[0].getIntersection(r));this.addIntersection(s,n)}}},{key:"toString",value:function(){return fi.toLineString(new nn(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(e,t){var n=t,r=n+1;if(r<this._pts.length){var s=this._pts[r];e.equals2D(s)&&(n=r)}return this._nodeList.add(e,n)}},{key:"addIntersections",value:function(e,t,n){for(var r=0;r<e.getIntersectionNum();r++)this.addIntersection(e,t,n,r)}},{key:"interfaces_",get:function(){return[uu]}}],[{key:"constructor_",value:function(){this._nodeList=new ru(this),this._pts=null,this._data=null;var e=arguments[0],t=arguments[1];this._pts=e,this._data=t}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var e=arguments[0],t=new Z;return i.getNodedSubstrings(e,t),t}if(arguments.length===2)for(var n=arguments[1],r=arguments[0].iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(n)}}])}(),Ge=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof i){var e=arguments[0],t=J.index(this.p0,this.p1,e.p0),n=J.index(this.p0,this.p1,e.p1);return t>=0&&n>=0||t<=0&&n<=0?Math.max(t,n):0}if(arguments[0]instanceof S){var r=arguments[0];return J.index(this.p0,this.p1,r)}}},{key:"toGeometry",value:function(e){return e.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(e){if(!(e instanceof i))return!1;var t=e;return this.p0.equals(t.p0)&&this.p1.equals(t.p1)}},{key:"intersection",value:function(e){var t=new Et;return t.computeIntersection(this.p0,this.p1,e.p0,e.p1),t.hasIntersection()?t.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof S){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new S(e);var t=this.projectionFactor(e),n=new S;return n.x=this.p0.x+t*(this.p1.x-this.p0.x),n.y=this.p0.y+t*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof i){var r=arguments[0],s=this.projectionFactor(r.p0),u=this.projectionFactor(r.p1);if(s>=1&&u>=1||s<=0&&u<=0)return null;var l=this.project(r.p0);s<0&&(l=this.p0),s>1&&(l=this.p1);var g=this.project(r.p1);return u<0&&(g=this.p0),u>1&&(g=this.p1),new i(l,g)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(e){return e===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(e){return Qe.pointToLinePerpendicular(e,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return i.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var t=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=t*t+n*n;return r<=0?Y.NaN:((e.x-this.p0.x)*t+(e.y-this.p0.y)*n)/r}},{key:"closestPoints",value:function(e){var t=this.intersection(e);if(t!==null)return[t,t];var n=new Array(2).fill(null),r=Y.MAX_VALUE,s=null,u=this.closestPoint(e.p0);r=u.distance(e.p0),n[0]=u,n[1]=e.p0;var l=this.closestPoint(e.p1);(s=l.distance(e.p1))<r&&(r=s,n[0]=l,n[1]=e.p1);var g=e.closestPoint(this.p0);(s=g.distance(this.p0))<r&&(r=s,n[0]=this.p0,n[1]=g);var d=e.closestPoint(this.p1);return(s=d.distance(this.p1))<r&&(r=s,n[0]=this.p1,n[1]=d),n}},{key:"closestPoint",value:function(e){var t=this.projectionFactor(e);return t>0&&t<1?this.project(e):this.p0.distance(e)<this.p1.distance(e)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(e){var t=e,n=this.p0.compareTo(t.p0);return n!==0?n:this.p1.compareTo(t.p1)}},{key:"reverse",value:function(){var e=this.p0;this.p0=this.p1,this.p1=e}},{key:"equalsTopo",value:function(e){return this.p0.equals(e.p0)&&this.p1.equals(e.p1)||this.p0.equals(e.p1)&&this.p1.equals(e.p0)}},{key:"lineIntersection",value:function(e){return ri.intersection(this.p0,this.p1,e.p0,e.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(e,t){var n=this.p0.x+e*(this.p1.x-this.p0.x),r=this.p0.y+e*(this.p1.y-this.p0.y),s=this.p1.x-this.p0.x,u=this.p1.y-this.p0.y,l=Math.sqrt(s*s+u*u),g=0,d=0;if(t!==0){if(l<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");g=t*s/l,d=t*u/l}return new S(n-d,r+g)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=n.x,this.p1.y=n.y}}},{key:"segmentFraction",value:function(e){var t=this.projectionFactor(e);return t<0?t=0:(t>1||Y.isNaN(t))&&(t=1),t}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(e){var t=this.p1.getY()-this.p0.getY(),n=this.p0.getX()-this.p1.getX(),r=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),s=t*t+n*n,u=t*t-n*n,l=e.getX(),g=e.getY();return new S((-u*l-2*t*n*g-2*t*r)/s,(u*g-2*t*n*l-2*n*r)/s)}},{key:"distance",value:function(){if(arguments[0]instanceof i){var e=arguments[0];return Qe.segmentToSegment(this.p0,this.p1,e.p0,e.p1)}if(arguments[0]instanceof S){var t=arguments[0];return Qe.pointToSegment(t,this.p0,this.p1)}}},{key:"pointAlong",value:function(e){var t=new S;return t.x=this.p0.x+e*(this.p1.x-this.p0.x),t.y=this.p0.y+e*(this.p1.y-this.p0.y),t}},{key:"hashCode",value:function(){var e=Y.doubleToLongBits(this.p0.x);e^=31*Y.doubleToLongBits(this.p0.y);var t=Math.trunc(e)^Math.trunc(e>>32),n=Y.doubleToLongBits(this.p1.x);return n^=31*Y.doubleToLongBits(this.p1.y),t^(Math.trunc(n)^Math.trunc(n>>32))}},{key:"interfaces_",get:function(){return[j,B]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)i.constructor_.call(this,new S,new S);else if(arguments.length===1){var e=arguments[0];i.constructor_.call(this,e.p0,e.p1)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.p0=t,this.p1=n}else if(arguments.length===4){var r=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3];i.constructor_.call(this,new S(r,s),new S(u,l))}}},{key:"midPoint",value:function(e,t){return new S((e.x+t.x)/2,(e.y+t.y)/2)}}])}(),ou=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var i=arguments[1],e=arguments[2],t=arguments[3];arguments[0].getLineSegment(i,this._overlapSeg1),e.getLineSegment(t,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Ge,this._overlapSeg2=new Ge}}])}(),gr=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"getLineSegment",value:function(i,e){e.p0=this._pts[i],e.p1=this._pts[i+1]}},{key:"computeSelect",value:function(i,e,t,n){var r=this._pts[e],s=this._pts[t];if(t-e==1)return n.select(this,e),null;if(!i.intersects(r,s))return null;var u=Math.trunc((e+t)/2);e<u&&this.computeSelect(i,e,u,n),u<t&&this.computeSelect(i,u,t,n)}},{key:"getCoordinates",value:function(){for(var i=new Array(this._end-this._start+1).fill(null),e=0,t=this._start;t<=this._end;t++)i[e++]=this._pts[t];return i}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var i=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,i,i._start,i._end,e)}else if(arguments.length===6){var t=arguments[0],n=arguments[1],r=arguments[2],s=arguments[3],u=arguments[4],l=arguments[5];if(n-t==1&&u-s==1)return l.overlap(this,t,r,s),null;if(!this.overlaps(t,n,r,s,u))return null;var g=Math.trunc((t+n)/2),d=Math.trunc((s+u)/2);t<g&&(s<d&&this.computeOverlaps(t,g,r,s,d,l),d<u&&this.computeOverlaps(t,g,r,d,u,l)),g<n&&(s<d&&this.computeOverlaps(g,n,r,s,d,l),d<u&&this.computeOverlaps(g,n,r,d,u,l))}}},{key:"setId",value:function(i){this._id=i}},{key:"select",value:function(i,e){this.computeSelect(i,this._start,this._end,e)}},{key:"getEnvelope",value:function(){if(this._env===null){var i=this._pts[this._start],e=this._pts[this._end];this._env=new ge(i,e)}return this._env}},{key:"overlaps",value:function(i,e,t,n,r){return ge.intersects(this._pts[i],this._pts[e],t._pts[n],t._pts[r])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var i=arguments[0],e=arguments[1],t=arguments[2],n=arguments[3];this._pts=i,this._start=e,this._end=t,this._context=n}}])}(),lu=function(){function i(){h(this,i)}return m(i,null,[{key:"findChainEnd",value:function(e,t){for(var n=t;n<e.length-1&&e[n].equals2D(e[n+1]);)n++;if(n>=e.length-1)return e.length-1;for(var r=Ae.quadrant(e[n],e[n+1]),s=t+1;s<e.length&&!(!e[s-1].equals2D(e[s])&&Ae.quadrant(e[s-1],e[s])!==r);)s++;return s-1}},{key:"getChains",value:function(){if(arguments.length===1){var e=arguments[0];return i.getChains(e,null)}if(arguments.length===2){var t=arguments[0],n=arguments[1],r=new Z,s=0;do{var u=i.findChainEnd(t,s),l=new gr(t,s,u,n);r.add(l),s=u}while(s<t.length-1);return r}}}])}(),vi=function(){return m(function i(){h(this,i)},[{key:"computeNodes",value:function(i){}},{key:"getNodedSubstrings",value:function(){}}])}(),mr=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"setSegmentIntersector",value:function(i){this._segInt=i}},{key:"interfaces_",get:function(){return[vi]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var i=arguments[0];this.setSegmentIntersector(i)}}}}])}(),yi=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Nt.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(t){for(var n=lu.getChains(t.getCoordinates(),t).iterator();n.hasNext();){var r=n.next();r.setId(this._idCounter++),this._index.insert(r.getEnvelope(),r),this._monoChains.add(r)}}},{key:"computeNodes",value:function(t){this._nodedSegStrings=t;for(var n=t.iterator();n.hasNext();)this.add(n.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var t=new dr(this._segInt),n=this._monoChains.iterator();n.hasNext();)for(var r=n.next(),s=this._index.query(r.getEnvelope()).iterator();s.hasNext();){var u=s.next();if(u.getId()>r.getId()&&(r.computeOverlaps(u,t),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new Z,this._index=new Ke,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var t=arguments[0];mr.constructor_.call(this,t)}}}}])}(mr),dr=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"overlap",value:function(){if(arguments.length!==4)return w(e,"overlap",this,1).apply(this,arguments);var t=arguments[1],n=arguments[2],r=arguments[3],s=arguments[0].getContext(),u=n.getContext();this._si.processIntersections(s,t,u,r)}}],[{key:"constructor_",value:function(){this._si=null;var t=arguments[0];this._si=t}}])}(ou);yi.SegmentOverlapAction=dr;var Ze=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"isDeletable",value:function(e,t,n,r){var s=this._inputLine[e],u=this._inputLine[t],l=this._inputLine[n];return!!this.isConcave(s,u,l)&&!!this.isShallow(s,u,l,r)&&this.isShallowSampled(s,u,e,n,r)}},{key:"deleteShallowConcavities",value:function(){for(var e=1,t=this.findNextNonDeletedIndex(e),n=this.findNextNonDeletedIndex(t),r=!1;n<this._inputLine.length;){var s=!1;this.isDeletable(e,t,n,this._distanceTol)&&(this._isDeleted[t]=i.DELETE,s=!0,r=!0),e=s?n:t,t=this.findNextNonDeletedIndex(e),n=this.findNextNonDeletedIndex(t)}return r}},{key:"isShallowConcavity",value:function(e,t,n,r){return J.index(e,t,n)===this._angleOrientation&&Qe.pointToSegment(t,e,n)<r}},{key:"isShallowSampled",value:function(e,t,n,r,s){var u=Math.trunc((r-n)/i.NUM_PTS_TO_CHECK);u<=0&&(u=1);for(var l=n;l<r;l+=u)if(!this.isShallow(e,t,this._inputLine[l],s))return!1;return!0}},{key:"isConcave",value:function(e,t,n){var r=J.index(e,t,n)===this._angleOrientation;return r}},{key:"simplify",value:function(e){this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=J.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var t=!1;do t=this.deleteShallowConcavities();while(t);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(e){for(var t=e+1;t<this._inputLine.length&&this._isDeleted[t]===i.DELETE;)t++;return t}},{key:"isShallow",value:function(e,t,n,r){return Qe.pointToSegment(t,e,n)<r}},{key:"collapseLine",value:function(){for(var e=new tn,t=0;t<this._inputLine.length;t++)this._isDeleted[t]!==i.DELETE&&e.add(this._inputLine[t]);return e.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=J.COUNTERCLOCKWISE;var e=arguments[0];this._inputLine=e}},{key:"simplify",value:function(e,t){return new i(e).simplify(t)}}])}();Ze.INIT=0,Ze.DELETE=1,Ze.KEEP=1,Ze.NUM_PTS_TO_CHECK=10;var vr=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getCoordinates",value:function(){return this._ptList.toArray(i.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"addPt",value:function(e){var t=new S(e);if(this._precisionModel.makePrecise(t),this.isRedundant(t))return null;this._ptList.add(t)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(e,t){if(t)for(var n=0;n<e.length;n++)this.addPt(e[n]);else for(var r=e.length-1;r>=0;r--)this.addPt(e[r])}},{key:"isRedundant",value:function(e){if(this._ptList.size()<1)return!1;var t=this._ptList.get(this._ptList.size()-1);return e.distance(t)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Rt().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var e=new S(this._ptList.get(0)),t=this._ptList.get(this._ptList.size()-1);if(e.equals(t))return null;this._ptList.add(e)}},{key:"setMinimumVertexDistance",value:function(e){this._minimimVertexDistance=e}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Z}}])}();vr.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var ze=function(){function i(){h(this,i)}return m(i,null,[{key:"toDegrees",value:function(e){return 180*e/Math.PI}},{key:"normalize",value:function(e){for(;e>Math.PI;)e-=i.PI_TIMES_2;for(;e<=-Math.PI;)e+=i.PI_TIMES_2;return e}},{key:"angle",value:function(){if(arguments.length===1){var e=arguments[0];return Math.atan2(e.y,e.x)}if(arguments.length===2){var t=arguments[0],n=arguments[1],r=n.x-t.x,s=n.y-t.y;return Math.atan2(s,r)}}},{key:"isAcute",value:function(e,t,n){var r=e.x-t.x,s=e.y-t.y;return r*(n.x-t.x)+s*(n.y-t.y)>0}},{key:"isObtuse",value:function(e,t,n){var r=e.x-t.x,s=e.y-t.y;return r*(n.x-t.x)+s*(n.y-t.y)<0}},{key:"interiorAngle",value:function(e,t,n){var r=i.angle(t,e),s=i.angle(t,n);return Math.abs(s-r)}},{key:"normalizePositive",value:function(e){if(e<0){for(;e<0;)e+=i.PI_TIMES_2;e>=i.PI_TIMES_2&&(e=0)}else{for(;e>=i.PI_TIMES_2;)e-=i.PI_TIMES_2;e<0&&(e=0)}return e}},{key:"angleBetween",value:function(e,t,n){var r=i.angle(t,e),s=i.angle(t,n);return i.diff(r,s)}},{key:"diff",value:function(e,t){var n=null;return(n=e<t?t-e:e-t)>Math.PI&&(n=2*Math.PI-n),n}},{key:"toRadians",value:function(e){return e*Math.PI/180}},{key:"getTurn",value:function(e,t){var n=Math.sin(t-e);return n>0?i.COUNTERCLOCKWISE:n<0?i.CLOCKWISE:i.NONE}},{key:"angleBetweenOriented",value:function(e,t,n){var r=i.angle(t,e),s=i.angle(t,n)-r;return s<=-Math.PI?s+i.PI_TIMES_2:s>Math.PI?s-i.PI_TIMES_2:s}}])}();ze.PI_TIMES_2=2*Math.PI,ze.PI_OVER_2=Math.PI/2,ze.PI_OVER_4=Math.PI/4,ze.COUNTERCLOCKWISE=J.COUNTERCLOCKWISE,ze.CLOCKWISE=J.CLOCKWISE,ze.NONE=J.COLLINEAR;var an=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"addNextSegment",value:function(e,t){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=J.index(this._s0,this._s1,this._s2),r=n===J.CLOCKWISE&&this._side===O.LEFT||n===J.COUNTERCLOCKWISE&&this._side===O.RIGHT;n===0?this.addCollinear(t):r?this.addOutsideTurn(n,t):this.addInsideTurn(n,t)}},{key:"addLineEndCap",value:function(e,t){var n=new Ge(e,t),r=new Ge;this.computeOffsetSegment(n,O.LEFT,this._distance,r);var s=new Ge;this.computeOffsetSegment(n,O.RIGHT,this._distance,s);var u=t.x-e.x,l=t.y-e.y,g=Math.atan2(l,u);switch(this._bufParams.getEndCapStyle()){case A.CAP_ROUND:this._segList.addPt(r.p1),this.addDirectedFillet(t,g+Math.PI/2,g-Math.PI/2,J.CLOCKWISE,this._distance),this._segList.addPt(s.p1);break;case A.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(s.p1);break;case A.CAP_SQUARE:var d=new S;d.x=Math.abs(this._distance)*Math.cos(g),d.y=Math.abs(this._distance)*Math.sin(g);var x=new S(r.p1.x+d.x,r.p1.y+d.y),I=new S(s.p1.x+d.x,s.p1.y+d.y);this._segList.addPt(x),this._segList.addPt(I)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(e,t,n,r){var s=ri.intersection(t.p0,t.p1,n.p0,n.p1);if(s!==null&&(r<=0?1:s.distance(e)/Math.abs(r))<=this._bufParams.getMitreLimit())return this._segList.addPt(s),null;this.addLimitedMitreJoin(t,n,r,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(e,t){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*i.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===A.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===A.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(t&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(e){this._segList.addPt(new S(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new S(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new S(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new S(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(e,t){this._segList.addPts(e,t)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(e,t,n,r,s){var u=t.x-e.x,l=t.y-e.y,g=Math.atan2(l,u),d=n.x-e.x,x=n.y-e.y,I=Math.atan2(x,d);r===J.CLOCKWISE?g<=I&&(g+=2*Math.PI):g>=I&&(g-=2*Math.PI),this._segList.addPt(t),this.addDirectedFillet(e,g,I,r,s),this._segList.addPt(n)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(e,t,n){this._s1=e,this._s2=t,this._side=n,this._seg1.setCoordinates(e,t),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(e,t,n,r){var s=this._seg0.p1,u=ze.angle(s,this._seg0.p0),l=ze.angleBetweenOriented(this._seg0.p0,s,this._seg1.p1)/2,g=ze.normalize(u+l),d=ze.normalize(g+Math.PI),x=r*n,I=n-x*Math.abs(Math.sin(l)),R=s.x+x*Math.cos(d),b=s.y+x*Math.sin(d),z=new S(R,b),X=new Ge(s,z),re=X.pointAlongOffset(1,I),ne=X.pointAlongOffset(1,-I);this._side===O.LEFT?(this._segList.addPt(re),this._segList.addPt(ne)):(this._segList.addPt(ne),this._segList.addPt(re))}},{key:"addDirectedFillet",value:function(e,t,n,r,s){var u=r===J.CLOCKWISE?-1:1,l=Math.abs(t-n),g=Math.trunc(l/this._filletAngleQuantum+.5);if(g<1)return null;for(var d=l/g,x=new S,I=0;I<g;I++){var R=t+u*I*d;x.x=e.x+s*Math.cos(R),x.y=e.y+s*Math.sin(R),this._segList.addPt(x)}}},{key:"computeOffsetSegment",value:function(e,t,n,r){var s=t===O.LEFT?1:-1,u=e.p1.x-e.p0.x,l=e.p1.y-e.p0.y,g=Math.sqrt(u*u+l*l),d=s*n*u/g,x=s*n*l/g;r.p0.x=e.p0.x-x,r.p0.y=e.p0.y+d,r.p1.x=e.p1.x-x,r.p1.y=e.p1.y+d}},{key:"addInsideTurn",value:function(e,t){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*i.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new S((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var r=new S((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(e){var t=new S(e.x+this._distance,e.y);this._segList.addPt(t),this.addDirectedFillet(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(e,t){this._segList.addPt(e.p1),this._segList.addPt(t.p0)}},{key:"init",value:function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new vr,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*i.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===A.JOIN_BEVEL||this._bufParams.getJoinStyle()===A.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,J.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Ge,this._seg1=new Ge,this._offset0=new Ge,this._offset1=new Ge,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],t=arguments[1],n=arguments[2];this._precisionModel=e,this._bufParams=t,this._li=new Et,this._filletAngleQuantum=Math.PI/2/t.getQuadrantSegments(),t.getQuadrantSegments()>=8&&t.getJoinStyle()===A.JOIN_ROUND&&(this._closingSegLengthFactor=i.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}}])}();an.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,an.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,an.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,an.MAX_CLOSING_SEG_LEN_FACTOR=80;var hu=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getOffsetCurve",value:function(e,t){if(this._distance=t,t===0)return null;var n=t<0,r=Math.abs(t),s=this.getSegGen(r);e.length<=1?this.computePointCurve(e[0],s):this.computeOffsetCurve(e,n,s);var u=s.getCoordinates();return n&&Ne.reverse(u),u}},{key:"computeSingleSidedBufferCurve",value:function(e,t,n){var r=this.simplifyTolerance(this._distance);if(t){n.addSegments(e,!0);var s=Ze.simplify(e,-r),u=s.length-1;n.initSideSegments(s[u],s[u-1],O.LEFT),n.addFirstSegment();for(var l=u-2;l>=0;l--)n.addNextSegment(s[l],!0)}else{n.addSegments(e,!1);var g=Ze.simplify(e,r),d=g.length-1;n.initSideSegments(g[0],g[1],O.LEFT),n.addFirstSegment();for(var x=2;x<=d;x++)n.addNextSegment(g[x],!0)}n.addLastSegment(),n.closeRing()}},{key:"computeRingBufferCurve",value:function(e,t,n){var r=this.simplifyTolerance(this._distance);t===O.RIGHT&&(r=-r);var s=Ze.simplify(e,r),u=s.length-1;n.initSideSegments(s[u-1],s[0],t);for(var l=1;l<=u;l++){var g=l!==1;n.addNextSegment(s[l],g)}n.closeRing()}},{key:"computeLineBufferCurve",value:function(e,t){var n=this.simplifyTolerance(this._distance),r=Ze.simplify(e,n),s=r.length-1;t.initSideSegments(r[0],r[1],O.LEFT);for(var u=2;u<=s;u++)t.addNextSegment(r[u],!0);t.addLastSegment(),t.addLineEndCap(r[s-1],r[s]);var l=Ze.simplify(e,-n),g=l.length-1;t.initSideSegments(l[g],l[g-1],O.LEFT);for(var d=g-2;d>=0;d--)t.addNextSegment(l[d],!0);t.addLastSegment(),t.addLineEndCap(l[1],l[0]),t.closeRing()}},{key:"computePointCurve",value:function(e,t){switch(this._bufParams.getEndCapStyle()){case A.CAP_ROUND:t.createCircle(e);break;case A.CAP_SQUARE:t.createSquare(e)}}},{key:"getLineCurve",value:function(e,t){if(this._distance=t,this.isLineOffsetEmpty(t))return null;var n=Math.abs(t),r=this.getSegGen(n);if(e.length<=1)this.computePointCurve(e[0],r);else if(this._bufParams.isSingleSided()){var s=t<0;this.computeSingleSidedBufferCurve(e,s,r)}else this.computeLineBufferCurve(e,r);return r.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(e){return e*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(e,t,n){if(this._distance=n,e.length<=2)return this.getLineCurve(e,n);if(n===0)return i.copyCoordinates(e);var r=this.getSegGen(n);return this.computeRingBufferCurve(e,t,r),r.getCoordinates()}},{key:"computeOffsetCurve",value:function(e,t,n){var r=this.simplifyTolerance(this._distance);if(t){var s=Ze.simplify(e,-r),u=s.length-1;n.initSideSegments(s[u],s[u-1],O.LEFT),n.addFirstSegment();for(var l=u-2;l>=0;l--)n.addNextSegment(s[l],!0)}else{var g=Ze.simplify(e,r),d=g.length-1;n.initSideSegments(g[0],g[1],O.LEFT),n.addFirstSegment();for(var x=2;x<=d;x++)n.addNextSegment(g[x],!0)}n.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(e){return e===0||e<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(e){return new an(this._precisionModel,this._bufParams,e)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var e=arguments[0],t=arguments[1];this._precisionModel=e,this._bufParams=t}},{key:"copyCoordinates",value:function(e){for(var t=new Array(e.length).fill(null),n=0;n<t.length;n++)t[n]=new S(e[n]);return t}}])}(),yr=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var i=arguments[0],e=new Z,t=this._subgraphs.iterator();t.hasNext();){var n=t.next(),r=n.getEnvelope();i.y<r.getMinY()||i.y>r.getMaxY()||this.findStabbedSegments(i,n.getDirectedEdges(),e)}return e}if(arguments.length===3){if(K(arguments[2],yt)&&arguments[0]instanceof S&&arguments[1]instanceof di){for(var s=arguments[0],u=arguments[1],l=arguments[2],g=u.getEdge().getCoordinates(),d=0;d<g.length-1;d++)if(this._seg.p0=g[d],this._seg.p1=g[d+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<s.x||this._seg.isHorizontal()||s.y<this._seg.p0.y||s.y>this._seg.p1.y||J.index(this._seg.p0,this._seg.p1,s)===J.RIGHT)){var x=u.getDepth(O.LEFT);this._seg.p0.equals(g[d])||(x=u.getDepth(O.RIGHT));var I=new pr(this._seg,x);l.add(I)}}else if(K(arguments[2],yt)&&arguments[0]instanceof S&&K(arguments[1],yt))for(var R=arguments[0],b=arguments[2],z=arguments[1].iterator();z.hasNext();){var X=z.next();X.isForward()&&this.findStabbedSegments(R,X,b)}}}},{key:"getDepth",value:function(i){var e=this.findStabbedSegments(i);return e.size()===0?0:Mt.min(e)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Ge;var i=arguments[0];this._subgraphs=i}}])}(),pr=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"compareTo",value:function(i){var e=i;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var t=this._upwardSeg.orientationIndex(e._upwardSeg);return t!==0||(t=-1*e._upwardSeg.orientationIndex(this._upwardSeg))!==0?t:this._upwardSeg.compareTo(e._upwardSeg)}},{key:"compareX",value:function(i,e){var t=i.p0.compareTo(e.p0);return t!==0?t:i.p1.compareTo(e.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var i=arguments[0],e=arguments[1];this._upwardSeg=new Ge(i),this._leftDepth=e}}])}();yr.DepthSegment=pr;var _r=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,null,[{key:"constructor_",value:function(){V.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])}(V),pi=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getY",value:function(){var e=this.y/this.w;if(Y.isNaN(e)||Y.isInfinite(e))throw new _r;return e}},{key:"getX",value:function(){var e=this.x/this.w;if(Y.isNaN(e)||Y.isInfinite(e))throw new _r;return e}},{key:"getCoordinate",value:function(){var e=new S;return e.x=this.getX(),e.y=this.getY(),e}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];this.x=t,this.y=n,this.w=1}else if(arguments[0]instanceof i&&arguments[1]instanceof i){var r=arguments[0],s=arguments[1];this.x=r.y*s.w-s.y*r.w,this.y=s.x*r.w-r.x*s.w,this.w=r.x*s.y-s.x*r.y}else if(arguments[0]instanceof S&&arguments[1]instanceof S){var u=arguments[0],l=arguments[1];this.x=u.y-l.y,this.y=l.x-u.x,this.w=u.x*l.y-l.x*u.y}}else if(arguments.length===3){var g=arguments[0],d=arguments[1],x=arguments[2];this.x=g,this.y=d,this.w=x}else if(arguments.length===4){var I=arguments[0],R=arguments[1],b=arguments[2],z=arguments[3],X=I.y-R.y,re=R.x-I.x,ne=I.x*R.y-R.x*I.y,ce=b.y-z.y,Re=z.x-b.x,be=b.x*z.y-z.x*b.y;this.x=re*be-Re*ne,this.y=ce*ne-X*be,this.w=X*Re-ce*re}}}])}(),cu=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"area",value:function(){return i.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return i.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(e){if(e===null)throw new F("Supplied point is null.");return i.interpolateZ(e,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return i.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return i.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return i.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return i.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return i.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return i.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var e=arguments[0],t=arguments[1],n=arguments[2];this.p0=e,this.p1=t,this.p2=n}},{key:"area",value:function(e,t,n){return Math.abs(((n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y))/2)}},{key:"signedArea",value:function(e,t,n){return((n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y))/2}},{key:"det",value:function(e,t,n,r){return e*r-t*n}},{key:"interpolateZ",value:function(e,t,n,r){var s=t.x,u=t.y,l=n.x-s,g=r.x-s,d=n.y-u,x=r.y-u,I=l*x-g*d,R=e.x-s,b=e.y-u,z=(x*R-g*b)/I,X=(-d*R+l*b)/I;return t.getZ()+z*(n.getZ()-t.getZ())+X*(r.getZ()-t.getZ())}},{key:"longestSideLength",value:function(e,t,n){var r=e.distance(t),s=t.distance(n),u=n.distance(e),l=r;return s>l&&(l=s),u>l&&(l=u),l}},{key:"circumcentreDD",value:function(e,t,n){var r=W.valueOf(e.x).subtract(n.x),s=W.valueOf(e.y).subtract(n.y),u=W.valueOf(t.x).subtract(n.x),l=W.valueOf(t.y).subtract(n.y),g=W.determinant(r,s,u,l).multiply(2),d=r.sqr().add(s.sqr()),x=u.sqr().add(l.sqr()),I=W.determinant(s,d,l,x),R=W.determinant(r,d,u,x),b=W.valueOf(n.x).subtract(I.divide(g)).doubleValue(),z=W.valueOf(n.y).add(R.divide(g)).doubleValue();return new S(b,z)}},{key:"isAcute",value:function(e,t,n){return!!ze.isAcute(e,t,n)&&!!ze.isAcute(t,n,e)&&!!ze.isAcute(n,e,t)}},{key:"circumcentre",value:function(e,t,n){var r=n.x,s=n.y,u=e.x-r,l=e.y-s,g=t.x-r,d=t.y-s,x=2*i.det(u,l,g,d),I=i.det(l,u*u+l*l,d,g*g+d*d),R=i.det(u,u*u+l*l,g,g*g+d*d);return new S(r-I/x,s+R/x)}},{key:"perpendicularBisector",value:function(e,t){var n=t.x-e.x,r=t.y-e.y,s=new pi(e.x+n/2,e.y+r/2,1),u=new pi(e.x-r+n/2,e.y+n+r/2,1);return new pi(s,u)}},{key:"angleBisector",value:function(e,t,n){var r=t.distance(e),s=r/(r+t.distance(n)),u=n.x-e.x,l=n.y-e.y;return new S(e.x+s*u,e.y+s*l)}},{key:"area3D",value:function(e,t,n){var r=t.x-e.x,s=t.y-e.y,u=t.getZ()-e.getZ(),l=n.x-e.x,g=n.y-e.y,d=n.getZ()-e.getZ(),x=s*d-u*g,I=u*l-r*d,R=r*g-s*l,b=x*x+I*I+R*R,z=Math.sqrt(b)/2;return z}},{key:"centroid",value:function(e,t,n){var r=(e.x+t.x+n.x)/3,s=(e.y+t.y+n.y)/3;return new S(r,s)}},{key:"inCentre",value:function(e,t,n){var r=t.distance(n),s=e.distance(n),u=e.distance(t),l=r+s+u,g=(r*e.x+s*t.x+u*n.x)/l,d=(r*e.y+s*t.y+u*n.y)/l;return new S(g,d)}}])}(),fu=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"addRingSide",value:function(i,e,t,n,r){if(e===0&&i.length<en.MINIMUM_VALID_SIZE)return null;var s=n,u=r;i.length>=en.MINIMUM_VALID_SIZE&&J.isCCW(i)&&(s=r,u=n,t=O.opposite(t));var l=this._curveBuilder.getRingCurve(i,t,e);this.addCurve(l,s,u)}},{key:"addRingBothSides",value:function(i,e){this.addRingSide(i,e,O.LEFT,v.EXTERIOR,v.INTERIOR),this.addRingSide(i,e,O.RIGHT,v.INTERIOR,v.EXTERIOR)}},{key:"addPoint",value:function(i){if(this._distance<=0)return null;var e=i.getCoordinates(),t=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(t,v.EXTERIOR,v.INTERIOR)}},{key:"addPolygon",value:function(i){var e=this._distance,t=O.LEFT;this._distance<0&&(e=-this._distance,t=O.RIGHT);var n=i.getExteriorRing(),r=Ne.removeRepeatedPoints(n.getCoordinates());if(this._distance<0&&this.isErodedCompletely(n,this._distance)||this._distance<=0&&r.length<3)return null;this.addRingSide(r,e,t,v.EXTERIOR,v.INTERIOR);for(var s=0;s<i.getNumInteriorRing();s++){var u=i.getInteriorRingN(s),l=Ne.removeRepeatedPoints(u.getCoordinates());this._distance>0&&this.isErodedCompletely(u,-this._distance)||this.addRingSide(l,e,O.opposite(t),v.INTERIOR,v.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(i,e){var t=new cu(i[0],i[1],i[2]),n=t.inCentre();return Qe.pointToSegment(n,t.p0,t.p1)<Math.abs(e)}},{key:"addLineString",value:function(i){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var e=Ne.removeRepeatedPoints(i.getCoordinates());if(Ne.isRing(e)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(e,this._distance);else{var t=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(t,v.EXTERIOR,v.INTERIOR)}}},{key:"addCurve",value:function(i,e,t){if(i===null||i.length<2)return null;var n=new Nt(i,new Be(0,v.BOUNDARY,e,t));this._curveList.add(n)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(i){if(i.isEmpty())return null;if(i instanceof Tn)this.addPolygon(i);else if(i instanceof Kt)this.addLineString(i);else if(i instanceof si)this.addPoint(i);else if(i instanceof ai)this.addCollection(i);else if(i instanceof hi)this.addCollection(i);else if(i instanceof li)this.addCollection(i);else{if(!(i instanceof Fe))throw new ht(i.getGeometryType());this.addCollection(i)}}},{key:"isErodedCompletely",value:function(i,e){var t=i.getCoordinates();if(t.length<4)return e<0;if(t.length===4)return this.isTriangleErodedCompletely(t,e);var n=i.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth());return e<0&&2*Math.abs(e)>r}},{key:"addCollection",value:function(i){for(var e=0;e<i.getNumGeometries();e++){var t=i.getGeometryN(e);this.add(t)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Z;var i=arguments[0],e=arguments[1],t=arguments[2];this._inputGeom=i,this._distance=e,this._curveBuilder=t}}])}(),gu=function(){return m(function i(){h(this,i)},[{key:"locate",value:function(i){}}])}(),mu=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,i.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Nn;var e=this._parent.getGeometryN(this._index++);return e instanceof Fe?(this._subcollectionIterator=new i(e),this._subcollectionIterator.next()):e}},{key:"remove",value:function(){throw new ht(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[iu]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()}},{key:"isAtomic",value:function(e){return!(e instanceof Fe)}}])}(),du=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"locate",value:function(e){return i.locate(e,this._geom)}},{key:"interfaces_",get:function(){return[gu]}}],[{key:"constructor_",value:function(){this._geom=null;var e=arguments[0];this._geom=e}},{key:"locatePointInPolygon",value:function(e,t){if(t.isEmpty())return v.EXTERIOR;var n=t.getExteriorRing(),r=i.locatePointInRing(e,n);if(r!==v.INTERIOR)return r;for(var s=0;s<t.getNumInteriorRing();s++){var u=t.getInteriorRingN(s),l=i.locatePointInRing(e,u);if(l===v.BOUNDARY)return v.BOUNDARY;if(l===v.INTERIOR)return v.EXTERIOR}return v.INTERIOR}},{key:"locatePointInRing",value:function(e,t){return t.getEnvelopeInternal().intersects(e)?gi.locateInRing(e,t.getCoordinates()):v.EXTERIOR}},{key:"containsPointInPolygon",value:function(e,t){return v.EXTERIOR!==i.locatePointInPolygon(e,t)}},{key:"locateInGeometry",value:function(e,t){if(t instanceof Tn)return i.locatePointInPolygon(e,t);if(t instanceof Fe)for(var n=new mu(t);n.hasNext();){var r=n.next();if(r!==t){var s=i.locateInGeometry(e,r);if(s!==v.EXTERIOR)return s}}return v.EXTERIOR}},{key:"isContained",value:function(e,t){return v.EXTERIOR!==i.locate(e,t)}},{key:"locate",value:function(e,t){return t.isEmpty()?v.EXTERIOR:t.getEnvelopeInternal().intersects(e)?i.locateInGeometry(e,t):v.EXTERIOR}}])}(),vu=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"getNextCW",value:function(i){this.getEdges();var e=this._edgeList.indexOf(i),t=e-1;return e===0&&(t=this._edgeList.size()-1),this._edgeList.get(t)}},{key:"propagateSideLabels",value:function(i){for(var e=v.NONE,t=this.iterator();t.hasNext();){var n=t.next().getLabel();n.isArea(i)&&n.getLocation(i,O.LEFT)!==v.NONE&&(e=n.getLocation(i,O.LEFT))}if(e===v.NONE)return null;for(var r=e,s=this.iterator();s.hasNext();){var u=s.next(),l=u.getLabel();if(l.getLocation(i,O.ON)===v.NONE&&l.setLocation(i,O.ON,r),l.isArea(i)){var g=l.getLocation(i,O.LEFT),d=l.getLocation(i,O.RIGHT);if(d!==v.NONE){if(d!==r)throw new rt("side location conflict",u.getCoordinate());g===v.NONE&&ee.shouldNeverReachHere("found single null side (at "+u.getCoordinate()+")"),r=g}else ee.isTrue(l.getLocation(i,O.LEFT)===v.NONE,"found single null side"),l.setLocation(i,O.RIGHT,r),l.setLocation(i,O.LEFT,r)}}}},{key:"getCoordinate",value:function(){var i=this.iterator();return i.hasNext()?i.next().getCoordinate():null}},{key:"print",value:function(i){Ye.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(i)}},{key:"isAreaLabelsConsistent",value:function(i){return this.computeEdgeEndLabels(i.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(i){var e=this.getEdges();if(e.size()<=0)return!0;var t=e.size()-1,n=e.get(t).getLabel().getLocation(i,O.LEFT);ee.isTrue(n!==v.NONE,"Found unlabelled area edge");for(var r=n,s=this.iterator();s.hasNext();){var u=s.next().getLabel();ee.isTrue(u.isArea(i),"Found non-area edge");var l=u.getLocation(i,O.LEFT),g=u.getLocation(i,O.RIGHT);if(l===g||g!==r)return!1;r=l}return!0}},{key:"findIndex",value:function(i){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===i)return e;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new Z(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(i,e,t){return this._ptInAreaLocation[i]===v.NONE&&(this._ptInAreaLocation[i]=du.locate(e,t[i].getGeometry())),this._ptInAreaLocation[i]}},{key:"toString",value:function(){var i=new Qt;i.append("EdgeEndStar:   "+this.getCoordinate()),i.append(`
`);for(var e=this.iterator();e.hasNext();){var t=e.next();i.append(t),i.append(`
`)}return i.toString()}},{key:"computeEdgeEndLabels",value:function(i){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(i)}},{key:"computeLabelling",value:function(i){this.computeEdgeEndLabels(i[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],t=this.iterator();t.hasNext();)for(var n=t.next().getLabel(),r=0;r<2;r++)n.isLine(r)&&n.getLocation(r)===v.BOUNDARY&&(e[r]=!0);for(var s=this.iterator();s.hasNext();)for(var u=s.next(),l=u.getLabel(),g=0;g<2;g++)if(l.isAnyNull(g)){var d=v.NONE;if(e[g])d=v.EXTERIOR;else{var x=u.getCoordinate();d=this.getLocation(g,x,i)}l.setAllLocationsIfNull(g,d)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(i,e){this._edgeMap.put(i,e),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new sn,this._edgeList=null,this._ptInAreaLocation=[v.NONE,v.NONE]}}])}(),yu=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var t=null,n=null,r=this._SCANNING_FOR_INCOMING,s=0;s<this._resultAreaEdgeList.size();s++){var u=this._resultAreaEdgeList.get(s),l=u.getSym();if(u.getLabel().isArea())switch(t===null&&u.isInResult()&&(t=u),r){case this._SCANNING_FOR_INCOMING:if(!l.isInResult())continue;n=l,r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!u.isInResult())continue;n.setNext(u),r=this._SCANNING_FOR_INCOMING}}if(r===this._LINKING_TO_OUTGOING){if(t===null)throw new rt("no outgoing dirEdge found",this.getCoordinate());ee.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),n.setNext(t)}}},{key:"insert",value:function(t){var n=t;this.insertEdgeEnd(n,n)}},{key:"getRightmostEdge",value:function(){var t=this.getEdges(),n=t.size();if(n<1)return null;var r=t.get(0);if(n===1)return r;var s=t.get(n-1),u=r.getQuadrant(),l=s.getQuadrant();return Ae.isNorthern(u)&&Ae.isNorthern(l)?r:Ae.isNorthern(u)||Ae.isNorthern(l)?r.getDy()!==0?r:s.getDy()!==0?s:(ee.shouldNeverReachHere("found two horizontal edges incident on node"),null):s}},{key:"print",value:function(t){Ye.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var r=n.next();t.print("out "),r.print(t),t.println(),t.print("in "),r.getSym().print(t),t.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Z;for(var t=this.iterator();t.hasNext();){var n=t.next();(n.isInResult()||n.getSym().isInResult())&&this._resultAreaEdgeList.add(n)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(t){for(var n=this.iterator();n.hasNext();){var r=n.next().getLabel();r.setAllLocationsIfNull(0,t.getLocation(0)),r.setAllLocationsIfNull(1,t.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var t=null,n=null,r=this._edgeList.size()-1;r>=0;r--){var s=this._edgeList.get(r),u=s.getSym();n===null&&(n=u),t!==null&&u.setNext(t),t=s}n.setNext(t)}},{key:"computeDepths",value:function(){if(arguments.length===1){var t=arguments[0],n=this.findIndex(t),r=t.getDepth(O.LEFT),s=t.getDepth(O.RIGHT),u=this.computeDepths(n+1,this._edgeList.size(),r);if(this.computeDepths(0,n,u)!==s)throw new rt("depth mismatch at "+t.getCoordinate())}else if(arguments.length===3){for(var l=arguments[1],g=arguments[2],d=arguments[0];d<l;d++){var x=this._edgeList.get(d);x.setEdgeDepths(O.RIGHT,g),g=x.getDepth(O.LEFT)}return g}}},{key:"mergeSymLabels",value:function(){for(var t=this.iterator();t.hasNext();){var n=t.next();n.getLabel().merge(n.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(t){for(var n=null,r=null,s=this._SCANNING_FOR_INCOMING,u=this._resultAreaEdgeList.size()-1;u>=0;u--){var l=this._resultAreaEdgeList.get(u),g=l.getSym();switch(n===null&&l.getEdgeRing()===t&&(n=l),s){case this._SCANNING_FOR_INCOMING:if(g.getEdgeRing()!==t)continue;r=g,s=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(l.getEdgeRing()!==t)continue;r.setNextMin(l),s=this._SCANNING_FOR_INCOMING}}s===this._LINKING_TO_OUTGOING&&(ee.isTrue(n!==null,"found null for first outgoing dirEdge"),ee.isTrue(n.getEdgeRing()===t,"unable to link last incoming dirEdge"),r.setNextMin(n))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var t=0,n=this.iterator();n.hasNext();)n.next().isInResult()&&t++;return t}if(arguments.length===1){for(var r=arguments[0],s=0,u=this.iterator();u.hasNext();)u.next().getEdgeRing()===r&&s++;return s}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var t=v.NONE,n=this.iterator();n.hasNext();){var r=n.next(),s=r.getSym();if(!r.isLineEdge()){if(r.isInResult()){t=v.INTERIOR;break}if(s.isInResult()){t=v.EXTERIOR;break}}}if(t===v.NONE)return null;for(var u=t,l=this.iterator();l.hasNext();){var g=l.next(),d=g.getSym();g.isLineEdge()?g.getEdge().setCovered(u===v.INTERIOR):(g.isInResult()&&(u=v.EXTERIOR),d.isInResult()&&(u=v.INTERIOR))}}},{key:"computeLabelling",value:function(t){w(e,"computeLabelling",this,1).call(this,t),this._label=new Be(v.NONE);for(var n=this.iterator();n.hasNext();)for(var r=n.next().getEdge().getLabel(),s=0;s<2;s++){var u=r.getLocation(s);u!==v.INTERIOR&&u!==v.BOUNDARY||this._label.setLocation(s,v.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])}(vu),pu=function(i){function e(){return h(this,e),f(this,e)}return E(e,i),m(e,[{key:"createNode",value:function(t){return new bn(t,new yu)}}])}(or),kr=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"compareTo",value:function(e){var t=e;return i.compareOriented(this._pts,this._orientation,t._pts,t._orientation)}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=i.orientation(e)}},{key:"orientation",value:function(e){return Ne.increasingDirection(e)===1}},{key:"compareOriented",value:function(e,t,n,r){for(var s=t?1:-1,u=r?1:-1,l=t?e.length:-1,g=r?n.length:-1,d=t?0:e.length-1,x=r?0:n.length-1;;){var I=e[d].compareTo(n[x]);if(I!==0)return I;var R=(d+=s)===l,b=(x+=u)===g;if(R&&!b)return-1;if(!R&&b)return 1;if(R&&b)return 0}}}])}(),_u=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"print",value:function(i){i.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var t=this._edges.get(e);e>0&&i.print(","),i.print("(");for(var n=t.getCoordinates(),r=0;r<n.length;r++)r>0&&i.print(","),i.print(n[r].x+" "+n[r].y);i.println(")")}i.print(")  ")}},{key:"addAll",value:function(i){for(var e=i.iterator();e.hasNext();)this.add(e.next())}},{key:"findEdgeIndex",value:function(i){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(i))return e;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(i){return this._edges.get(i)}},{key:"findEqualEdge",value:function(i){var e=new kr(i.getCoordinates());return this._ocaMap.get(e)}},{key:"add",value:function(i){this._edges.add(i);var e=new kr(i.getCoordinates());this._ocaMap.put(e,i)}}],[{key:"constructor_",value:function(){this._edges=new Z,this._ocaMap=new sn}}])}(),xr=function(){return m(function i(){h(this,i)},[{key:"processIntersections",value:function(i,e,t,n){}},{key:"isDone",value:function(){}}])}(),ku=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"isTrivialIntersection",value:function(e,t,n,r){if(e===n&&this._li.getIntersectionNum()===1){if(i.isAdjacentSegments(t,r))return!0;if(e.isClosed()){var s=e.size()-1;if(t===0&&r===s||r===0&&t===s)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(e,t,n,r){if(e===n&&t===r)return null;this.numTests++;var s=e.getCoordinates()[t],u=e.getCoordinates()[t+1],l=n.getCoordinates()[r],g=n.getCoordinates()[r+1];this._li.computeIntersection(s,u,l,g),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,t,n,r)||(this._hasIntersection=!0,e.addIntersections(this._li,t,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[xr]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=arguments[0];this._li=e}},{key:"isAdjacentSegments",value:function(e,t){return Math.abs(e-t)===1}}])}(),xu=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(i){i.print(this.coord),i.print(" seg # = "+this.segmentIndex),i.println(" dist = "+this.dist)}},{key:"compareTo",value:function(i){var e=i;return this.compare(e.segmentIndex,e.dist)}},{key:"isEndPoint",value:function(i){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===i}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(i,e){return this.segmentIndex<i?-1:this.segmentIndex>i?1:this.dist<e?-1:this.dist>e?1:0}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var i=arguments[0],e=arguments[1],t=arguments[2];this.coord=new S(i),this.segmentIndex=e,this.dist=t}}])}(),Eu=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"print",value:function(i){i.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(i)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(i){this.addEndpoints();for(var e=this.iterator(),t=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(t,n);i.add(r),t=n}}},{key:"addEndpoints",value:function(){var i=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[i],i,0)}},{key:"createSplitEdge",value:function(i,e){var t=e.segmentIndex-i.segmentIndex+2,n=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(n);r||t--;var s=new Array(t).fill(null),u=0;s[u++]=new S(i.coord);for(var l=i.segmentIndex+1;l<=e.segmentIndex;l++)s[u++]=this.edge.pts[l];return r&&(s[u]=e.coord),new Nr(s,new Be(this.edge._label))}},{key:"add",value:function(i,e,t){var n=new xu(i,e,t),r=this._nodeMap.get(n);return r!==null?r:(this._nodeMap.put(n,n),n)}},{key:"isIntersection",value:function(i){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(i))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new sn,this.edge=null;var i=arguments[0];this.edge=i}}])}(),Nu=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(i.isTrue(this._matrix[v.INTERIOR][v.INTERIOR])||i.isTrue(this._matrix[v.INTERIOR][v.BOUNDARY])||i.isTrue(this._matrix[v.BOUNDARY][v.INTERIOR])||i.isTrue(this._matrix[v.BOUNDARY][v.BOUNDARY]))&&this._matrix[v.EXTERIOR][v.INTERIOR]===M.FALSE&&this._matrix[v.EXTERIOR][v.BOUNDARY]===M.FALSE}},{key:"isCoveredBy",value:function(){return(i.isTrue(this._matrix[v.INTERIOR][v.INTERIOR])||i.isTrue(this._matrix[v.INTERIOR][v.BOUNDARY])||i.isTrue(this._matrix[v.BOUNDARY][v.INTERIOR])||i.isTrue(this._matrix[v.BOUNDARY][v.BOUNDARY]))&&this._matrix[v.INTERIOR][v.EXTERIOR]===M.FALSE&&this._matrix[v.BOUNDARY][v.EXTERIOR]===M.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var e=arguments[0],t=0;t<e.length;t++){var n=Math.trunc(t/3),r=t%3;this._matrix[n][r]=M.toDimensionValue(e.charAt(t))}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];this._matrix[s][u]=l}}},{key:"isContains",value:function(){return i.isTrue(this._matrix[v.INTERIOR][v.INTERIOR])&&this._matrix[v.EXTERIOR][v.INTERIOR]===M.FALSE&&this._matrix[v.EXTERIOR][v.BOUNDARY]===M.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var e=arguments[0],t=0;t<e.length;t++){var n=Math.trunc(t/3),r=t%3;this.setAtLeast(n,r,M.toDimensionValue(e.charAt(t)))}else if(arguments.length===3){var s=arguments[0],u=arguments[1],l=arguments[2];this._matrix[s][u]<l&&(this._matrix[s][u]=l)}}},{key:"setAtLeastIfValid",value:function(e,t,n){e>=0&&t>=0&&this.setAtLeast(e,t,n)}},{key:"isWithin",value:function(){return i.isTrue(this._matrix[v.INTERIOR][v.INTERIOR])&&this._matrix[v.INTERIOR][v.EXTERIOR]===M.FALSE&&this._matrix[v.BOUNDARY][v.EXTERIOR]===M.FALSE}},{key:"isTouches",value:function(e,t){return e>t?this.isTouches(t,e):(e===M.A&&t===M.A||e===M.L&&t===M.L||e===M.L&&t===M.A||e===M.P&&t===M.A||e===M.P&&t===M.L)&&this._matrix[v.INTERIOR][v.INTERIOR]===M.FALSE&&(i.isTrue(this._matrix[v.INTERIOR][v.BOUNDARY])||i.isTrue(this._matrix[v.BOUNDARY][v.INTERIOR])||i.isTrue(this._matrix[v.BOUNDARY][v.BOUNDARY]))}},{key:"isOverlaps",value:function(e,t){return e===M.P&&t===M.P||e===M.A&&t===M.A?i.isTrue(this._matrix[v.INTERIOR][v.INTERIOR])&&i.isTrue(this._matrix[v.INTERIOR][v.EXTERIOR])&&i.isTrue(this._matrix[v.EXTERIOR][v.INTERIOR]):e===M.L&&t===M.L&&this._matrix[v.INTERIOR][v.INTERIOR]===1&&i.isTrue(this._matrix[v.INTERIOR][v.EXTERIOR])&&i.isTrue(this._matrix[v.EXTERIOR][v.INTERIOR])}},{key:"isEquals",value:function(e,t){return e===t&&i.isTrue(this._matrix[v.INTERIOR][v.INTERIOR])&&this._matrix[v.INTERIOR][v.EXTERIOR]===M.FALSE&&this._matrix[v.BOUNDARY][v.EXTERIOR]===M.FALSE&&this._matrix[v.EXTERIOR][v.INTERIOR]===M.FALSE&&this._matrix[v.EXTERIOR][v.BOUNDARY]===M.FALSE}},{key:"toString",value:function(){for(var e=new Rn("123456789"),t=0;t<3;t++)for(var n=0;n<3;n++)e.setCharAt(3*t+n,M.toDimensionSymbol(this._matrix[t][n]));return e.toString()}},{key:"setAll",value:function(e){for(var t=0;t<3;t++)for(var n=0;n<3;n++)this._matrix[t][n]=e}},{key:"get",value:function(e,t){return this._matrix[e][t]}},{key:"transpose",value:function(){var e=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=e,e=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=e,e=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=e,this}},{key:"matches",value:function(e){if(e.length!==9)throw new F("Should be length 9: "+e);for(var t=0;t<3;t++)for(var n=0;n<3;n++)if(!i.matches(this._matrix[t][n],e.charAt(3*t+n)))return!1;return!0}},{key:"add",value:function(e){for(var t=0;t<3;t++)for(var n=0;n<3;n++)this.setAtLeast(t,n,e.get(t,n))}},{key:"isDisjoint",value:function(){return this._matrix[v.INTERIOR][v.INTERIOR]===M.FALSE&&this._matrix[v.INTERIOR][v.BOUNDARY]===M.FALSE&&this._matrix[v.BOUNDARY][v.INTERIOR]===M.FALSE&&this._matrix[v.BOUNDARY][v.BOUNDARY]===M.FALSE}},{key:"isCrosses",value:function(e,t){return e===M.P&&t===M.L||e===M.P&&t===M.A||e===M.L&&t===M.A?i.isTrue(this._matrix[v.INTERIOR][v.INTERIOR])&&i.isTrue(this._matrix[v.INTERIOR][v.EXTERIOR]):e===M.L&&t===M.P||e===M.A&&t===M.P||e===M.A&&t===M.L?i.isTrue(this._matrix[v.INTERIOR][v.INTERIOR])&&i.isTrue(this._matrix[v.EXTERIOR][v.INTERIOR]):e===M.L&&t===M.L&&this._matrix[v.INTERIOR][v.INTERIOR]===0}},{key:"interfaces_",get:function(){return[$]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(M.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var e=arguments[0];i.constructor_.call(this),this.set(e)}else if(arguments[0]instanceof i){var t=arguments[0];i.constructor_.call(this),this._matrix[v.INTERIOR][v.INTERIOR]=t._matrix[v.INTERIOR][v.INTERIOR],this._matrix[v.INTERIOR][v.BOUNDARY]=t._matrix[v.INTERIOR][v.BOUNDARY],this._matrix[v.INTERIOR][v.EXTERIOR]=t._matrix[v.INTERIOR][v.EXTERIOR],this._matrix[v.BOUNDARY][v.INTERIOR]=t._matrix[v.BOUNDARY][v.INTERIOR],this._matrix[v.BOUNDARY][v.BOUNDARY]=t._matrix[v.BOUNDARY][v.BOUNDARY],this._matrix[v.BOUNDARY][v.EXTERIOR]=t._matrix[v.BOUNDARY][v.EXTERIOR],this._matrix[v.EXTERIOR][v.INTERIOR]=t._matrix[v.EXTERIOR][v.INTERIOR],this._matrix[v.EXTERIOR][v.BOUNDARY]=t._matrix[v.EXTERIOR][v.BOUNDARY],this._matrix[v.EXTERIOR][v.EXTERIOR]=t._matrix[v.EXTERIOR][v.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var e=arguments[0],t=arguments[1];return t===M.SYM_DONTCARE||t===M.SYM_TRUE&&(e>=0||e===M.TRUE)||t===M.SYM_FALSE&&e===M.FALSE||t===M.SYM_P&&e===M.P||t===M.SYM_L&&e===M.L||t===M.SYM_A&&e===M.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var n=arguments[1];return new i(arguments[0]).matches(n)}}},{key:"isTrue",value:function(e){return e>=0||e===M.TRUE}}])}(),Iu=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(e){return e===null||e.length===0?null:(this.ensureCapacity(this._size+e.length),Ye.arraycopy(e,0,this._data,this._size,e.length),void(this._size+=e.length))}},{key:"ensureCapacity",value:function(e){if(e<=this._data.length)return null;var t=Math.max(e,2*this._data.length);this._data=_t.copyOf(this._data,t)}},{key:"toArray",value:function(){var e=new Array(this._size).fill(null);return Ye.arraycopy(this._data,0,e,0,this._size),e}},{key:"add",value:function(e){this.ensureCapacity(this._size+1),this._data[this._size]=e,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)i.constructor_.call(this,10);else if(arguments.length===1){var e=arguments[0];this._data=new Array(e).fill(null)}}}])}(),Su=function(){function i(){h(this,i)}return m(i,[{key:"getChainStartIndices",value:function(e){var t=0,n=new Iu(Math.trunc(e.length/2));n.add(t);do{var r=this.findChainEnd(e,t);n.add(r),t=r}while(t<e.length-1);return n.toArray()}},{key:"findChainEnd",value:function(e,t){for(var n=Ae.quadrant(e[t],e[t+1]),r=t+1;r<e.length&&Ae.quadrant(e[r-1],e[r])===n;)r++;return r-1}},{key:"OLDgetChainStartIndices",value:function(e){var t=0,n=new Z;n.add(t);do{var r=this.findChainEnd(e,t);n.add(r),t=r}while(t<e.length-1);return i.toIntArray(n)}}],[{key:"toIntArray",value:function(e){for(var t=new Array(e.size()).fill(null),n=0;n<t.length;n++)t[n]=e.get(n).intValue();return t}}])}(),wu=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(i){var e=this.pts[this.startIndex[i]].x,t=this.pts[this.startIndex[i+1]].x;return e>t?e:t}},{key:"getMinX",value:function(i){var e=this.pts[this.startIndex[i]].x,t=this.pts[this.startIndex[i+1]].x;return e<t?e:t}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var i=arguments[0],e=arguments[1],t=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[i],this.startIndex[i+1],e,e.startIndex[t],e.startIndex[t+1],n)}else if(arguments.length===6){var r=arguments[0],s=arguments[1],u=arguments[2],l=arguments[3],g=arguments[4],d=arguments[5];if(s-r==1&&g-l==1)return d.addIntersections(this.e,r,u.e,l),null;if(!this.overlaps(r,s,u,l,g))return null;var x=Math.trunc((r+s)/2),I=Math.trunc((l+g)/2);r<x&&(l<I&&this.computeIntersectsForChain(r,x,u,l,I,d),I<g&&this.computeIntersectsForChain(r,x,u,I,g,d)),x<s&&(l<I&&this.computeIntersectsForChain(x,s,u,l,I,d),I<g&&this.computeIntersectsForChain(x,s,u,I,g,d))}}},{key:"overlaps",value:function(i,e,t,n,r){return ge.intersects(this.pts[i],this.pts[e],t.pts[n],t.pts[r])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(i,e){for(var t=0;t<this.startIndex.length-1;t++)for(var n=0;n<i.startIndex.length-1;n++)this.computeIntersectsForChain(t,i,n,e)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var i=arguments[0];this.e=i,this.pts=i.getCoordinates();var e=new Su;this.startIndex=e.getChainStartIndices(this.pts)}}])}(),Er=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"getDepth",value:function(e,t){return this._depth[e][t]}},{key:"setDepth",value:function(e,t,n){this._depth[e][t]=n}},{key:"isNull",value:function(){if(arguments.length===0){for(var e=0;e<2;e++)for(var t=0;t<3;t++)if(this._depth[e][t]!==i.NULL_VALUE)return!1;return!0}if(arguments.length===1){var n=arguments[0];return this._depth[n][1]===i.NULL_VALUE}if(arguments.length===2){var r=arguments[0],s=arguments[1];return this._depth[r][s]===i.NULL_VALUE}}},{key:"normalize",value:function(){for(var e=0;e<2;e++)if(!this.isNull(e)){var t=this._depth[e][1];this._depth[e][2]<t&&(t=this._depth[e][2]),t<0&&(t=0);for(var n=1;n<3;n++){var r=0;this._depth[e][n]>t&&(r=1),this._depth[e][n]=r}}}},{key:"getDelta",value:function(e){return this._depth[e][O.RIGHT]-this._depth[e][O.LEFT]}},{key:"getLocation",value:function(e,t){return this._depth[e][t]<=0?v.EXTERIOR:v.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var e=arguments[0],t=0;t<2;t++)for(var n=1;n<3;n++){var r=e.getLocation(t,n);r!==v.EXTERIOR&&r!==v.INTERIOR||(this.isNull(t,n)?this._depth[t][n]=i.depthAtLocation(r):this._depth[t][n]+=i.depthAtLocation(r))}else if(arguments.length===3){var s=arguments[0],u=arguments[1];arguments[2]===v.INTERIOR&&this._depth[s][u]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var t=0;t<3;t++)this._depth[e][t]=i.NULL_VALUE}},{key:"depthAtLocation",value:function(e){return e===v.EXTERIOR?0:e===v.INTERIOR?1:i.NULL_VALUE}}])}();Er.NULL_VALUE=-1;var Nr=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Be.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(t){this._isIsolated=t}},{key:"setName",value:function(t){this._name=t}},{key:"equals",value:function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var r=!0,s=!0,u=this.pts.length,l=0;l<this.pts.length;l++)if(this.pts[l].equals2D(n.pts[l])||(r=!1),this.pts[l].equals2D(n.pts[--u])||(s=!1),!r&&!s)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var t=arguments[0];return this.pts[t]}}},{key:"print",value:function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var n=0;n<this.pts.length;n++)n>0&&t.print(","),t.print(this.pts[n].x+" "+this.pts[n].y);t.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(t){e.updateIM(this._label,t)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(t){t.print("edge "+this._name+": ");for(var n=this.pts.length-1;n>=0;n--)t.print(this.pts[n]+" ");t.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new wu(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new ge;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}},{key:"addIntersection",value:function(t,n,r,s){var u=new S(t.getIntersection(s)),l=n,g=t.getEdgeDistance(r,s),d=l+1;if(d<this.pts.length){var x=this.pts[d];u.equals2D(x)&&(l=d,g=0)}this.eiList.add(u,l,g)}},{key:"toString",value:function(){var t=new Rn;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var n=0;n<this.pts.length;n++)n>0&&t.append(","),t.append(this.pts[n].x+" "+this.pts[n].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}},{key:"isPointwiseEqual",value:function(t){if(this.pts.length!==t.pts.length)return!1;for(var n=0;n<this.pts.length;n++)if(!this.pts[n].equals2D(t.pts[n]))return!1;return!0}},{key:"setDepthDelta",value:function(t){this._depthDelta=t}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(t,n,r){for(var s=0;s<t.getIntersectionNum();s++)this.addIntersection(t,n,r,s)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new Eu(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Er,this._depthDelta=0,arguments.length===1){var t=arguments[0];e.constructor_.call(this,t,null)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.pts=n,this._label=r}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Nu&&arguments[0]instanceof Be))return w(e,"updateIM",this).apply(this,arguments);var t=arguments[0],n=arguments[1];n.setAtLeastIfValid(t.getLocation(0,O.ON),t.getLocation(1,O.ON),1),t.isArea()&&(n.setAtLeastIfValid(t.getLocation(0,O.LEFT),t.getLocation(1,O.LEFT),2),n.setAtLeastIfValid(t.getLocation(0,O.RIGHT),t.getLocation(1,O.RIGHT),2))}}])}(ir),Ir=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"setWorkingPrecisionModel",value:function(e){this._workingPrecisionModel=e}},{key:"insertUniqueEdge",value:function(e){var t=this._edgeList.findEqualEdge(e);if(t!==null){var n=t.getLabel(),r=e.getLabel();t.isPointwiseEqual(e)||(r=new Be(e.getLabel())).flip(),n.merge(r);var s=i.depthDelta(r),u=t.getDepthDelta()+s;t.setDepthDelta(u)}else this._edgeList.add(e),e.setDepthDelta(i.depthDelta(e.getLabel()))}},{key:"buildSubgraphs",value:function(e,t){for(var n=new Z,r=e.iterator();r.hasNext();){var s=r.next(),u=s.getRightmostCoordinate(),l=new yr(n).getDepth(u);s.computeDepth(l),s.findResultEdges(),n.add(s),t.add(s.getDirectedEdges(),s.getNodes())}}},{key:"createSubgraphs",value:function(e){for(var t=new Z,n=e.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var s=new Oa;s.create(r),t.add(s)}}return Mt.sort(t,Mt.reverseOrder()),t}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(e){if(this._workingNoder!==null)return this._workingNoder;var t=new yi,n=new Et;return n.setPrecisionModel(e),t.setSegmentIntersector(new ku(n)),t}},{key:"buffer",value:function(e,t){var n=this._workingPrecisionModel;n===null&&(n=e.getPrecisionModel()),this._geomFact=e.getFactory();var r=new hu(n,this._bufParams),s=new fu(e,t,r).getCurves();if(s.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(s,n),this._graph=new lr(new pu),this._graph.addEdges(this._edgeList.getEdges());var u=this.createSubgraphs(this._graph),l=new Qa(this._geomFact);this.buildSubgraphs(u,l);var g=l.getPolygons();return g.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(g)}},{key:"computeNodedEdges",value:function(e,t){var n=this.getNoder(t);n.computeNodes(e);for(var r=n.getNodedSubstrings().iterator();r.hasNext();){var s=r.next(),u=s.getCoordinates();if(u.length!==2||!u[0].equals2D(u[1])){var l=s.getData(),g=new Nr(s.getCoordinates(),new Be(l));this.insertUniqueEdge(g)}}}},{key:"setNoder",value:function(e){this._workingNoder=e}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new _u;var e=arguments[0];this._bufParams=e}},{key:"depthDelta",value:function(e){var t=e.getLocation(0,O.LEFT),n=e.getLocation(0,O.RIGHT);return t===v.INTERIOR&&n===v.EXTERIOR?1:t===v.EXTERIOR&&n===v.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(e){for(var t=new Rt,n=new Z;e.hasNext();){var r=e.next(),s=t.createLineString(r.getCoordinates());n.add(s)}return t.buildGeometry(n)}}])}(),Cu=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"rescale",value:function(){if(K(arguments[0],We))for(var e=arguments[0].iterator();e.hasNext();){var t=e.next();this.rescale(t.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],r=0;r<n.length;r++)n[r].x=n[r].x/this._scaleFactor+this._offsetX,n[r].y=n[r].y/this._scaleFactor+this._offsetY;n.length===2&&n[0].equals2D(n[1])&&Ye.out.println(n)}}},{key:"scale",value:function(){if(K(arguments[0],We)){for(var e=arguments[0],t=new Z(e.size()),n=e.iterator();n.hasNext();){var r=n.next();t.add(new Nt(this.scale(r.getCoordinates()),r.getData()))}return t}if(arguments[0]instanceof Array){for(var s=arguments[0],u=new Array(s.length).fill(null),l=0;l<s.length;l++)u[l]=new S(Math.round((s[l].x-this._offsetX)*this._scaleFactor),Math.round((s[l].y-this._offsetY)*this._scaleFactor),s[l].getZ());return Ne.removeRepeatedPoints(u)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e}},{key:"computeNodes",value:function(e){var t=e;this._isScaled&&(t=this.scale(e)),this._noder.computeNodes(t)}},{key:"interfaces_",get:function(){return[vi]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var e=arguments[0],t=arguments[1];i.constructor_.call(this,e,t,0,0)}else if(arguments.length===4){var n=arguments[0],r=arguments[1];this._noder=n,this._scaleFactor=r,this._isScaled=!this.isIntegerPrecision()}}}])}(),Sr=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var t=e.next().getCoordinates();this.checkEndPtVertexIntersections(t[0],this._segStrings),this.checkEndPtVertexIntersections(t[t.length-1],this._segStrings)}else if(arguments.length===2){for(var n=arguments[0],r=arguments[1].iterator();r.hasNext();)for(var s=r.next().getCoordinates(),u=1;u<s.length-1;u++)if(s[u].equals(n))throw new Ce("found endpt/interior pt intersection at index "+u+" :pt "+n)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();)for(var t=e.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();this.checkInteriorIntersections(t,r)}else if(arguments.length===2)for(var s=arguments[0],u=arguments[1],l=s.getCoordinates(),g=u.getCoordinates(),d=0;d<l.length-1;d++)for(var x=0;x<g.length-1;x++)this.checkInteriorIntersections(s,d,u,x);else if(arguments.length===4){var I=arguments[0],R=arguments[1],b=arguments[2],z=arguments[3];if(I===b&&R===z)return null;var X=I.getCoordinates()[R],re=I.getCoordinates()[R+1],ne=b.getCoordinates()[z],ce=b.getCoordinates()[z+1];if(this._li.computeIntersection(X,re,ne,ce),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,X,re)||this.hasInteriorIntersection(this._li,ne,ce)))throw new Ce("found non-noded intersection at "+X+"-"+re+" and "+ne+"-"+ce)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var t=e.next();this.checkCollapses(t)}else if(arguments.length===1)for(var n=arguments[0].getCoordinates(),r=0;r<n.length-2;r++)this.checkCollapse(n[r],n[r+1],n[r+2])}},{key:"hasInteriorIntersection",value:function(e,t,n){for(var r=0;r<e.getIntersectionNum();r++){var s=e.getIntersection(r);if(!s.equals(t)&&!s.equals(n))return!0}return!1}},{key:"checkCollapse",value:function(e,t,n){if(e.equals(n))throw new Ce("found non-noded collapse at "+i.fact.createLineString([e,t,n]))}}],[{key:"constructor_",value:function(){this._li=new Et,this._segStrings=null;var e=arguments[0];this._segStrings=e}}])}();Sr.fact=new Rt;var _i=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"intersectsScaled",value:function(e,t){var n=Math.min(e.x,t.x),r=Math.max(e.x,t.x),s=Math.min(e.y,t.y),u=Math.max(e.y,t.y),l=this._maxx<n||this._minx>r||this._maxy<s||this._miny>u;if(l)return!1;var g=this.intersectsToleranceSquare(e,t);return ee.isTrue(!(l&&g),"Found bad envelope test"),g}},{key:"initCorners",value:function(e){var t=.5;this._minx=e.x-t,this._maxx=e.x+t,this._miny=e.y-t,this._maxy=e.y+t,this._corner[0]=new S(this._maxx,this._maxy),this._corner[1]=new S(this._minx,this._maxy),this._corner[2]=new S(this._minx,this._miny),this._corner[3]=new S(this._maxx,this._miny)}},{key:"intersects",value:function(e,t){return this._scaleFactor===1?this.intersectsScaled(e,t):(this.copyScaled(e,this._p0Scaled),this.copyScaled(t,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(e){return Math.round(e*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(e,t){t.x=this.scale(e.x),t.y=this.scale(e.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var e=i.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new ge(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(e,t){return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(e,t){var n=!1,r=!1;return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!n||!r)||!!e.equals(this._pt)||!!t.equals(this._pt))))}},{key:"addSnappedNode",value:function(e,t){var n=e.getCoordinate(t),r=e.getCoordinate(t+1);return!!this.intersects(n,r)&&(e.addIntersection(this.getCoordinate(),t),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],t=arguments[1],n=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=t,this._li=n,t<=0)throw new F("Scale factor must be non-zero");t!==1&&(this._pt=new S(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new S,this._p1Scaled=new S),this.initCorners(this._pt)}}])}();_i.SAFE_ENV_EXPANSION_FACTOR=.75;var Tu=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var i=arguments[1];arguments[0].getLineSegment(i,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Ge}}])}(),wr=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"snap",value:function(){if(arguments.length===1){var i=arguments[0];return this.snap(i,null,-1)}if(arguments.length===3){var e=arguments[0],t=arguments[1],n=arguments[2],r=e.getSafeEnvelope(),s=new Cr(e,t,n);return this._index.query(r,new(function(){return m(function u(){h(this,u)},[{key:"interfaces_",get:function(){return[cr]}},{key:"visitItem",value:function(u){u.select(r,s)}}])}())),s.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var i=arguments[0];this._index=i}}])}(),Cr=function(i){function e(){var t;return h(this,e),t=f(this,e),e.constructor_.apply(t,arguments),t}return E(e,i),m(e,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof gr))return w(e,"select",this,1).apply(this,arguments);var t=arguments[1],n=arguments[0].getContext();if(this._parentEdge===n&&(t===this._hotPixelVertexIndex||t+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(n,t)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],n=arguments[1],r=arguments[2];this._hotPixel=t,this._parentEdge=n,this._hotPixelVertexIndex=r}}])}(Tu);wr.HotPixelSnapAction=Cr;var Lu=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"processIntersections",value:function(i,e,t,n){if(i===t&&e===n)return null;var r=i.getCoordinates()[e],s=i.getCoordinates()[e+1],u=t.getCoordinates()[n],l=t.getCoordinates()[n+1];if(this._li.computeIntersection(r,s,u,l),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var g=0;g<this._li.getIntersectionNum();g++)this._interiorIntersections.add(this._li.getIntersection(g));i.addIntersections(this._li,e,0),t.addIntersections(this._li,n,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[xr]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var i=arguments[0];this._li=i,this._interiorIntersections=new Z}}])}(),Ru=function(){return m(function i(){h(this,i),i.constructor_.apply(this,arguments)},[{key:"checkCorrectness",value:function(i){var e=Nt.getNodedSubstrings(i),t=new Sr(e);try{t.checkValid()}catch(n){if(!(n instanceof V))throw n;n.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Nt.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(i,e){var t=this.findInteriorIntersections(i,e);this.computeIntersectionSnaps(t),this.computeVertexSnaps(i)}},{key:"findInteriorIntersections",value:function(i,e){var t=new Lu(e);return this._noder.setSegmentIntersector(t),this._noder.computeNodes(i),t.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(K(arguments[0],We))for(var i=arguments[0].iterator();i.hasNext();){var e=i.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Nt)for(var t=arguments[0],n=t.getCoordinates(),r=0;r<n.length;r++){var s=new _i(n[r],this._scaleFactor,this._li);this._pointSnapper.snap(s,t,r)&&t.addIntersection(n[r],r)}}},{key:"computeNodes",value:function(i){this._nodedSegStrings=i,this._noder=new yi,this._pointSnapper=new wr(this._noder.getIndex()),this.snapRound(i,this._li)}},{key:"computeIntersectionSnaps",value:function(i){for(var e=i.iterator();e.hasNext();){var t=e.next(),n=new _i(t,this._scaleFactor,this._li);this._pointSnapper.snap(n)}}},{key:"interfaces_",get:function(){return[vi]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var i=arguments[0];this._pm=i,this._li=new Et,this._li.setPrecisionModel(i),this._scaleFactor=i.getScale()}}])}(),At=function(){function i(){h(this,i),i.constructor_.apply(this,arguments)}return m(i,[{key:"bufferFixedPrecision",value:function(e){var t=new Cu(new Ru(new He(1)),e.getScale()),n=new Ir(this._bufParams);n.setWorkingPrecisionModel(e),n.setNoder(t),this._resultGeometry=n.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var e=i.MAX_PRECISION_DIGITS;e>=0;e--){try{this.bufferReducedPrecision(e)}catch(s){if(!(s instanceof rt))throw s;this._saveException=s}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var t=arguments[0],n=i.precisionScaleFactor(this._argGeom,this._distance,t),r=new He(n);this.bufferFixedPrecision(r)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===He.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(e){this._bufParams.setQuadrantSegments(e)}},{key:"bufferOriginalPrecision",value:function(){try{var e=new Ir(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof Ce))throw t;this._saveException=t}}},{key:"getResultGeometry",value:function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(e){this._bufParams.setEndCapStyle(e)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new A,this._resultGeometry=null,this._saveException=null,arguments.length===1){var e=arguments[0];this._argGeom=e}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._argGeom=t,this._bufParams=n}}},{key:"bufferOp",value:function(){if(arguments.length===2){var e=arguments[1];return new i(arguments[0]).getResultGeometry(e)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof U&&typeof arguments[1]=="number"){var t=arguments[1],n=arguments[2],r=new i(arguments[0]);return r.setQuadrantSegments(n),r.getResultGeometry(t)}if(arguments[2]instanceof A&&arguments[0]instanceof U&&typeof arguments[1]=="number"){var s=arguments[1];return new i(arguments[0],arguments[2]).getResultGeometry(s)}}else if(arguments.length===4){var u=arguments[1],l=arguments[2],g=arguments[3],d=new i(arguments[0]);return d.setQuadrantSegments(l),d.setEndCapStyle(g),d.getResultGeometry(u)}}},{key:"precisionScaleFactor",value:function(e,t,n){var r=e.getEnvelopeInternal(),s=Jt.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(t>0?t:0),u=n-Math.trunc(Math.log(s)/Math.log(10)+1);return Math.pow(10,u)}}])}();At.CAP_ROUND=A.CAP_ROUND,At.CAP_BUTT=A.CAP_FLAT,At.CAP_FLAT=A.CAP_FLAT,At.CAP_SQUARE=A.CAP_SQUARE,At.MAX_PRECISION_DIGITS=12;var Ou=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Tr=function(){return m(function i(e){h(this,i),this.geometryFactory=e||new Rt},[{key:"read",value:function(i){var e,t=(e=typeof i=="string"?JSON.parse(i):i).type;if(!Ue[t])throw new Error("Unknown GeoJSON type: "+e.type);return Ou.indexOf(t)!==-1?Ue[t].call(this,e.coordinates):t==="GeometryCollection"?Ue[t].call(this,e.geometries):Ue[t].call(this,e)}},{key:"write",value:function(i){var e=i.getGeometryType();if(!et[e])throw new Error("Geometry is not supported");return et[e].call(this,i)}}])}(),Ue={Feature:function(i){var e={};for(var t in i)e[t]=i[t];if(i.geometry){var n=i.geometry.type;if(!Ue[n])throw new Error("Unknown GeoJSON type: "+i.type);e.geometry=this.read(i.geometry)}return i.bbox&&(e.bbox=Ue.bbox.call(this,i.bbox)),e},FeatureCollection:function(i){var e={};if(i.features){e.features=[];for(var t=0;t<i.features.length;++t)e.features.push(this.read(i.features[t]))}return i.bbox&&(e.bbox=this.parse.bbox.call(this,i.bbox)),e},coordinates:function(i){for(var e=[],t=0;t<i.length;++t){var n=i[t];e.push(y(S,H(n)))}return e},bbox:function(i){return this.geometryFactory.createLinearRing([new S(i[0],i[1]),new S(i[2],i[1]),new S(i[2],i[3]),new S(i[0],i[3]),new S(i[0],i[1])])},Point:function(i){var e=y(S,H(i));return this.geometryFactory.createPoint(e)},MultiPoint:function(i){for(var e=[],t=0;t<i.length;++t)e.push(Ue.Point.call(this,i[t]));return this.geometryFactory.createMultiPoint(e)},LineString:function(i){var e=Ue.coordinates.call(this,i);return this.geometryFactory.createLineString(e)},MultiLineString:function(i){for(var e=[],t=0;t<i.length;++t)e.push(Ue.LineString.call(this,i[t]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(i){for(var e=Ue.coordinates.call(this,i[0]),t=this.geometryFactory.createLinearRing(e),n=[],r=1;r<i.length;++r){var s=i[r],u=Ue.coordinates.call(this,s),l=this.geometryFactory.createLinearRing(u);n.push(l)}return this.geometryFactory.createPolygon(t,n)},MultiPolygon:function(i){for(var e=[],t=0;t<i.length;++t){var n=i[t];e.push(Ue.Polygon.call(this,n))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(i){for(var e=[],t=0;t<i.length;++t){var n=i[t];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},et={coordinate:function(i){var e=[i.x,i.y];return i.z&&e.push(i.z),i.m&&e.push(i.m),e},Point:function(i){return{type:"Point",coordinates:et.coordinate.call(this,i.getCoordinate())}},MultiPoint:function(i){for(var e=[],t=0;t<i._geometries.length;++t){var n=i._geometries[t],r=et.Point.call(this,n);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(i){for(var e=[],t=i.getCoordinates(),n=0;n<t.length;++n){var r=t[n];e.push(et.coordinate.call(this,r))}return{type:"LineString",coordinates:e}},MultiLineString:function(i){for(var e=[],t=0;t<i._geometries.length;++t){var n=i._geometries[t],r=et.LineString.call(this,n);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(i){var e=[],t=et.LineString.call(this,i._shell);e.push(t.coordinates);for(var n=0;n<i._holes.length;++n){var r=i._holes[n],s=et.LineString.call(this,r);e.push(s.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(i){for(var e=[],t=0;t<i._geometries.length;++t){var n=i._geometries[t],r=et.Polygon.call(this,n);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(i){for(var e=[],t=0;t<i._geometries.length;++t){var n=i._geometries[t],r=n.getGeometryType();e.push(et[r].call(this,n))}return{type:"GeometryCollection",geometries:e}}};return{BufferOp:At,GeoJSONReader:function(){return m(function i(e){h(this,i),this.parser=new Tr(e||new Rt)},[{key:"read",value:function(i){return this.parser.read(i)}}])}(),GeoJSONWriter:function(){return m(function i(){h(this,i),this.parser=new Tr(this.geometryFactory)},[{key:"write",value:function(i){return this.parser.write(i)}}])}()}})}(qn)),qn.exports}var To=Co();const Lo=lo(To);function vt(){return new $n}function $n(){this.reset()}$n.prototype={constructor:$n,reset:function(){this.s=this.t=0},add:function(a){Qr(An,a,this.t),Qr(this,An.s,this.s),this.s?this.t+=An.t:this.s=An.t},valueOf:function(){return this.s}};var An=new $n;function Qr(a,o,c){var f=a.s=o+c,h=f-o,y=f-h;a.t=o-y+(c-h)}var ve=1e-6,ae=Math.PI,tt=ae/2,Jr=ae/4,nt=ae*2,ft=180/ae,Xe=ae/180,Te=Math.abs,Ro=Math.atan,Vt=Math.atan2,pe=Math.cos,_e=Math.sin,Wt=Math.sqrt;function Ps(a){return a>1?0:a<-1?ae:Math.acos(a)}function Ct(a){return a>1?tt:a<-1?-tt:Math.asin(a)}function on(){}function Wn(a,o){a&&es.hasOwnProperty(a.type)&&es[a.type](a,o)}var Kr={Feature:function(a,o){Wn(a.geometry,o)},FeatureCollection:function(a,o){for(var c=a.features,f=-1,h=c.length;++f<h;)Wn(c[f].geometry,o)}},es={Sphere:function(a,o){o.sphere()},Point:function(a,o){a=a.coordinates,o.point(a[0],a[1],a[2])},MultiPoint:function(a,o){for(var c=a.coordinates,f=-1,h=c.length;++f<h;)a=c[f],o.point(a[0],a[1],a[2])},LineString:function(a,o){Ti(a.coordinates,o,0)},MultiLineString:function(a,o){for(var c=a.coordinates,f=-1,h=c.length;++f<h;)Ti(c[f],o,0)},Polygon:function(a,o){ts(a.coordinates,o)},MultiPolygon:function(a,o){for(var c=a.coordinates,f=-1,h=c.length;++f<h;)ts(c[f],o)},GeometryCollection:function(a,o){for(var c=a.geometries,f=-1,h=c.length;++f<h;)Wn(c[f],o)}};function Ti(a,o,c){var f=-1,h=a.length-c,y;for(o.lineStart();++f<h;)y=a[f],o.point(y[0],y[1],y[2]);o.lineEnd()}function ts(a,o){var c=-1,f=a.length;for(o.polygonStart();++c<f;)Ti(a[c],o,1);o.polygonEnd()}function Oo(a,o){a&&Kr.hasOwnProperty(a.type)?Kr[a.type](a,o):Wn(a,o)}vt();vt();function Li(a){return[Vt(a[1],a[0]),Ct(a[2])]}function Ht(a){var o=a[0],c=a[1],f=pe(c);return[f*pe(o),f*_e(o),_e(c)]}function Dn(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]}function Qn(a,o){return[a[1]*o[2]-a[2]*o[1],a[2]*o[0]-a[0]*o[2],a[0]*o[1]-a[1]*o[0]]}function Ni(a,o){a[0]+=o[0],a[1]+=o[1],a[2]+=o[2]}function Fn(a,o){return[a[0]*o,a[1]*o,a[2]*o]}function Ri(a){var o=Wt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=o,a[1]/=o,a[2]/=o}vt();function As(a,o){function c(f,h){return f=a(f,h),o(f[0],f[1])}return a.invert&&o.invert&&(c.invert=function(f,h){return f=o.invert(f,h),f&&a.invert(f[0],f[1])}),c}function Oi(a,o){return[a>ae?a-nt:a<-ae?a+nt:a,o]}Oi.invert=Oi;function Mo(a,o,c){return(a%=nt)?o||c?As(is(a),rs(o,c)):is(a):o||c?rs(o,c):Oi}function ns(a){return function(o,c){return o+=a,[o>ae?o-nt:o<-ae?o+nt:o,c]}}function is(a){var o=ns(a);return o.invert=ns(-a),o}function rs(a,o){var c=pe(a),f=_e(a),h=pe(o),y=_e(o);function N(m,L){var p=pe(L),_=pe(m)*p,E=_e(m)*p,k=_e(L),C=k*c+_*f;return[Vt(E*h-C*y,_*c-k*f),Ct(C*h+E*y)]}return N.invert=function(m,L){var p=pe(L),_=pe(m)*p,E=_e(m)*p,k=_e(L),C=k*h-E*y;return[Vt(E*h+k*y,_*c+C*f),Ct(C*c-_*f)]},N}function bo(a,o,c,f,h,y){if(c){var N=pe(o),m=_e(o),L=f*c;h==null?(h=o+f*nt,y=o-L/2):(h=ss(N,h),y=ss(N,y),(f>0?h<y:h>y)&&(h+=f*nt));for(var p,_=h;f>0?_>y:_<y;_-=L)p=Li([N,-m*pe(_),-m*_e(_)]),a.point(p[0],p[1])}}function ss(a,o){o=Ht(o),o[0]-=a,Ri(o);var c=Ps(-o[1]);return((-o[2]<0?-c:c)+nt-ve)%nt}function Ds(){var a=[],o;return{point:function(c,f){o.push([c,f])},lineStart:function(){a.push(o=[])},lineEnd:on,rejoin:function(){a.length>1&&a.push(a.pop().concat(a.shift()))},result:function(){var c=a;return a=[],o=null,c}}}function Po(a,o,c,f,h,y){var N=a[0],m=a[1],L=o[0],p=o[1],_=0,E=1,k=L-N,C=p-m,w;if(w=c-N,!(!k&&w>0)){if(w/=k,k<0){if(w<_)return;w<E&&(E=w)}else if(k>0){if(w>E)return;w>_&&(_=w)}if(w=h-N,!(!k&&w<0)){if(w/=k,k<0){if(w>E)return;w>_&&(_=w)}else if(k>0){if(w<_)return;w<E&&(E=w)}if(w=f-m,!(!C&&w>0)){if(w/=C,C<0){if(w<_)return;w<E&&(E=w)}else if(C>0){if(w>E)return;w>_&&(_=w)}if(w=y-m,!(!C&&w<0)){if(w/=C,C<0){if(w>E)return;w>_&&(_=w)}else if(C>0){if(w<_)return;w<E&&(E=w)}return _>0&&(a[0]=N+_*k,a[1]=m+_*C),E<1&&(o[0]=N+E*k,o[1]=m+E*C),!0}}}}}function Bn(a,o){return Te(a[0]-o[0])<ve&&Te(a[1]-o[1])<ve}function Gn(a,o,c,f){this.x=a,this.z=o,this.o=c,this.e=f,this.v=!1,this.n=this.p=null}function Fs(a,o,c,f,h){var y=[],N=[],m,L;if(a.forEach(function(w){if(!((H=w.length-1)<=0)){var H,G=w[0],Q=w[H],D;if(Bn(G,Q)){for(h.lineStart(),m=0;m<H;++m)h.point((G=w[m])[0],G[1]);h.lineEnd();return}y.push(D=new Gn(G,w,null,!0)),N.push(D.o=new Gn(G,null,D,!1)),y.push(D=new Gn(Q,w,null,!1)),N.push(D.o=new Gn(Q,null,D,!0))}}),!!y.length){for(N.sort(o),as(y),as(N),m=0,L=N.length;m<L;++m)N[m].e=c=!c;for(var p=y[0],_,E;;){for(var k=p,C=!0;k.v;)if((k=k.n)===p)return;_=k.z,h.lineStart();do{if(k.v=k.o.v=!0,k.e){if(C)for(m=0,L=_.length;m<L;++m)h.point((E=_[m])[0],E[1]);else f(k.x,k.n.x,1,h);k=k.n}else{if(C)for(_=k.p.z,m=_.length-1;m>=0;--m)h.point((E=_[m])[0],E[1]);else f(k.x,k.p.x,-1,h);k=k.p}k=k.o,_=k.z,C=!C}while(!k.v);h.lineEnd()}}}function as(a){if(o=a.length){for(var o,c=0,f=a[0],h;++c<o;)f.n=h=a[c],h.p=f,f=h;f.n=h=a[0],h.p=f}}function Gs(a,o){return a<o?-1:a>o?1:a>=o?0:NaN}function Ao(a){return a.length===1&&(a=Do(a)),{left:function(o,c,f,h){for(f==null&&(f=0),h==null&&(h=o.length);f<h;){var y=f+h>>>1;a(o[y],c)<0?f=y+1:h=y}return f},right:function(o,c,f,h){for(f==null&&(f=0),h==null&&(h=o.length);f<h;){var y=f+h>>>1;a(o[y],c)>0?h=y:f=y+1}return f}}}function Do(a){return function(o,c){return Gs(a(o),c)}}Ao(Gs);function zs(a){for(var o=a.length,c,f=-1,h=0,y,N;++f<o;)h+=a[f].length;for(y=new Array(h);--o>=0;)for(N=a[o],c=N.length;--c>=0;)y[--h]=N[c];return y}var zn=1e9,Yn=-1e9;function Fo(a,o,c,f){function h(p,_){return a<=p&&p<=c&&o<=_&&_<=f}function y(p,_,E,k){var C=0,w=0;if(p==null||(C=N(p,E))!==(w=N(_,E))||L(p,_)<0^E>0)do k.point(C===0||C===3?a:c,C>1?f:o);while((C=(C+E+4)%4)!==w);else k.point(_[0],_[1])}function N(p,_){return Te(p[0]-a)<ve?_>0?0:3:Te(p[0]-c)<ve?_>0?2:1:Te(p[1]-o)<ve?_>0?1:0:_>0?3:2}function m(p,_){return L(p.x,_.x)}function L(p,_){var E=N(p,1),k=N(_,1);return E!==k?E-k:E===0?_[1]-p[1]:E===1?p[0]-_[0]:E===2?p[1]-_[1]:_[0]-p[0]}return function(p){var _=p,E=Ds(),k,C,w,H,G,Q,D,A,V,F,q,j={point:$,lineStart:he,lineEnd:xe,polygonStart:se,polygonEnd:le};function $(te,oe){h(te,oe)&&_.point(te,oe)}function B(){for(var te=0,oe=0,me=C.length;oe<me;++oe)for(var Se=C[oe],we=1,Y=Se.length,Pe=Se[0],Ce,De,ee=Pe[0],it=Pe[1];we<Y;++we)Ce=ee,De=it,Pe=Se[we],ee=Pe[0],it=Pe[1],De<=f?it>f&&(ee-Ce)*(f-De)>(it-De)*(a-Ce)&&++te:it<=f&&(ee-Ce)*(f-De)<(it-De)*(a-Ce)&&--te;return te}function se(){_=E,k=[],C=[],q=!0}function le(){var te=B(),oe=q&&te,me=(k=zs(k)).length;(oe||me)&&(p.polygonStart(),oe&&(p.lineStart(),y(null,null,1,p),p.lineEnd()),me&&Fs(k,m,te,y,p),p.polygonEnd()),_=p,k=C=w=null}function he(){j.point=P,C&&C.push(w=[]),F=!0,V=!1,D=A=NaN}function xe(){k&&(P(H,G),Q&&V&&E.rejoin(),k.push(E.result())),j.point=$,V&&_.lineEnd()}function P(te,oe){var me=h(te,oe);if(C&&w.push([te,oe]),F)H=te,G=oe,Q=me,F=!1,me&&(_.lineStart(),_.point(te,oe));else if(me&&V)_.point(te,oe);else{var Se=[D=Math.max(Yn,Math.min(zn,D)),A=Math.max(Yn,Math.min(zn,A))],we=[te=Math.max(Yn,Math.min(zn,te)),oe=Math.max(Yn,Math.min(zn,oe))];Po(Se,we,a,o,c,f)?(V||(_.lineStart(),_.point(Se[0],Se[1])),_.point(we[0],we[1]),me||_.lineEnd(),q=!1):me&&(_.lineStart(),_.point(te,oe),q=!1)}D=te,A=oe,V=me}return j}}var Ii=vt();function Go(a,o){var c=o[0],f=o[1],h=[_e(c),-pe(c),0],y=0,N=0;Ii.reset();for(var m=0,L=a.length;m<L;++m)if(_=(p=a[m]).length)for(var p,_,E=p[_-1],k=E[0],C=E[1]/2+Jr,w=_e(C),H=pe(C),G=0;G<_;++G,k=D,w=V,H=F,E=Q){var Q=p[G],D=Q[0],A=Q[1]/2+Jr,V=_e(A),F=pe(A),q=D-k,j=q>=0?1:-1,$=j*q,B=$>ae,se=w*V;if(Ii.add(Vt(se*j*_e($),H*F+se*pe($))),y+=B?q+j*nt:q,B^k>=c^D>=c){var le=Qn(Ht(E),Ht(Q));Ri(le);var he=Qn(h,le);Ri(he);var xe=(B^q>=0?-1:1)*Ct(he[2]);(f>xe||f===xe&&(le[0]||le[1]))&&(N+=B^q>=0?1:-1)}}return(y<-1e-6||y<ve&&Ii<-1e-6)^N&1}vt();function us(a){return a}vt();vt();var Zt=1/0,Jn=Zt,dn=-Zt,Kn=dn,os={point:zo,lineStart:on,lineEnd:on,polygonStart:on,polygonEnd:on,result:function(){var a=[[Zt,Jn],[dn,Kn]];return dn=Kn=-(Jn=Zt=1/0),a}};function zo(a,o){a<Zt&&(Zt=a),a>dn&&(dn=a),o<Jn&&(Jn=o),o>Kn&&(Kn=o)}vt();function Ys(a,o,c,f){return function(h,y){var N=o(y),m=h.invert(f[0],f[1]),L=Ds(),p=o(L),_=!1,E,k,C,w={point:H,lineStart:Q,lineEnd:D,polygonStart:function(){w.point=A,w.lineStart=V,w.lineEnd=F,k=[],E=[]},polygonEnd:function(){w.point=H,w.lineStart=Q,w.lineEnd=D,k=zs(k);var q=Go(E,m);k.length?(_||(y.polygonStart(),_=!0),Fs(k,qo,q,c,y)):q&&(_||(y.polygonStart(),_=!0),y.lineStart(),c(null,null,1,y),y.lineEnd()),_&&(y.polygonEnd(),_=!1),k=E=null},sphere:function(){y.polygonStart(),y.lineStart(),c(null,null,1,y),y.lineEnd(),y.polygonEnd()}};function H(q,j){var $=h(q,j);a(q=$[0],j=$[1])&&y.point(q,j)}function G(q,j){var $=h(q,j);N.point($[0],$[1])}function Q(){w.point=G,N.lineStart()}function D(){w.point=H,N.lineEnd()}function A(q,j){C.push([q,j]);var $=h(q,j);p.point($[0],$[1])}function V(){p.lineStart(),C=[]}function F(){A(C[0][0],C[0][1]),p.lineEnd();var q=p.clean(),j=L.result(),$,B=j.length,se,le,he;if(C.pop(),E.push(C),C=null,!!B){if(q&1){if(le=j[0],(se=le.length-1)>0){for(_||(y.polygonStart(),_=!0),y.lineStart(),$=0;$<se;++$)y.point((he=le[$])[0],he[1]);y.lineEnd()}return}B>1&&q&2&&j.push(j.pop().concat(j.shift())),k.push(j.filter(Yo))}}return w}}function Yo(a){return a.length>1}function qo(a,o){return((a=a.x)[0]<0?a[1]-tt-ve:tt-a[1])-((o=o.x)[0]<0?o[1]-tt-ve:tt-o[1])}const ls=Ys(function(){return!0},Bo,Uo,[-ae,-tt]);function Bo(a){var o=NaN,c=NaN,f=NaN,h;return{lineStart:function(){a.lineStart(),h=1},point:function(y,N){var m=y>0?ae:-ae,L=Te(y-o);Te(L-ae)<ve?(a.point(o,c=(c+N)/2>0?tt:-tt),a.point(f,c),a.lineEnd(),a.lineStart(),a.point(m,c),a.point(y,c),h=0):f!==m&&L>=ae&&(Te(o-f)<ve&&(o-=f*ve),Te(y-m)<ve&&(y-=m*ve),c=jo(o,c,y,N),a.point(f,c),a.lineEnd(),a.lineStart(),a.point(m,c),h=0),a.point(o=y,c=N),f=m},lineEnd:function(){a.lineEnd(),o=c=NaN},clean:function(){return 2-h}}}function jo(a,o,c,f){var h,y,N=_e(a-c);return Te(N)>ve?Ro((_e(o)*(y=pe(f))*_e(c)-_e(f)*(h=pe(o))*_e(a))/(h*y*N)):(o+f)/2}function Uo(a,o,c,f){var h;if(a==null)h=c*tt,f.point(-ae,h),f.point(0,h),f.point(ae,h),f.point(ae,0),f.point(ae,-h),f.point(0,-h),f.point(-ae,-h),f.point(-ae,0),f.point(-ae,h);else if(Te(a[0]-o[0])>ve){var y=a[0]<o[0]?ae:-ae;h=c*y/2,f.point(-y,h),f.point(0,h),f.point(y,h)}else f.point(o[0],o[1])}function Xo(a,o){var c=pe(a),f=c>0,h=Te(c)>ve;function y(_,E,k,C){bo(C,a,o,k,_,E)}function N(_,E){return pe(_)*pe(E)>c}function m(_){var E,k,C,w,H;return{lineStart:function(){w=C=!1,H=1},point:function(G,Q){var D=[G,Q],A,V=N(G,Q),F=f?V?0:p(G,Q):V?p(G+(G<0?ae:-ae),Q):0;if(!E&&(w=C=V)&&_.lineStart(),V!==C&&(A=L(E,D),(!A||Bn(E,A)||Bn(D,A))&&(D[0]+=ve,D[1]+=ve,V=N(D[0],D[1]))),V!==C)H=0,V?(_.lineStart(),A=L(D,E),_.point(A[0],A[1])):(A=L(E,D),_.point(A[0],A[1]),_.lineEnd()),E=A;else if(h&&E&&f^V){var q;!(F&k)&&(q=L(D,E,!0))&&(H=0,f?(_.lineStart(),_.point(q[0][0],q[0][1]),_.point(q[1][0],q[1][1]),_.lineEnd()):(_.point(q[1][0],q[1][1]),_.lineEnd(),_.lineStart(),_.point(q[0][0],q[0][1])))}V&&(!E||!Bn(E,D))&&_.point(D[0],D[1]),E=D,C=V,k=F},lineEnd:function(){C&&_.lineEnd(),E=null},clean:function(){return H|(w&&C)<<1}}}function L(_,E,k){var C=Ht(_),w=Ht(E),H=[1,0,0],G=Qn(C,w),Q=Dn(G,G),D=G[0],A=Q-D*D;if(!A)return!k&&_;var V=c*Q/A,F=-c*D/A,q=Qn(H,G),j=Fn(H,V),$=Fn(G,F);Ni(j,$);var B=q,se=Dn(j,B),le=Dn(B,B),he=se*se-le*(Dn(j,j)-1);if(!(he<0)){var xe=Wt(he),P=Fn(B,(-se-xe)/le);if(Ni(P,j),P=Li(P),!k)return P;var te=_[0],oe=E[0],me=_[1],Se=E[1],we;oe<te&&(we=te,te=oe,oe=we);var Y=oe-te,Pe=Te(Y-ae)<ve,Ce=Pe||Y<ve;if(!Pe&&Se<me&&(we=me,me=Se,Se=we),Ce?Pe?me+Se>0^P[1]<(Te(P[0]-te)<ve?me:Se):me<=P[1]&&P[1]<=Se:Y>ae^(te<=P[0]&&P[0]<=oe)){var De=Fn(B,(-se+xe)/le);return Ni(De,j),[P,Li(De)]}}}function p(_,E){var k=f?a:ae-a,C=0;return _<-k?C|=1:_>k&&(C|=2),E<-k?C|=4:E>k&&(C|=8),C}return Ys(N,m,y,f?[0,-a]:[-ae,a-ae])}function qs(a){return function(o){var c=new Mi;for(var f in a)c[f]=a[f];return c.stream=o,c}}function Mi(){}Mi.prototype={constructor:Mi,point:function(a,o){this.stream.point(a,o)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Bs(a,o,c){var f=o[1][0]-o[0][0],h=o[1][1]-o[0][1],y=a.clipExtent&&a.clipExtent();a.scale(150).translate([0,0]),y!=null&&a.clipExtent(null),Oo(c,a.stream(os));var N=os.result(),m=Math.min(f/(N[1][0]-N[0][0]),h/(N[1][1]-N[0][1])),L=+o[0][0]+(f-m*(N[1][0]+N[0][0]))/2,p=+o[0][1]+(h-m*(N[1][1]+N[0][1]))/2;return y!=null&&a.clipExtent(y),a.scale(m*150).translate([L,p])}function Vo(a,o,c){return Bs(a,[[0,0],o],c)}var hs=16,Ho=pe(30*Xe);function cs(a,o){return+o?$o(a,o):Zo(a)}function Zo(a){return qs({point:function(o,c){o=a(o,c),this.stream.point(o[0],o[1])}})}function $o(a,o){function c(f,h,y,N,m,L,p,_,E,k,C,w,H,G){var Q=p-f,D=_-h,A=Q*Q+D*D;if(A>4*o&&H--){var V=N+k,F=m+C,q=L+w,j=Wt(V*V+F*F+q*q),$=Ct(q/=j),B=Te(Te(q)-1)<ve||Te(y-E)<ve?(y+E)/2:Vt(F,V),se=a(B,$),le=se[0],he=se[1],xe=le-f,P=he-h,te=D*xe-Q*P;(te*te/A>o||Te((Q*xe+D*P)/A-.5)>.3||N*k+m*C+L*w<Ho)&&(c(f,h,y,N,m,L,le,he,B,V/=j,F/=j,q,H,G),G.point(le,he),c(le,he,B,V,F,q,p,_,E,k,C,w,H,G))}}return function(f){var h,y,N,m,L,p,_,E,k,C,w,H,G={point:Q,lineStart:D,lineEnd:V,polygonStart:function(){f.polygonStart(),G.lineStart=F},polygonEnd:function(){f.polygonEnd(),G.lineStart=D}};function Q($,B){$=a($,B),f.point($[0],$[1])}function D(){E=NaN,G.point=A,f.lineStart()}function A($,B){var se=Ht([$,B]),le=a($,B);c(E,k,_,C,w,H,E=le[0],k=le[1],_=$,C=se[0],w=se[1],H=se[2],hs,f),f.point(E,k)}function V(){G.point=Q,f.lineEnd()}function F(){D(),G.point=q,G.lineEnd=j}function q($,B){A(h=$,B),y=E,N=k,m=C,L=w,p=H,G.point=A}function j(){c(E,k,_,C,w,H,y,N,h,m,L,p,hs,f),G.lineEnd=V,V()}return G}}var Wo=qs({point:function(a,o){this.stream.point(a*Xe,o*Xe)}});function Qo(a){return Jo(function(){return a})()}function Jo(a){var o,c=150,f=480,h=250,y,N,m=0,L=0,p=0,_=0,E=0,k,C,w=null,H=ls,G=null,Q,D,A,V=us,F=.5,q=cs(le,F),j,$;function B(P){return P=C(P[0]*Xe,P[1]*Xe),[P[0]*c+y,N-P[1]*c]}function se(P){return P=C.invert((P[0]-y)/c,(N-P[1])/c),P&&[P[0]*ft,P[1]*ft]}function le(P,te){return P=o(P,te),[P[0]*c+y,N-P[1]*c]}B.stream=function(P){return j&&$===P?j:j=Wo(H(k,q(V($=P))))},B.clipAngle=function(P){return arguments.length?(H=+P?Xo(w=P*Xe,6*Xe):(w=null,ls),xe()):w*ft},B.clipExtent=function(P){return arguments.length?(V=P==null?(G=Q=D=A=null,us):Fo(G=+P[0][0],Q=+P[0][1],D=+P[1][0],A=+P[1][1]),xe()):G==null?null:[[G,Q],[D,A]]},B.scale=function(P){return arguments.length?(c=+P,he()):c},B.translate=function(P){return arguments.length?(f=+P[0],h=+P[1],he()):[f,h]},B.center=function(P){return arguments.length?(m=P[0]%360*Xe,L=P[1]%360*Xe,he()):[m*ft,L*ft]},B.rotate=function(P){return arguments.length?(p=P[0]%360*Xe,_=P[1]%360*Xe,E=P.length>2?P[2]%360*Xe:0,he()):[p*ft,_*ft,E*ft]},B.precision=function(P){return arguments.length?(q=cs(le,F=P*P),xe()):Wt(F)},B.fitExtent=function(P,te){return Bs(B,P,te)},B.fitSize=function(P,te){return Vo(B,P,te)};function he(){C=As(k=Mo(p,_,E),o);var P=o(m,L);return y=f-P[0]*c,N=h+P[1]*c,xe()}function xe(){return j=$=null,B}return function(){return o=a.apply(this,arguments),B.invert=o.invert&&se,he()}}function js(a){return function(o,c){var f=pe(o),h=pe(c),y=a(f*h);return[y*h*_e(o),y*_e(c)]}}function Us(a){return function(o,c){var f=Wt(o*o+c*c),h=a(f),y=_e(h),N=pe(h);return[Vt(o*y,f*N),Ct(f&&c*y/f)]}}var Ko=js(function(a){return Wt(2/(1+a))});Ko.invert=Us(function(a){return 2*Ct(a/2)});var Xs=js(function(a){return(a=Ps(a))&&a/_e(a)});Xs.invert=Us(function(a){return a});function el(){return Qo(Xs).scale(79.4188).clipAngle(180-.001)}function fs(a,o){return[a,o]}fs.invert=fs;var{BufferOp:tl,GeoJSONReader:nl,GeoJSONWriter:il}=Lo;function vn(a,o,c){c=c||{};var f=c.units||"kilometers",h=c.steps||8;if(!a)throw new Error("geojson is required");if(typeof c!="object")throw new Error("options must be an object");if(typeof h!="number")throw new Error("steps must be an number");if(o===void 0)throw new Error("radius is required");if(h<=0)throw new Error("steps must be greater than 0");var y=[];switch(a.type){case"GeometryCollection":return ei(a,function(N){var m=jn(N,o,f,h);m&&y.push(m)}),Ee(y);case"FeatureCollection":return wi(a,function(N){var m=jn(N,o,f,h);m&&wi(m,function(L){L&&y.push(L)})}),Ee(y)}return jn(a,o,f,h)}function jn(a,o,c,f){var h=a.properties||{},y=a.type==="Feature"?a.geometry:a;if(y.type==="GeometryCollection"){var N=[];return ei(a,function(H){var G=jn(H,o,c,f);G&&N.push(G)}),Ee(N)}var m=rl(y),L={type:y.type,coordinates:Hs(y.coordinates,m)},p=new nl,_=p.read(L),E=Uu(Xu(o,c),"meters"),k=tl.bufferOp(_,E,f),C=new il;if(k=C.write(k),!Vs(k.coordinates)){var w={type:k.type,coordinates:Zs(k.coordinates,m)};return Un(w,h)}}function Vs(a){return Array.isArray(a[0])?Vs(a[0]):isNaN(a[0])}function Hs(a,o){return typeof a[0]!="object"?o(a):a.map(function(c){return Hs(c,o)})}function Zs(a,o){return typeof a[0]!="object"?o.invert(a):a.map(function(c){return Zs(c,o)})}function rl(a){var o=So(a).geometry.coordinates,c=[-o[0],-o[1]];return el().rotate(c).scale(Ss)}function ln(a){var o={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return wi(a,c=>{var f;switch((f=c.geometry)==null?void 0:f.type){case"Point":o.MultiPoint.coordinates.push(c.geometry.coordinates),o.MultiPoint.properties.push(c.properties);break;case"MultiPoint":o.MultiPoint.coordinates.push(...c.geometry.coordinates),o.MultiPoint.properties.push(c.properties);break;case"LineString":o.MultiLineString.coordinates.push(c.geometry.coordinates),o.MultiLineString.properties.push(c.properties);break;case"MultiLineString":o.MultiLineString.coordinates.push(...c.geometry.coordinates),o.MultiLineString.properties.push(c.properties);break;case"Polygon":o.MultiPolygon.coordinates.push(c.geometry.coordinates),o.MultiPolygon.properties.push(c.properties);break;case"MultiPolygon":o.MultiPolygon.coordinates.push(...c.geometry.coordinates),o.MultiPolygon.properties.push(c.properties);break}}),Ee(Object.keys(o).filter(function(c){return o[c].coordinates.length}).sort().map(function(c){var f={type:c,coordinates:o[c].coordinates},h={collectedProperties:o[c].properties};return Un(f,h)}))}function sl(a){const o=[];if(ei(a,h=>{o.push(h.coordinates)}),o.length<2)throw new Error("Must have at least two features");const c=a.features[0].properties||{},f=io(o[0],...o.slice(1));return f.length===0?null:f.length===1?dt(f[0],c):Bt(f,c)}function Si(a,o,c={}){const f=Dt(a),h=Dt(o);h[0]+=h[0]-f[0]>180?-360:f[0]-h[0]>180?360:0;const y=al(f,h);return Xn(y,"meters",c.units)}function al(a,o,c){c=c===void 0?Ss:Number(c);const f=c,h=a[1]*Math.PI/180,y=o[1]*Math.PI/180,N=y-h;let m=Math.abs(o[0]-a[0])*Math.PI/180;m>Math.PI&&(m-=2*Math.PI);const L=Math.log(Math.tan(y/2+Math.PI/4)/Math.tan(h/2+Math.PI/4)),p=Math.abs(L)>1e-11?N/L:Math.cos(h);return Math.sqrt(N*N+p*p*m*m)*f}function bi(a,o={}){const c=[];if(ei(a,h=>{c.push(h.coordinates)}),c.length<2)throw new Error("Must specify at least 2 geometries");const f=ro(c[0],...c.slice(1));return f.length===0?null:f.length===1?dt(f[0],o.properties):Bt(f,o.properties)}function ul(a,o={}){var c,f,h,y=o.properties,N=(c=o.autoComplete)!=null?c:!0,m=(f=o.orderCoords)!=null?f:!0,L=(h=o.mutate)!=null?h:!1;switch(L||(a=Vu(a)),a.type){case"FeatureCollection":var p=[];return a.features.forEach(function(_){p.push(Is(gs(_,{},N,m)))}),Bt(p,y);default:return gs(a,y,N,m)}}function gs(a,o,c,f){o=o||(a.type==="Feature"?a.properties:{});var h=$t(a),y=h.coordinates,N=h.type;if(!y.length)throw new Error("line must contain coordinates");switch(N){case"LineString":return c&&(y=ms(y)),dt([y],o);case"MultiLineString":var m=[],L=0;return y.forEach(function(p){if(c&&(p=ms(p)),f){var _=ol(cn(pn(p)));_>L?(m.unshift(p),L=_):m.push(p)}else m.push(p)}),dt(m,o);default:throw new Error("geometry type "+N+" is not supported")}}function ms(a){var o=a[0],c=o[0],f=o[1],h=a[a.length-1],y=h[0],N=h[1];return(c!==y||f!==N)&&a.push(o),a}function ol(a){var o=a[0],c=a[1],f=a[2],h=a[3];return Math.abs(o-f)*Math.abs(c-h)}function ll(a,o,c={}){var f,h;const y=(f=c.method)!=null?f:"geodesic",N=(h=c.units)!=null?h:"kilometers";if(!a)throw new Error("pt is required");if(Array.isArray(a)?a=ke(a):a.type==="Point"?a=Un(a):Fr(a,"Point","point"),!o)throw new Error("line is required");Array.isArray(o)?o=pn(o):o.type==="LineString"?o=Un(o):Fr(o,"LineString","line");let m=1/0;const L=a.geometry.coordinates;return Hu(o,p=>{if(p){const _=p.geometry.coordinates[0],E=p.geometry.coordinates[1],k=hl(L,_,E,{method:y});k<m&&(m=k)}}),Xn(m,"degrees",N)}function hl(a,o,c,f){if(f.method==="geodesic")return xo(pn([o,c]).geometry,a,{units:"degrees"}).properties.dist;const h=[c[0]-o[0],c[1]-o[1]],y=[a[0]-o[0],a[1]-o[1]],N=ds(y,h);if(N<=0)return Si(a,o,{units:"degrees"});const m=ds(h,h);if(m<=N)return Si(a,c,{units:"degrees"});const L=N/m,p=[o[0]+L*h[0],o[1]+L*h[1]];return Si(a,p,{units:"degrees"})}function ds(a,o){return a[0]*o[0]+a[1]*o[1]}function yn(a,o,c={}){var f,h;const y=(f=c.method)!=null?f:"geodesic",N=(h=c.units)!=null?h:"kilometers";if(!a)throw new Error("point is required");if(!o)throw new Error("polygon or multi-polygon is required");const m=$t(o);if(m.type==="MultiPolygon"){const _=m.coordinates.map(E=>yn(a,dt(E),{method:y,units:N}));return Math.min(..._.map(Math.abs))*(fn(a,o)?-1:1)}if(m.coordinates.length>1){const[_,...E]=m.coordinates.map(C=>yn(a,dt([C]),{method:y,units:N}));if(_>=0)return _;const k=Math.min(...E);return k<0?Math.abs(k):Math.min(k,Math.abs(_))}const L=Gi(m);let p=1/0;return Ns(L,_=>{p=Math.min(p,ll(a,_,{method:y,units:N}))}),fn(a,m)?-p:p}function cl(a){return Ls({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M7.976 10.072l4.357-4.357.62.618L8.284 11h-.618L3 6.333l.619-.618 4.357 4.357z"},child:[]}]})(a)}function fl(a){return Ls({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M7.116 8l-4.558 4.558.884.884L8 8.884l4.558 4.558.884-.884L8.884 8l4.558-4.558-.884-.884L8 7.116 3.442 2.558l-.884.884L7.116 8z"},child:[]}]})(a)}var $s="AlertDialog",[gl,Yl]=Au($s,[ps]),lt=ps(),Ws=a=>{const{__scopeAlertDialog:o,...c}=a,f=lt(o);return T.jsx(qu,{...f,...c,modal:!0})};Ws.displayName=$s;var ml="AlertDialogTrigger",Qs=Ie.forwardRef((a,o)=>{const{__scopeAlertDialog:c,...f}=a,h=lt(c);return T.jsx(Bu,{...h,...f,ref:o})});Qs.displayName=ml;var dl="AlertDialogPortal",Js=a=>{const{__scopeAlertDialog:o,...c}=a,f=lt(o);return T.jsx(bu,{...f,...c})};Js.displayName=dl;var vl="AlertDialogOverlay",Ks=Ie.forwardRef((a,o)=>{const{__scopeAlertDialog:c,...f}=a,h=lt(c);return T.jsx(Mu,{...h,...f,ref:o})});Ks.displayName=vl;var Yt="AlertDialogContent",[yl,pl]=gl(Yt),_l=Gu("AlertDialogContent"),ea=Ie.forwardRef((a,o)=>{const{__scopeAlertDialog:c,children:f,...h}=a,y=lt(c),N=Ie.useRef(null),m=_s(o,N),L=Ie.useRef(null);return T.jsx(Pu,{contentName:Yt,titleName:ta,docsSlug:"alert-dialog",children:T.jsx(yl,{scope:c,cancelRef:L,children:T.jsxs(Du,{role:"alertdialog",...y,...h,ref:m,onOpenAutoFocus:Fu(h.onOpenAutoFocus,p=>{p.preventDefault(),L.current?.focus({preventScroll:!0})}),onPointerDownOutside:p=>p.preventDefault(),onInteractOutside:p=>p.preventDefault(),children:[T.jsx(_l,{children:f}),T.jsx(xl,{contentRef:N})]})})})});ea.displayName=Yt;var ta="AlertDialogTitle",na=Ie.forwardRef((a,o)=>{const{__scopeAlertDialog:c,...f}=a,h=lt(c);return T.jsx(zu,{...h,...f,ref:o})});na.displayName=ta;var ia="AlertDialogDescription",ra=Ie.forwardRef((a,o)=>{const{__scopeAlertDialog:c,...f}=a,h=lt(c);return T.jsx(Yu,{...h,...f,ref:o})});ra.displayName=ia;var kl="AlertDialogAction",sa=Ie.forwardRef((a,o)=>{const{__scopeAlertDialog:c,...f}=a,h=lt(c);return T.jsx(ks,{...h,...f,ref:o})});sa.displayName=kl;var aa="AlertDialogCancel",ua=Ie.forwardRef((a,o)=>{const{__scopeAlertDialog:c,...f}=a,{cancelRef:h}=pl(aa,c),y=lt(c),N=_s(o,h);return T.jsx(ks,{...y,...f,ref:N})});ua.displayName=aa;var xl=({contentRef:a})=>{const o=`\`${Yt}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Yt}\` by passing a \`${ia}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Yt}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return Ie.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(o)},[o,a]),null},El=Ws,Nl=Qs,Il=Js,oa=Ks,la=ea,ha=sa,ca=ua,fa=na,ga=ra;const Sl=El,wl=Nl,Cl=Il,ma=Ie.forwardRef(({className:a,...o},c)=>T.jsx(oa,{className:Le("fixed inset-0 z-[1040] bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...o,ref:c}));ma.displayName=oa.displayName;const da=Ie.forwardRef(({className:a,...o},c)=>T.jsxs(Cl,{container:document.querySelector("#map-modal-dialog-container-leaflet"),children:[T.jsx(ma,{}),T.jsx(la,{ref:c,className:Le("fixed left-[50%] top-[50%] z-[1040] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o})]}));da.displayName=la.displayName;const va=({className:a,...o})=>T.jsx("div",{className:Le("flex flex-col space-y-2 text-center sm:text-left",a),...o});va.displayName="AlertDialogHeader";const ya=({className:a,...o})=>T.jsx("div",{className:Le("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...o});ya.displayName="AlertDialogFooter";const pa=Ie.forwardRef(({className:a,...o},c)=>T.jsx(fa,{ref:c,className:Le("text-lg font-semibold",a),...o}));pa.displayName=fa.displayName;const _a=Ie.forwardRef(({className:a,...o},c)=>T.jsx(ga,{ref:c,className:Le("text-sm text-muted-foreground",a),...o}));_a.displayName=ga.displayName;const Pi=Ie.forwardRef(({className:a,...o},c)=>T.jsx(ha,{ref:c,className:Le(xs(),a),...o}));Pi.displayName=ha.displayName;const ka=Ie.forwardRef(({className:a,...o},c)=>T.jsx(ca,{ref:c,className:Le(xs({variant:"outline"}),"mt-2 sm:mt-0",a),...o}));ka.displayName=ca.displayName;const En=({children:a,questionKey:o,className:c,label:f,sub:h,showDeleteButton:y})=>{const[N,m]=Ie.useState(!1),L=fe(gt),p=()=>{m(_=>!_)};return T.jsxs(T.Fragment,{children:[T.jsx(Ku,{className:c,children:T.jsxs("div",{className:"relative",children:[y&&T.jsxs(Sl,{children:[T.jsx(wl,{className:"absolute top-2 right-2 text-white",children:T.jsx(fl,{})}),T.jsxs(da,{children:[T.jsxs(va,{children:[T.jsx(pa,{children:"Are you absolutely sure?"}),T.jsx(_a,{children:"This action cannot be undone. This will permanently delete the question."})]}),T.jsxs(ya,{children:[T.jsx(ka,{children:"Cancel"}),T.jsx(Pi,{onClick:()=>{gt.set([])},children:"Delete All Questions"}),T.jsx(Pi,{onClick:()=>{gt.set(L.filter(_=>_.key!==o))},className:"mb-2 sm:mb-0",children:"Delete Question"})]})]})]}),T.jsx("button",{onClick:p,className:Le("absolute top-2 left-2 text-white border rounded-md transition-all duration-500",N&&"-rotate-90"),children:T.jsx(cl,{})}),T.jsxs(eo,{className:"ml-8 mr-8",children:[f," ",h&&`(${h})`]}),T.jsx(to,{className:Le("overflow-hidden transition-all duration-1000 max-h-[100rem]",N&&"max-h-0"),children:T.jsx(no,{children:a})})]})}),T.jsx(Rs,{className:"h-1"})]})},xa=async a=>{switch(a.type){case"airport":return _n.uniqBy((await ut('["aeroway"="aerodrome"]["iata"]',"Finding airports...")).elements,o=>o.tags.iata).map(o=>ke([o.center?o.center.lon:o.lon,o.center?o.center.lat:o.lat]));case"major-city":return(await ut('[place=city]["population"~"^[1-9]+[0-9]{6}$"]',"Finding cities...")).elements.map(o=>ke([o.center?o.center.lon:o.lon,o.center?o.center.lat:o.lat]));case"custom-points":return a.geo;case"aquarium-full":case"zoo-full":case"theme_park-full":case"museum-full":case"hospital-full":case"cinema-full":case"library-full":case"golf_course-full":case"consulate-full":case"park-full":{const o=a.type.split("-full")[0],c=await ut(`[${Cs[o]}=${o}]`,`Finding ${zt(o).toLowerCase()}s...`,"nwr","center",[],60);return c.remark&&c.remark.startsWith("runtime error")?(mt.error(`Error finding ${zt(o).toLowerCase()}s. Please enable hiding zone mode and switch to the Large Game variation of this question.`),[]):c.elements.length>=1e3?(mt.error(`Too many ${zt(o).toLowerCase()}s found (${c.elements.length}). Please enable hiding zone mode and switch to the Large Game variation of this question.`),[]):c.elements.map(f=>ke([f.center?f.center.lon:f.lon,f.center?f.center.lat:f.lat]))}}},zi=_n.memoize(async a=>{let o;switch(a.type){case"aquarium":case"zoo":case"theme_park":case"museum":case"hospital":case"cinema":case"library":case"golf_course":case"consulate":case"park":case"same-first-letter-station":case"same-length-station":case"same-train-line":return!1;case"custom-zone":{o=a.geo;break}case"zone":{if(o=await Gr(a.lat,a.lng,a.cat.adminLevel),!o)throw mt.error("No boundary found for this zone"),new Error("No boundary found");break}case"letter-zone":{const c=await Gr(a.lat,a.lng,a.cat.adminLevel);if(!c)throw mt.error("No boundary found for this zone"),new Error("No boundary found");let f=c.properties?.["name:en"];if(!f){const y=c.properties?.name;if(/^[a-zA-Z]$/.test(y[0]))f=y;else throw mt.error("No English name found for this zone"),new Error("No English name")}const h=f[0].toUpperCase();o=Ee(Di(await ut(`[admin_level=${a.cat.adminLevel}]["name:en"~"^${h}.+"]`,`Finding zones that start with the same letter (${h})...`,"relation","geom",[`[admin_level=${a.cat.adminLevel}]["name"~"^${h}.+"]`])).features.filter(y=>y.geometry&&(y.geometry.type==="Polygon"||y.geometry.type==="MultiPolygon"))),o=gn(Fi(o,{tolerance:.001,highQuality:!0,mutate:!0}));break}case"airport":case"major-city":case"aquarium-full":case"zoo-full":case"theme_park-full":case"museum-full":case"hospital-full":case"cinema-full":case"library-full":case"golf_course-full":case"consulate-full":case"park-full":case"custom-points":{const c=await xa(a),f=so(c),h=ke([a.lng,a.lat]);for(const y of f.features)if(fn(h,y)){o=y;break}break}}return o},a=>JSON.stringify({type:a.type,lat:a.lat,lng:a.lng,cat:a.cat,geo:a.geo,entirety:Vn.get()?Vn.get():ws.get()})),vs=async(a,o,c)=>{if(o===null)return;if(a.same&&c)throw new Error("Cannot be masked");if(!a.same&&!c)throw new Error("Must be masked");const f=await zi(a);return f===!1?o:a.same?bi(Ee([gn(o),f])):ao(Ee([...o.features,f]))},ql=async a=>{const o=Tt.get();if(o===!1)return a;if(["aquarium","zoo","theme_park","museum","hospital","cinema","library","golf_course","consulate","park"].includes(a.type)){const y=await Hn(a),N=await Hn({lat:o.latitude,lng:o.longitude,type:a.type});return a.same=y.properties.name===N.properties.name,a}if(a.type==="same-first-letter-station"||a.type==="same-length-station"||a.type==="same-train-line"){const y=ke([o.longitude,o.latitude]),N=ke([a.lng,a.lat]),m=Di(await ut("[railway=station]","Finding train stations. This may take a while. Do not press any buttons while this is processing. Don't worry, it will be cached.","node")),L=Ft(y,m),p=Ft(N,m);if(a.type==="same-train-line"){const k=await Zu(p.properties.id),C=parseInt(L.properties.id.split("/")[1]);k.includes(C)?a.same=!0:a.same=!1}const _=L.properties["name:en"]||L.properties.name,E=p.properties["name:en"]||p.properties.name;return!_||!E||(a.type==="same-first-letter-station"?_[0].toUpperCase()===E[0].toUpperCase()?a.same=!0:a.same=!1:a.type==="same-length-station"&&(_.length===E.length?a.same=!0:a.same=!1)),a}const c=Zn.get();if(c===null)return a;let f=null;try{f=mn(await vs(a,c,!1))}catch{try{f=await vs(a,{type:"FeatureCollection",features:[mn(c)]},!0)}catch{return a}}if(f==null)return a;const h=ke([o.longitude,o.latitude]);return fn(h,f)&&(a.same=!a.same),a},Bl=async a=>{try{const o=await zi(a);return o===!1?!1:Gi(o)}catch{return!1}},jl=({data:a,questionKey:o,sub:c,className:f,showDeleteButton:h=!0})=>{fe(kn);const y=fe(Tt),N=fe(gt),m=fe(Ts),L=fe(ot),p=fe(xn),_=`Matching
    ${N.filter(k=>k.id==="matching").map(k=>k.key).indexOf(o)+1}`;let E=T.jsx(T.Fragment,{});switch(a.type){case"zone":case"letter-zone":E=T.jsxs(T.Fragment,{children:[T.jsx(Oe,{className:Me,children:T.jsx(hn,{trigger:"OSM Zone",options:{3:"OSM Zone 3 (region in Japan)",4:"OSM Zone 4 (prefecture in Japan)",5:"OSM Zone 5",6:"OSM Zone 6",7:"OSM Zone 7",8:"OSM Zone 8",9:"OSM Zone 9",10:"OSM Zone 10"},value:a.cat.adminLevel.toString(),onValueChange:k=>ye(a.cat.adminLevel=parseInt(k)),disabled:!a.drag||p})}),a.type==="letter-zone"&&T.jsx("span",{className:"px-2 text-center text-orange-500",children:"Warning: The zone data has been simplified by 360 feet (100 meters) in order for the browser to not crash."})]});break;case"same-train-line":E=T.jsx("span",{className:"px-2 text-center text-orange-500",children:"Warning: The train line data is based on OpenStreetMap and may have fewer train stations than expected. If you are using this tool, ensure that the other players are also using this tool."});break;case"aquarium":case"hospital":case"museum":case"theme_park":case"zoo":case"cinema":case"library":case"golf_course":case"consulate":case"park":E=T.jsx("span",{className:"px-2 text-center text-orange-500",children:"This question will only influence the map when you click on a hiding zone in the hiding zone sidebar."});break;case"custom-zone":case"custom-points":a.drag&&(E=T.jsxs("p",{className:"px-2 mb-1 text-center text-orange-500",children:["To modify the matching"," ",a.type==="custom-zone"?"zones":"points",", enable it:",T.jsx(Ve,{className:"mx-1 my-1",checked:L===o,onCheckedChange:k=>{k?ot.set(o):ot.set(-1)},disabled:p}),"and use the buttons at the bottom left of the map."]}))}return T.jsxs(En,{questionKey:o,label:_,sub:c,className:f,showDeleteButton:h,children:[T.jsx(Oe,{className:Me,children:T.jsx(hn,{trigger:"Matching Type",options:Object.fromEntries(zr.options.filter(k=>k.description===jt).flatMap(k=>Ut(k.shape.type)).map(k=>[k._def.value,k.description])),groups:zr.options.filter(k=>k.description!==jt).map(k=>[k.description,Object.fromEntries(Ut(k.shape.type).map(C=>[C._def.value,C.description]))]).reduce((k,[C,w])=>{const H={disabled:!m,options:w};return k[C]?k[C].options={...k[C].options,...w}:k[C]=H,k},{}),value:a.type,onValueChange:async k=>{k==="custom-zone"&&(a.geo=await zi(a)),k==="custom-points"&&(a.type==="airport"||a.type==="major-city"||a.type==="aquarium-full"||a.type==="zoo-full"||a.type==="theme_park-full"||a.type==="museum-full"||a.type==="hospital-full"||a.type==="cinema-full"||a.type==="library-full"||a.type==="golf_course-full"||a.type==="consulate-full"||a.type==="park-full"?a.geo=await xa(a):(a.geo=[],mt.info("Please draw the points on the map."))),a.cat||(a.cat={adminLevel:3}),ye(a.type=k)},disabled:!a.drag||p})}),E,T.jsxs(Oe,{className:Me,children:[T.jsx("label",{className:"text-2xl font-semibold font-poppins",children:"Same"}),T.jsx(Ve,{disabled:!!y||!a.drag||p,checked:a.same,onCheckedChange:k=>ye(a.same=k)})]}),T.jsxs(Oe,{className:Le(Me,"text-2xl font-semibold font-poppins",a.type==="custom-zone"&&"capitalize"),style:a.type==="custom-zone"?{}:{backgroundColor:Xt[a.color],color:a.color==="gold"?"black":void 0},children:[a.type!=="custom-zone"&&"Color ("," lock"," ",T.jsx(Ve,{checked:!a.drag,disabled:p,onCheckedChange:k=>ye(a.drag=!k)}),a.type!=="custom-zone"&&")"]}),a.type!=="custom-zone"&&T.jsx(qt,{latitude:a.lat,longitude:a.lng,onChange:(k,C)=>{k!==null&&(a.lat=k),C!==null&&(a.lng=C),ye()},disabled:!a.drag||p})]})},Tl=_n.memoize(a=>{const c=uo(a).map(f=>Ai(oo(f.filter(h=>$u(h)==="LineString").map(h=>h.geometry.coordinates)))).filter(f=>f.geometry.coordinates.length>0);return ln(vn(Fi(Ee(c),{tolerance:.001}),.001)).features[0]},a=>`${JSON.stringify(a.map(o=>o.geometry))}`),Ll=(a,o)=>{const c=cn(vn(Ms(a),Math.abs(o),{units:"miles"})),f=a[3]-a[1],h=a[2]-a[0];return[c[0]-h,c[1]-f,c[2]+h,c[3]+f]},Ea=async a=>{const o=cn(Zn.get());switch(a.type){case"highspeed-measure-shinkansen":{const c=Di(await ut("[highspeed=yes]","Finding high-speed lines...","way","geom")).features;return[Tl(c)]}case"coastline":{const c=ul(await Wu()),f=yn(ke([a.lng,a.lat]),c,{units:"miles",method:"geodesic"});return[sl(Ee([Ms(cn(Zn.get())),vn(fo(c,o?Ll(o,f):[-180,-90,180,90]),f,{units:"miles",steps:64})]))]}case"airport":return[ln(Ee(_n.uniqBy((await ut('["aeroway"="aerodrome"]["iata"]',"Finding airports...")).elements,c=>c.tags.iata).map(c=>ke([c.center?c.center.lon:c.lon,c.center?c.center.lat:c.lat])))).features[0]];case"city":return[ln(Ee((await ut('[place=city]["population"~"^[1-9]+[0-9]{6}$"]',"Finding cities...")).elements.map(c=>ke([c.center?c.center.lon:c.lon,c.center?c.center.lat:c.lat])))).features[0]];case"aquarium-full":case"zoo-full":case"theme_park-full":case"museum-full":case"hospital-full":case"cinema-full":case"library-full":case"golf_course-full":case"consulate-full":case"park-full":{const c=a.type.split("-full")[0],f=await ut(`[${Cs[c]}=${c}]`,`Finding ${zt(c).toLowerCase()}s...`,"nwr","center",[],60);return f.remark&&f.remark.startsWith("runtime error")?(mt.error(`Error finding ${zt(c).toLowerCase()}s. Please enable hiding zone mode and switch to the Large Game variation of this question.`),[Bt([])]):f.elements.length>=1e3?(mt.error(`Too many ${zt(c).toLowerCase()}s found (${f.elements.length}). Please enable hiding zone mode and switch to the Large Game variation of this question.`),[Bt([])]):[ln(Ee(f.elements.map(h=>ke([h.center?h.center.lon:h.lon,h.center?h.center.lat:h.lat])))).features[0]]}case"custom-measure":return ln(Ee(a.geo.features)).features;case"aquarium":case"zoo":case"theme_park":case"museum":case"hospital":case"cinema":case"library":case"golf_course":case"consulate":case"park":case"mcdonalds":case"seven11":case"rail-measure":return!1}},Na=_n.memoize(async a=>{const o=await Ea(a);if(o===!1||o===void 0)return!1;const c=ke([a.lng,a.lat]);let f=gn(Ee(o.map(N=>vn(N,.001,{units:"miles"})))),h=yn(c,f,{units:"miles",method:"geodesic"}),y=0;for(;Math.abs(h)>Xn(5,"feet","miles");)y++,console.info("Measuring buffer off by",h,"miles after",y,"rounds"),f=Fi(vn(f,h,{units:"miles"}),{tolerance:.001}),h=yn(c,f,{units:"miles",method:"geodesic"});return console.info("Measuring buffer off by",Xn(Math.abs(h),"miles","feet"),"ft"),f},a=>JSON.stringify({type:a.type,lat:a.lat,lng:a.lng,entirety:Vn.get()?Vn.get():ws.get(),geo:a.geo})),ys=async(a,o,c)=>{if(o===null)return;if(c)throw new Error("Cannot be masked");const f=await Na(a);return f===!1?o:a.hiderCloser?bi(Ee([gn(o),f])):bi(Ee([gn(o),mn(f)]))},Ul=async a=>{const o=Tt.get();if(o===!1)return a;if(["aquarium","zoo","theme_park","museum","hospital","cinema","library","golf_course","consulate","park"].includes(a.type)){const y=await Hn(a),N=await Hn({lat:o.latitude,lng:o.longitude,type:a.type});return a.hiderCloser=y.properties.distanceToPoint>N.properties.distanceToPoint,a}if(a.type==="rail-measure"){const y=Qu.get();if(y.length===0)return a;const N=ke([a.lng,a.lat]),m=Ft(N,Ee(y.map(k=>k.properties.geometry))),L=$e(N,m),p=ke([o.longitude,o.latitude]),_=Ft(p,Ee(y.map(k=>k.properties.geometry))),E=$e(p,_);a.hiderCloser=E<L}if(a.type==="mcdonalds"||a.type==="seven11"){const y=await Ju(a.type==="mcdonalds"?Yr.McDonalds:Yr.Seven11),N=ke([a.lng,a.lat]),m=Ft(N,y),L=$e(N,m,{units:"miles"}),p=ke([o.longitude,o.latitude]),_=Ft(p,y),E=$e(p,_,{units:"miles"});return a.hiderCloser=E<L,a}const c=Zn.get();if(c===null)return a;let f=null;try{f=mn(await ys(a,c,!1))}catch{try{f=await ys(a,{type:"FeatureCollection",features:[mn(c)]},!0)}catch{return a}}if(f==null)return a;const h=ke([o.longitude,o.latitude]);return fn(h,f)&&(a.hiderCloser=!a.hiderCloser),a},Xl=async a=>{try{const o=await Na(a);return o===!1?!1:Gi(o)}catch{return!1}},Vl=({data:a,questionKey:o,sub:c,className:f,showDeleteButton:h=!0})=>{fe(kn);const y=fe(Tt),N=fe(gt),m=fe(Ts),L=fe(ot),p=fe(xn),_=`Measuring
    ${N.filter(k=>k.id==="measuring").map(k=>k.key).indexOf(o)+1}`;let E=T.jsx(T.Fragment,{});switch(a.type){case"mcdonalds":case"seven11":E=T.jsx("span",{className:"px-2 text-center text-orange-500",children:"This question will eliminate hiding zones that don't fit the criteria. When you click on a zone, the parts of that zone that don't satisfy the criteria will be eliminated."});break;case"aquarium":case"hospital":case"museum":case"theme_park":case"zoo":case"cinema":case"library":case"golf_course":case"consulate":case"park":E=T.jsx("span",{className:"px-2 text-center text-orange-500",children:"This question will only influence the map when you click on a hiding zone in the hiding zone sidebar."});break;case"custom-measure":a.drag&&(E=T.jsxs("p",{className:"px-2 mb-1 text-center text-orange-500",children:["To modify the measuring question, enable it:",T.jsx(Ve,{className:"mx-1 my-1",checked:L===o,onCheckedChange:k=>{k?ot.set(o):ot.set(-1)},disabled:!a.drag||p}),"and use the buttons at the bottom left of the map."]}));break}return T.jsxs(En,{questionKey:o,label:_,sub:c,className:f,showDeleteButton:h,children:[T.jsx(Oe,{className:Me,children:T.jsx(hn,{trigger:"Measuring Type",options:Object.fromEntries(qr.options.filter(k=>k.description===jt).flatMap(k=>Ut(k.shape.type)).map(k=>[k._def.value,k.description])),groups:qr.options.filter(k=>k.description!==jt).map(k=>[k.description,Object.fromEntries(Ut(k.shape.type).map(C=>[C._def.value,C.description]))]).reduce((k,[C,w])=>{const H={disabled:!m,options:w};return k[C]?k[C].options={...k[C].options,...w}:k[C]=H,k},{}),value:a.type,onValueChange:async k=>{if(k==="custom-measure"){const C=await Ea(a);a.geo||(a.geo={type:"FeatureCollection",features:[]}),a.geo.features=C||[]}a.type=k,ye()},disabled:!a.drag||p})}),E,T.jsxs(Oe,{className:Me,children:[T.jsx("label",{className:"text-2xl font-semibold font-poppins",children:"Hider Closer"}),T.jsx(Ve,{disabled:!!y||!a.drag||p,checked:a.hiderCloser,onCheckedChange:k=>ye(a.hiderCloser=k)})]}),T.jsxs(Oe,{className:Le(Me,"text-2xl font-semibold font-poppins"),style:{backgroundColor:Xt[a.color],color:a.color==="gold"?"black":void 0},children:["Color (lock"," ",T.jsx(Ve,{checked:!a.drag,disabled:p,onCheckedChange:k=>ye(a.drag=!k)}),")"]}),T.jsx(qt,{latitude:a.lat,longitude:a.lng,onChange:(k,C)=>{k!==null&&(a.lat=k),C!==null&&(a.lng=C),ye()},disabled:!a.drag||p})]})},Hl=({data:a,questionKey:o,sub:c,className:f,showDeleteButton:h=!0})=>{fe(kn);const y=fe(Tt),N=fe(gt),m=fe(xn),L=`Radius
    ${N.filter(p=>p.id==="radius").map(p=>p.key).indexOf(o)+1}`;return T.jsxs(En,{questionKey:o,label:L,sub:c,className:f,showDeleteButton:h,children:[T.jsx(Oe,{children:T.jsxs("div",{className:Le(Me,"gap-2 flex flex-row"),children:[T.jsx(Os,{type:"number",className:"rounded-md p-2 w-16",value:a.radius,disabled:!a.drag||m,onChange:p=>ye(a.radius=parseFloat(p.target.value))}),T.jsx(Es,{unit:a.unit,disabled:!a.drag||m,onChange:p=>ye(a.unit=p)})]})}),T.jsxs(Oe,{className:Me,children:[T.jsx("label",{className:"text-2xl font-semibold font-poppins",children:"Within"}),T.jsx(Ve,{checked:a.within,disabled:!!y||!a.drag||m,onCheckedChange:p=>ye(a.within=p)})]}),T.jsxs(Oe,{className:Le(Me,"text-2xl font-semibold font-poppins"),style:{backgroundColor:Xt[a.color],color:a.color==="gold"?"black":void 0},children:["Color (lock"," ",T.jsx(Ve,{checked:!a.drag,disabled:m,onCheckedChange:p=>ye(a.drag=!p)}),")"]}),T.jsx(qt,{latitude:a.lat,longitude:a.lng,onChange:(p,_)=>{p!==null&&(a.lat=p),_!==null&&(a.lng=_),ye()},disabled:!a.drag||m})]})},Zl=({data:a,questionKey:o,sub:c,className:f,showDeleteButton:h=!0})=>{fe(kn);const y=fe(Tt),N=fe(gt),m=fe(xn),L=`Thermometer
    ${N.filter(p=>p.id==="thermometer").map(p=>p.key).indexOf(o)+1}`;return T.jsxs(En,{questionKey:o,label:L,sub:c,className:f,showDeleteButton:h,children:[T.jsxs(Oe,{className:Me,children:[T.jsx("label",{className:"text-2xl font-semibold font-poppins",children:"Warmer"}),T.jsx(Ve,{disabled:!!y||!a.drag||m,checked:a.warmer,onCheckedChange:p=>ye(a.warmer=p)})]}),T.jsxs(Oe,{className:Le(Me,"text-xl font-semibold font-poppins"),style:{backgroundColor:Xt[a.colorA],color:a.colorA==="gold"?"black":void 0},children:["Color start (lock"," ",T.jsx(Ve,{checked:!a.drag,disabled:m,onCheckedChange:p=>ye(a.drag=!p)}),")"]}),T.jsx(qt,{latitude:a.latA,longitude:a.lngA,latLabel:"Latitude Start",lngLabel:"Longitude Start",onChange:(p,_)=>{p!==null&&(a.latA=p),_!==null&&(a.lngA=_),ye()},disabled:!a.drag||m}),T.jsx(Rs,{className:"my-2"}),T.jsx(Oe,{className:Le(Me,"text-xl font-semibold font-poppins"),style:{backgroundColor:Xt[a.colorB],color:a.colorB==="gold"?"black":void 0},children:"Color end"}),T.jsx(qt,{latitude:a.latB,longitude:a.lngB,latLabel:"Latitude End",lngLabel:"Longitude End",onChange:(p,_)=>{p!==null&&(a.latB=p),_!==null&&(a.lngB=_),ye()},disabled:!a.drag||m})]})},$l=({data:a,questionKey:o,sub:c,className:f,showDeleteButton:h=!0})=>{const y=fe(gt),N=fe(ot),m=fe(xn),L=`Tentacles
    ${y.filter(p=>p.id==="tentacles").map(p=>p.key).indexOf(o)+1}`;return T.jsxs(En,{questionKey:o,label:L,sub:c,className:f,showDeleteButton:h,children:[T.jsx(Oe,{children:T.jsxs("div",{className:Le(Me,"gap-2 flex flex-row"),children:[T.jsx(Os,{type:"number",className:"rounded-md p-2 w-16",value:a.radius,onChange:p=>ye(a.radius=parseFloat(p.target.value)),disabled:!a.drag||m}),T.jsx(Es,{unit:a.unit,onChange:p=>ye(a.unit=p),disabled:!a.drag||m})]})}),T.jsx(Oe,{className:Me,children:T.jsx(hn,{trigger:"Location Type",options:Object.fromEntries(jr.options.filter(p=>p.description===jt).flatMap(p=>Ut(p.shape.locationType)).map(p=>[p._def.value,p.description])),groups:Object.fromEntries(jr.options.filter(p=>p.description!==jt).map(p=>[p.description,Object.fromEntries(Ut(p.shape.locationType).map(_=>[_._def.value,_.description]))])),value:a.locationType,onValueChange:async p=>{if(p==="custom"){const _=await Br(a);a.locationType="custom",a.places=_.features.map(E=>({...E,properties:{...E.properties,name:E.properties?.["name:en"]??E.properties?.name}})),a.location=!1}else a.location=!1,a.locationType=p;ye()},disabled:!a.drag||m})}),a.locationType==="custom"&&a.drag&&T.jsxs("p",{className:"px-2 mb-1 text-center text-orange-500",children:["To modify tentacle locations, enable it:",T.jsx(Ve,{className:"mx-1 my-1",checked:N===o,onCheckedChange:p=>{p?ot.set(o):ot.set(-1)},disabled:!a.drag||m}),"and use the buttons at the bottom left of the map."]}),T.jsxs(Oe,{className:Le(Me,"text-2xl font-semibold font-poppins"),style:{backgroundColor:Xt[a.color],color:a.color==="gold"?"black":void 0},children:["Color (lock"," ",T.jsx(Ve,{checked:!a.drag,disabled:m,onCheckedChange:p=>ye(a.drag=!p)}),")"]}),T.jsx(qt,{latitude:a.lat,longitude:a.lng,onChange:(p,_)=>{p!==null&&(a.lat=p),_!==null&&(a.lng=_),ye()},disabled:!a.drag||m}),T.jsx(Oe,{className:Me,children:T.jsx(Ie.Suspense,{fallback:T.jsx("div",{className:"flex items-center justify-center w-full h-8",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"animate-spin",children:T.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})})}),children:T.jsx(Rl,{data:a,promise:a.locationType==="custom"?Promise.resolve(Ee(a.places)):Br(a),disabled:!a.drag||m})})})]})},Rl=({data:a,promise:o,disabled:c})=>{fe(kn);const f=fe(Tt),h=Ie.use(o);return T.jsx(hn,{trigger:"Location",options:{false:"Not Within",...ju(h.features,y=>[y.properties.name,y.properties.name])},value:a.location?a.location.properties.name:"false",onValueChange:y=>{y==="false"?a.location=!1:a.location=h.features.find(N=>N.properties.name===y),ye()},disabled:!!f||c})};export{Vl as M,Hl as R,$l as T,jl as a,Zl as b,ln as c,ql as d,ys as e,Bl as f,vs as g,Ul as h,bi as i,Xl as m,Gi as p};
